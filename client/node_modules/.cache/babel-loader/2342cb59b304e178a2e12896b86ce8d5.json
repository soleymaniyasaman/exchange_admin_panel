{"ast":null,"code":"var _jsxFileName = \"/Users/yasaman/Documents/moj_adminpanel/adminpanel/src/components/tickets/ticketDetail.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { Link, useParams } from \"react-router-dom\";\nimport { Field, Formik, Form } from \"formik\";\nimport { Grid, CircularProgress, Button, Checkbox, FormControlLabel, Divider } from '@material-ui/core';\nimport { NotificationImportant } from '@material-ui/icons';\nimport { useFetchApi } from '../../utils/hooks';\nimport { IAM_APP, REPLY_TICKET, TICKET_DETAIL, USERS_LIST } from '../../utils/constants';\nimport { timeToStr, UrlQuery } from '../../utils/utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MessageBox = props => {\n  var _props$writer, _props$writer2, _props$writer2$items, _props$item2, _props$item3;\n\n  let border = props.isAdmin ? \"20px 0 20px 20px\" : \"0 20px 20px 20px\";\n  let direction = props.isAdmin ? \"row\" : \"row-reverse\";\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    spacing: 3,\n    direction: direction,\n    justify: \"space-between\",\n    className: \"px-3 pb-2\",\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      md: 5,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border border-light px-3 py-2 text-white\",\n        style: {\n          borderRadius: border,\n          backgroundColor: \"#181C1F\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex justify-content-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: ((_props$writer = props.writer) === null || _props$writer === void 0 ? void 0 : _props$writer.items) ? (_props$writer2 = props.writer) === null || _props$writer2 === void 0 ? void 0 : (_props$writer2$items = _props$writer2.items) === null || _props$writer2$items === void 0 ? void 0 : _props$writer2$items.map(item => {\n              var _props$item, _props$item$user;\n\n              return item.id === ((_props$item = props.item) === null || _props$item === void 0 ? void 0 : (_props$item$user = _props$item.user) === null || _props$item$user === void 0 ? void 0 : _props$item$user.id) ? `${item.credentials.first_name} ${item.credentials.last_name}` : null;\n            }) : props.writer\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 19,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: timeToStr((_props$item2 = props.item) === null || _props$item2 === void 0 ? void 0 : _props$item2.created_at, \"HH:mm  -   jYYYY/jMM/jDD\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 20,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 18,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"py-1 px-2\",\n          children: (_props$item3 = props.item) === null || _props$item3 === void 0 ? void 0 : _props$item3.body\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 22,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 17,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 15,\n    columnNumber: 9\n  }, this);\n};\n\n_c = MessageBox;\n\nfunction TicketDetail(props) {\n  _s();\n\n  var _user$items, _ticket$category, _ticketsReply$items;\n\n  const {\n    id\n  } = useParams();\n  const [{\n    data: user,\n    isLoading: userLoading\n  }, doFetch] = useFetchApi(undefined, []);\n  const [{\n    data: ticket,\n    isLoading: ticketLoading\n  }, getTicket] = useFetchApi(undefined, {});\n  const [{\n    data: ticketsReply,\n    isLoading: ticketsReplyLoading\n  }, getTicketsReply] = useFetchApi(undefined, []);\n  const [{\n    data: newReply,\n    isLoading: newReplyLoading,\n    hasError\n  }, createReply] = useFetchApi(undefined, {});\n  React.useEffect(() => {\n    if (id) {\n      doFetch(\"GET\", IAM_APP, UrlQuery(USERS_LIST));\n      getTicket(\"GET\", IAM_APP, TICKET_DETAIL(id));\n      getTicketsReply(\"GET\", IAM_APP, REPLY_TICKET(id));\n    }\n  }, []);\n  React.useEffect(() => {\n    if (!newReplyLoading && Object.keys(newReply).length) {\n      getTicketsReply(\"GET\", IAM_APP, REPLY_TICKET(id));\n    }\n  }, [newReplyLoading]);\n\n  const handleSubmit = values => {\n    const payload = {\n      \"body\": values === null || values === void 0 ? void 0 : values.body,\n      \"media_id\": ticket === null || ticket === void 0 ? void 0 : ticket.media_id\n    };\n\n    if (values.body !== '') {\n      createReply(\"POST\", IAM_APP, REPLY_TICKET(id), payload);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"content mt-5 p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex w-25\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/assests/drawer/Polygon.svg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"font_title_name me-1\",\n          children: [user === null || user === void 0 ? void 0 : (_user$items = user.items) === null || _user$items === void 0 ? void 0 : _user$items.map(item => {\n            var _ticket$user;\n\n            return item.id === (ticket === null || ticket === void 0 ? void 0 : (_ticket$user = ticket.user) === null || _ticket$user === void 0 ? void 0 : _ticket$user.id) ? `${item.credentials.first_name} ${item.credentials.last_name}` : null;\n          }), \" / \", ticket === null || ticket === void 0 ? void 0 : (_ticket$category = ticket.category) === null || _ticket$category === void 0 ? void 0 : _ticket$category.title]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        className: \"text-decoration-none\",\n        style: {\n          color: \"#10D078\"\n        },\n        to: '/tickets',\n        children: [\"\\u0628\\u0627\\u0632\\u06AF\\u0634\\u062A \\u0628\\u0647 \\u0644\\u06CC\\u0633\\u062A \\u062A\\u06CC\\u06A9\\u062A\\u200C\\u0647\\u0627 \", `->`, \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }, this), console.log(\"ticket data\", ticketsReply, ticket), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4\",\n      children: [!ticketLoading && Boolean(Object.keys(ticket)) && /*#__PURE__*/_jsxDEV(MessageBox, {\n        item: ticket,\n        writer: user,\n        isAdmin: false\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 69\n      }, this), !ticketsReplyLoading && Boolean(ticketsReply === null || ticketsReply === void 0 ? void 0 : (_ticketsReply$items = ticketsReply.items) === null || _ticketsReply$items === void 0 ? void 0 : _ticketsReply$items.length) && ticketsReply.items.map((item, index) => /*#__PURE__*/_jsxDEV(MessageBox, {\n        writer: item.id,\n        item: item,\n        isAdmin: true\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 66\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Divider, {\n      className: \"my-3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4\",\n      children: /*#__PURE__*/_jsxDEV(Formik, {\n        initialValues: {\n          body: ''\n        },\n        enableReinitialize: true // validate={this.validate}\n        ,\n        onSubmit: values => handleSubmit(values),\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              flexGrow: 1\n            },\n            children: [/*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              spacing: 3,\n              justify: \"space-between\",\n              className: \"p-3\",\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                md: true,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex flex-column w-100\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"text-end text-white fs-6 mb-2 ms-4\",\n                    style: {\n                      minWidth: \"90px\"\n                    },\n                    htmlFor: \"amount\",\n                    children: \"\\u0645\\u062A\\u0646 \\u067E\\u0627\\u0633\\u062E\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 96,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(Field, {\n                    as: \"textarea\",\n                    name: \"body\",\n                    placeholder: \"\",\n                    required: true,\n                    className: \"form-control bg_input input_text\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 97,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 95,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 94,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              spacing: 3,\n              justify: \"space-between\",\n              className: \"p-3\",\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                md: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"my-4 ms-5 ps-2 d-flex justify-content-end\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                disabled: newReplyLoading,\n                variant: \"contained\",\n                type: \"submit\",\n                color: \"primary\",\n                children: [\"\\u0627\\u0631\\u0633\\u0627\\u0644 \\u067E\\u0627\\u0633\\u062E\", newReplyLoading && /*#__PURE__*/_jsxDEV(CircularProgress, {\n                  size: 24,\n                  className: \"position-absolute\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 58\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 9\n  }, this);\n}\n\n_s(TicketDetail, \"gNtHMnhQiYIP8bJh7AzCiaBbMyc=\", false, function () {\n  return [useParams, useFetchApi, useFetchApi, useFetchApi, useFetchApi];\n});\n\n_c2 = TicketDetail;\nexport default TicketDetail;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MessageBox\");\n$RefreshReg$(_c2, \"TicketDetail\");","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/src/components/tickets/ticketDetail.js"],"names":["React","Link","useParams","Field","Formik","Form","Grid","CircularProgress","Button","Checkbox","FormControlLabel","Divider","NotificationImportant","useFetchApi","IAM_APP","REPLY_TICKET","TICKET_DETAIL","USERS_LIST","timeToStr","UrlQuery","MessageBox","props","border","isAdmin","direction","borderRadius","backgroundColor","writer","items","map","item","id","user","credentials","first_name","last_name","created_at","body","TicketDetail","data","isLoading","userLoading","doFetch","undefined","ticket","ticketLoading","getTicket","ticketsReply","ticketsReplyLoading","getTicketsReply","newReply","newReplyLoading","hasError","createReply","useEffect","Object","keys","length","handleSubmit","values","payload","media_id","category","title","color","console","log","Boolean","index","flexGrow","minWidth"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link, useParams } from \"react-router-dom\";\nimport { Field, Formik, Form } from \"formik\";\nimport { Grid, CircularProgress, Button, Checkbox, FormControlLabel, Divider } from '@material-ui/core';\nimport {NotificationImportant} from '@material-ui/icons';\nimport { useFetchApi } from '../../utils/hooks';\nimport { IAM_APP, REPLY_TICKET, TICKET_DETAIL , USERS_LIST} from '../../utils/constants';\nimport { timeToStr, UrlQuery } from '../../utils/utils';\n\n\nconst MessageBox = (props) => {\n    let border = props.isAdmin ? \"20px 0 20px 20px\" : \"0 20px 20px 20px\";\n    let direction = props.isAdmin ? \"row\" : \"row-reverse\"\n    return (\n        <Grid container spacing={3} direction={direction} justify=\"space-between\" className=\"px-3 pb-2\">\n            <Grid item md={5}>\n                <div className=\"border border-light px-3 py-2 text-white\" style={{borderRadius: border, backgroundColor: \"#181C1F\"}}>\n                    <div className=\"d-flex justify-content-between\">\n                        <span>{props.writer?.items?props.writer?.items?.map(item => item.id === props.item?.user?.id ? `${item.credentials.first_name} ${item.credentials.last_name}` : null):props.writer}</span>\n                        <span>{ timeToStr(props.item?.created_at, \"HH:mm  -   jYYYY/jMM/jDD\") }</span>\n                    </div>\n                    <p className=\"py-1 px-2\">\n                        {props.item?.body}\n                    </p>\n                </div>\n            </Grid>\n        </Grid>\n    )\n}\n\n\nfunction TicketDetail(props) {\n\n    const {id} = useParams();\n    \n    const [{ data: user, isLoading: userLoading },doFetch] = useFetchApi(undefined, [])\n    const [{ data: ticket, isLoading: ticketLoading }, getTicket] = useFetchApi(undefined, {})\n    const [{ data: ticketsReply, isLoading: ticketsReplyLoading }, getTicketsReply] = useFetchApi(undefined, [])\n    const [{ data: newReply, isLoading: newReplyLoading, hasError }, createReply] = useFetchApi(undefined, {})\n\n    React.useEffect( () => {\n        if (id){\n            doFetch(\"GET\", IAM_APP, UrlQuery(USERS_LIST))\n            getTicket(\"GET\", IAM_APP, TICKET_DETAIL(id))\n            getTicketsReply(\"GET\", IAM_APP, REPLY_TICKET(id))\n        }\n    }, [])\n\n    React.useEffect( () => {\n        if (!newReplyLoading && Object.keys(newReply).length){\n            getTicketsReply(\"GET\", IAM_APP, REPLY_TICKET(id))\n        }\n    }, [newReplyLoading])\n\n    const handleSubmit = (values) => {\n        const payload = {\n            \"body\": values?.body,\n            \"media_id\": ticket?.media_id\n          \n        }\n        if (values.body !== ''){\n            createReply(\"POST\", IAM_APP, REPLY_TICKET(id), payload)\n        }\n    }\n\n    return (\n        <div className=\"content mt-5 p-4\">\n            <div className=\"d-flex justify-content-between\">\n                <div className=\"d-flex w-25\">\n                    <img src=\"/assests/drawer/Polygon.svg\" />\n                    <p className=\"font_title_name me-1\">{user?.items?.map(item => item.id === ticket?.user?.id ? `${item.credentials.first_name} ${item.credentials.last_name}` : null)} / {ticket?.category?.title}</p>\n                </div>\n                <Link className=\"text-decoration-none\" style={{color: \"#10D078\"}} to={'/tickets'} >بازگشت به لیست تیکت‌ها {`->`} </Link>\n            </div>\n            {console.log(\"ticket data\",ticketsReply,ticket)}\n            <div className=\"mt-4\">\n                { !ticketLoading && Boolean(Object.keys(ticket)) && <MessageBox item={ticket} writer={user} isAdmin={false}/>}\n                {\n                    !ticketsReplyLoading && Boolean(ticketsReply?.items?.length) &&\n                        ticketsReply.items.map( (item, index) => <MessageBox key={index} writer={item.id} item={item} isAdmin={ true} /> )\n                }\n            </div>\n            <Divider className=\"my-3\" />\n            <div className=\"mt-4\">\n                <Formik\n                    initialValues={{ body: '' }}\n                    enableReinitialize={true}\n                    // validate={this.validate}\n                    onSubmit={ values => handleSubmit(values) }\n                >\n                    <Form>\n                        <div style={{flexGrow: 1}} >\n                            <Grid container spacing={3} justify=\"space-between\" className=\"p-3\">\n                                <Grid item md>\n                                    <div className=\"d-flex flex-column w-100\">\n                                        <label className=\"text-end text-white fs-6 mb-2 ms-4\" style={{minWidth: \"90px\"}} htmlFor=\"amount\">متن پاسخ</label>\n                                        <Field\n                                            as=\"textarea\"\n                                            name=\"body\"\n                                            placeholder=\"\"\n                                            required\n                                            className=\"form-control bg_input input_text\"\n                                        />\n                                    </div>\n                                </Grid>\n                            </Grid>\n                            <Grid container spacing={3} justify=\"space-between\" className=\"p-3\">\n                                <Grid item md>\n                                    {/* <div className=\"d-flex w-100\">\n                                        <input\n                                            accept=\"image/*\"\n                                            className=\"d-none\"\n                                            id=\"contained-button-file\"\n                                            multiple\n                                            type=\"file\"\n                                        />\n                                        <label htmlFor=\"contained-button-file\">\n                                            <Button variant=\"contained\" color=\"secondary\" component=\"span\">\n                                                انتخاب فایل ضمیمه\n                                            </Button>\n                                        </label>\n                                    </div>\n                                    <div className=\"mt-2 text-white\" style={{fontSize: \"0.8rem\"}} > <span><NotificationImportant size=\"small\" className=\"text-danger\" /></span> فرمت های مجاز فایل ضمیمه شامل jpg , png , zip, rar, pdf می باشند</div> */}\n                                </Grid>\n                            </Grid>\n                            {/* { Boolean(hasError) && <p className=\"text-danger\">{hasError}</p> } */}\n                            <div className=\"my-4 ms-5 ps-2 d-flex justify-content-end\">\n                                <Button disabled={newReplyLoading} variant=\"contained\" type=\"submit\" color=\"primary\" >\n                                    ارسال پاسخ\n                                    { newReplyLoading && <CircularProgress size={24} className=\"position-absolute\" />}\n                                </Button>\n                            </div>\n                        </div>\n                    </Form>\n                </Formik>\n            </div>\n        </div>\n    )\n}\n\nexport default TicketDetail\n"]},"metadata":{},"sourceType":"module"}