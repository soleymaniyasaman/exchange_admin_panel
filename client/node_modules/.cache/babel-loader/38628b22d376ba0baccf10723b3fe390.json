{"ast":null,"code":"import _objectSpread from\"/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{Link,useHistory}from\"react-router-dom\";import{Field,Formik,Form}from\"formik\";import{Grid,CircularProgress,Button,Checkbox,FormControlLabel,Select,MenuItem,withStyles,OutlinedInput}from'@material-ui/core';import InputBase from'@material-ui/core/InputBase';import{USERS_LIST,IAM_APP,USER_SEND_MESSAGES}from\"../../utils/constants\";import{useFetchApi}from'../../utils/hooks';import{UrlQuery}from'../../utils/utils';import{useTheme}from'@material-ui/styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ITEM_HEIGHT=48;var ITEM_PADDING_TOP=8;var MenuProps={PaperProps:{style:{maxHeight:ITEM_HEIGHT*4.5+ITEM_PADDING_TOP,width:250}}};var names=['Oliver Hansen','Van Henry','April Tucker','Ralph Hubbard','Omar Alexander','Carlos Abbott','Miriam Wagner','Bradley Wilkerson','Virginia Andrews','Kelly Snyder'];function getStyles(name,personName,theme){return{fontWeight:personName.indexOf(name)===-1?theme.typography.fontWeightRegular:theme.typography.fontWeightMedium};}function NewMessage(props){var _data$items2;var loginLoading=false;var history=useHistory();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),checked=_React$useState2[0],setChecked=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),selectUserName=_React$useState4[0],setSelectUserName=_React$useState4[1];var BootstrapInput=withStyles(function(theme){return{root:{//   'label + &': {\n//     marginTop: theme.spacing(3),\n//   },\nwidth:\"inherit !important\"},input:{borderRadius:4,position:'relative',backgroundColor:'white',border:'1px solid #ced4da',fontSize:'initial',padding:'5px 12px 5px 12px',color:'black',transition:theme.transitions.create(['border-color','box-shadow']),direction:\"rtl !important\",// Use the system font instead of the default Roboto font.\nfontFamily:[\"IranSans\"].join(','),'&:focus':{borderRadius:4,borderColor:'#80bdff',boxShadow:'0 0 0 0.2rem rgba(0,123,255,.25)',backgroundColor:'white'}}};})(InputBase);var theme=useTheme();var _React$useState5=React.useState([]),_React$useState6=_slicedToArray(_React$useState5,2),personName=_React$useState6[0],setPersonName=_React$useState6[1];var handleChange=function handleChange(event){// console.log(\"value ==>\",event)\nvar value=event.target.value;setPersonName(//   event.target.value\n// On autofill we get a the stringified value.\ntypeof value==='string'?value.split(','):value);};console.log(\"peron name is ==>\",personName);var _React$useState7=React.useState({}),_React$useState8=_slicedToArray(_React$useState7,2),params=_React$useState8[0],setParams=_React$useState8[1];var _useFetchApi=useFetchApi(undefined,[]),_useFetchApi2=_slicedToArray(_useFetchApi,2),_useFetchApi2$=_useFetchApi2[0],data=_useFetchApi2$.data,isLoading=_useFetchApi2$.isLoading,hasError=_useFetchApi2$.hasError,doFetch=_useFetchApi2[1];var _useFetchApi3=useFetchApi(undefined,[]),_useFetchApi4=_slicedToArray(_useFetchApi3,2),_useFetchApi4$=_useFetchApi4[0],submitMessage=_useFetchApi4$.data,submitMessageIsLoading=_useFetchApi4$.isLoading,submitMessageHasError=_useFetchApi4$.hasError,doFetchSubmit=_useFetchApi4[1];var handleSubmit=function handleSubmit(values){console.log(\"name\",values.toggle);loginLoading=true;var usersId=[];if(values.toggle){var _data$items;data===null||data===void 0?void 0:(_data$items=data.items)===null||_data$items===void 0?void 0:_data$items.map(function(item,index){usersId.push(item.id);});}var payload={\"message\":{\"title\":values.title,\"body\":values.body,\"target_type\":values.toggle?\"all\":personName.length===1?\"person\":\"multi_person\"},\"users\":personName};doFetchSubmit(\"POST\",IAM_APP,USER_SEND_MESSAGES,payload);setTimeout(function(){history.push(\"/messages\");},1000);// .then(resp => history.push(\"/messages\"))\n};// const handleSelectUsers = () => {\n// }\nReact.useEffect(function(){doFetch(\"GET\",IAM_APP,UrlQuery(USERS_LIST,_objectSpread({},params)));},[params]);return/*#__PURE__*/_jsxs(\"div\",{className:\"content mt-5 p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex w-25\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/assets/drawer/Polygon.svg\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font_title_name me-1\",children:\"\\u0627\\u0631\\u0633\\u0627\\u0644 \\u067E\\u06CC\\u0627\\u0645 \"})]}),/*#__PURE__*/_jsxs(Link,{className:\"text-decoration-none\",style:{color:\"#10D078\"},to:'/messages',children:[\"\\u0628\\u0627\\u0632\\u06AF\\u0634\\u062A \\u0628\\u0647 \\u062A\\u0627\\u0631\\u06CC\\u062E\\u0686\\u0647 \\u067E\\u06CC\\u0627\\u0645\\u200C\\u0647\\u0627 \",\"->\",\" \"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsx(Formik,{initialValues:{account_number:'',title:'',toggle:false},enableReinitialize:true// validate={this.validate}\n,onSubmit:function onSubmit(values){return handleSubmit(values);},children:/*#__PURE__*/_jsx(Form,{children:/*#__PURE__*/_jsxs(\"div\",{style:{flexGrow:1},children:[/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,justify:\"space-between\",className:\"p-3\",children:/*#__PURE__*/_jsx(Grid,{item:true,md:5,children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex w-100\",style:{maxHeight:\"34px\"},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-end text-white ms-4\",style:{minWidth:\"90px\"},htmlFor:\"account_number\",children:\"\\u06A9\\u0627\\u0631\\u0628\\u0631\"}),/*#__PURE__*/_jsxs(Select,{multiple:true// displayEmpty\n,className:\"w-100 text-dark bg-light\",value:personName,onChange:handleChange,input:/*#__PURE__*/_jsx(OutlinedInput,{})// renderValue={(selected) => {\n//     if (selected.length === 0) {\n//     return <em>Placeholder</em>;\n//     }\n//     console.log(\"selected ==>\",selected)\n//     return selected.join(', ');\n// }}\n,MenuProps:MenuProps,inputProps:{'aria-label':'Without label'},children:[/*#__PURE__*/_jsx(MenuItem,{disabled:true,value:\"\",children:/*#__PURE__*/_jsx(\"em\",{children:\"Placeholder\"})}),data===null||data===void 0?void 0:(_data$items2=data.items)===null||_data$items2===void 0?void 0:_data$items2.map(function(name){return/*#__PURE__*/_jsxs(MenuItem,{value:name.id,style:getStyles(name,personName,theme),children:[name.credentials.first_name,\" \",name.credentials.last_name]},name.id);})]})]})})}),/*#__PURE__*/_jsxs(Grid,{container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,md:1}),/*#__PURE__*/_jsx(Grid,{item:true,md:5,className:\"\",children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(Field,{type:\"checkbox\",name:\"toggle\",className:\"ms-2\"}),/*#__PURE__*/_jsx(\"label\",{className:\"text-white me-0\",htmlFor:\"toggle\",children:\"\\u0627\\u0646\\u062A\\u062E\\u0627\\u0628 \\u0647\\u0645\\u0647 \\u06A9\\u0627\\u0631\\u0628\\u0631\\u0627\\u0646\"})]})})]}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,justify:\"space-between\",className:\"p-3\",children:/*#__PURE__*/_jsx(Grid,{item:true,md:5,children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex w-100\",style:{maxHeight:\"34px\"},children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-end text-white fs-6 ms-4\",style:{minWidth:\"90px\"},htmlFor:\"title\",children:\"\\u0639\\u0646\\u0648\\u0627\\u0646 \\u067E\\u06CC\\u0627\\u0645\"}),/*#__PURE__*/_jsx(Field,{type:\"text\",name:\"title\",placeholder:\"\",required:true,className:\"form-control bg_input input_text\"})]})})}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,justify:\"space-between\",className:\"p-3\",children:/*#__PURE__*/_jsx(Grid,{item:true,md:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex w-100\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-end text-white fs-6 ms-4\",style:{minWidth:\"90px\"},htmlFor:\"amount\",children:\"\\u0645\\u062A\\u0646 \\u067E\\u06CC\\u0627\\u0645\"}),/*#__PURE__*/_jsx(Field,{as:\"textarea\",name:\"body\",placeholder:\"\\u0645\\u062A\\u0646 \\u067E\\u06CC\\u0627\\u0645 \\u0631\\u0627 \\u0628\\u0646\\u0648\\u06CC\\u0633\\u06CC\\u062F\",required:true,className:\"form-control bg_input input_text\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 pt-3 ms-5 ps-2 d-flex justify-content-end\",children:/*#__PURE__*/_jsxs(Button,{disabled:loginLoading,variant:\"contained\",type:\"submit\",color:\"primary\",children:[\"\\u0627\\u0631\\u0633\\u0627\\u0644 \\u067E\\u06CC\\u0627\\u0645\",loginLoading&&/*#__PURE__*/_jsx(CircularProgress,{size:24,className:\"position-absolute\"})]})})]})})})})]});}export default NewMessage;","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/src/components/messages/newMessage.js"],"names":["React","Link","useHistory","Field","Formik","Form","Grid","CircularProgress","Button","Checkbox","FormControlLabel","Select","MenuItem","withStyles","OutlinedInput","InputBase","USERS_LIST","IAM_APP","USER_SEND_MESSAGES","useFetchApi","UrlQuery","useTheme","ITEM_HEIGHT","ITEM_PADDING_TOP","MenuProps","PaperProps","style","maxHeight","width","names","getStyles","name","personName","theme","fontWeight","indexOf","typography","fontWeightRegular","fontWeightMedium","NewMessage","props","loginLoading","history","useState","checked","setChecked","selectUserName","setSelectUserName","BootstrapInput","root","input","borderRadius","position","backgroundColor","border","fontSize","padding","color","transition","transitions","create","direction","fontFamily","join","borderColor","boxShadow","setPersonName","handleChange","event","value","target","split","console","log","params","setParams","undefined","data","isLoading","hasError","doFetch","submitMessage","submitMessageIsLoading","submitMessageHasError","doFetchSubmit","handleSubmit","values","toggle","usersId","items","map","item","index","push","id","payload","title","body","length","setTimeout","useEffect","account_number","flexGrow","minWidth","credentials","first_name","last_name"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport { Link , useHistory } from \"react-router-dom\";\n\nimport { Field, Formik, Form } from \"formik\";\n\nimport { Grid, CircularProgress, Button, Checkbox, FormControlLabel, Select , MenuItem, withStyles, OutlinedInput } from '@material-ui/core';\n\nimport InputBase from '@material-ui/core/InputBase';\n\nimport { USERS_LIST , IAM_APP ,USER_SEND_MESSAGES} from \"../../utils/constants\"\n\nimport { useFetchApi } from '../../utils/hooks';\n\nimport { UrlQuery } from '../../utils/utils';\n\nimport { useTheme } from '@material-ui/styles';\n\nconst ITEM_HEIGHT = 48;\nconst ITEM_PADDING_TOP = 8;\nconst MenuProps = {\n  PaperProps: {\n    style: {\n      maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\n      width: 250,\n    },\n  },\n};\n\nconst names = [\n  'Oliver Hansen',\n  'Van Henry',\n  'April Tucker',\n  'Ralph Hubbard',\n  'Omar Alexander',\n  'Carlos Abbott',\n  'Miriam Wagner',\n  'Bradley Wilkerson',\n  'Virginia Andrews',\n  'Kelly Snyder',\n];\n\nfunction getStyles(name, personName, theme) {\n  return {\n    fontWeight:\n      personName.indexOf(name) === -1\n        ? theme.typography.fontWeightRegular\n        : theme.typography.fontWeightMedium,\n  };\n}\nfunction NewMessage(props) {\n\n\n\n    let loginLoading = false\n\n    const history = useHistory()\n\n    const [checked, setChecked] = React.useState(false)\n\n    const [selectUserName, setSelectUserName] = React.useState([])\n\n\n    const BootstrapInput = withStyles((theme) => ({\n\n        root: {\n\n            //   'label + &': {\n\n            //     marginTop: theme.spacing(3),\n\n            //   },\n            width: \"inherit !important\",\n\n\n        },\n\n        input: {\n\n            borderRadius: 4,\n\n            position: 'relative',\n\n            backgroundColor: 'white',\n\n            border: '1px solid #ced4da',\n\n            fontSize: 'initial',\n\n            padding: '5px 12px 5px 12px',\n\n            color: 'black',\n\n            transition: theme.transitions.create(['border-color', 'box-shadow']),\n\n            direction: \"rtl !important\",\n            // Use the system font instead of the default Roboto font.\n\n            fontFamily: [\n\n                \"IranSans\",\n\n            ].join(','),\n\n            '&:focus': {\n\n                borderRadius: 4,\n\n                borderColor: '#80bdff',\n\n                boxShadow: '0 0 0 0.2rem rgba(0,123,255,.25)',\n\n                backgroundColor: 'white'\n\n            },\n\n        },\n\n    }))(InputBase);\n\n    const theme = useTheme();\n    const [personName, setPersonName] = React.useState([]);\n  \n    const handleChange = (event) => {\n        // console.log(\"value ==>\",event)\n      const {\n        target: { value },\n      } = event;\n      setPersonName(\n        //   event.target.value\n        // On autofill we get a the stringified value.\n        typeof value === 'string' ? value.split(',') : value,\n      );\n    };\n  \n    console.log(\"peron name is ==>\",personName)\n    \n    const [params, setParams] = React.useState({})\n    \n    const [{ data, isLoading, hasError }, doFetch] = useFetchApi(undefined, [])\n\n    const [{ data:submitMessage, isLoading:submitMessageIsLoading, hasError:submitMessageHasError }, doFetchSubmit] = useFetchApi(undefined, [])\n    \n\n\n    const handleSubmit= (values) => {\n\n        console.log(\"name\",values.toggle)\n\n        loginLoading = true\n\n        let usersId = []\n\n        if (values.toggle) {\n            \n            data?.items?.map((item,index) => {\n            \n                usersId.push(item.id)\n    \n            })\n\n        }\n\n        let payload = {\n            \"message\": {\n              \"title\": values.title,\n              \"body\": values.body,\n              \"target_type\": values.toggle ? \"all\" : personName.length === 1 ? \"person\" : \"multi_person\"\n            },\n            \"users\": personName\n          }\n        \n\n        doFetchSubmit(\"POST\", IAM_APP , USER_SEND_MESSAGES, payload )\n        \n        setTimeout(() => {\n            history.push(\"/messages\")\n            \n        }, 1000);\n        // .then(resp => history.push(\"/messages\"))\n    }\n  \n\n    // const handleSelectUsers = () => {\n\n\n    // }\n  \n    React.useEffect(() => {\n  \n      doFetch(\"GET\", IAM_APP , UrlQuery(USERS_LIST, {...params}) )\n  \n    }, [params])\n\n\n    return (\n\n        <div className=\"content mt-5 p-4\">\n\n            <div className=\"d-flex justify-content-between\">\n\n                <div className=\"d-flex w-25\">\n\n                    <img src=\"/assets/drawer/Polygon.svg\" />\n\n                    <p className=\"font_title_name me-1\">ارسال پیام </p>\n\n                </div>\n\n                <Link className=\"text-decoration-none\" style={{ color: \"#10D078\" }} to={'/messages'} >بازگشت به تاریخچه پیام‌ها {`->`} </Link>\n\n            </div>\n\n            <div className=\"mt-4\">\n\n                <Formik\n\n                    initialValues={{ account_number: '', title: '' ,toggle: false}}\n\n                    enableReinitialize={true}\n\n                // validate={this.validate}\n\n                onSubmit={values => handleSubmit(values)}\n\n                >\n\n                    <Form>\n\n                        <div style={{ flexGrow: 1 }} >\n\n                            <Grid container spacing={3} justify=\"space-between\" className=\"p-3\">\n\n                                <Grid item md={5}>\n\n                                    <div className=\"d-flex w-100\" style={{ maxHeight: \"34px\" }}>\n\n                                        <label className=\"text-end text-white ms-4\" style={{ minWidth: \"90px\" }} htmlFor=\"account_number\">کاربر</label>\n\n                                        {/* <Field\n\n                                            type=\"text\"\n\n                                            name=\"account_number\"\n\n                                            placeholder=\"\"\n\n                                            required\n\n                                            className=\"form-control bg_input input_text\"\n\n                                        /> */}\n\n                                        {/* <Select \n                                        name=\"account_number\" \n                                        value={selectUserName} \n                                        input={<BootstrapInput />} \n                                        renderValue={(selected) => {\n                                            if (selected.length === 0) {\n                                            return <em>Placeholder</em>;\n                                            }\n                                            console.log(\"selected ==>\",selected)\n                                            return selected.join(', ');\n                                        }}\n                                        displayEmpty \n                                        MenuProps={MenuProps}\n                                        inputProps={{ 'aria-label': 'Without label' }}\n                                        onChange={e =>  setSelectUserName([e.target.value]) } select size=\"small\">\n\n                                            {data?.items?.map((item,index) => {\n\n                                                return <MenuItem \n                                                key={item.id}\n                                                value={item.id}>{item.credentials.first_name} {item.credentials.last_name}</MenuItem>\n\n                                            })}\n\n                                        </Select> */}\n\n                                        <Select\n                                            multiple\n                                            // displayEmpty\n                                            className=\"w-100 text-dark bg-light\"\n                                            value={personName}\n                                            onChange={handleChange}\n                                            input={<OutlinedInput />}\n                                            // renderValue={(selected) => {\n                                            //     if (selected.length === 0) {\n                                            //     return <em>Placeholder</em>;\n                                            //     }\n                                            //     console.log(\"selected ==>\",selected)\n                                            //     return selected.join(', ');\n                                            // }}\n                                            \n                                            MenuProps={MenuProps}\n                                            inputProps={{ 'aria-label': 'Without label' }}\n                                            >\n                                            <MenuItem disabled value=\"\">\n                                                <em>Placeholder</em>\n                                            </MenuItem>\n                                            {data?.items?.map((name) => (\n                                                <MenuItem\n                                                key={name.id}\n                                                value={name.id}\n                                                style={getStyles(name, personName, theme)}\n                                                >\n                                                {name.credentials.first_name} {name.credentials.last_name}\n                                                </MenuItem>\n                                            ))}\n                                            </Select>\n\n                                    </div>\n\n                                </Grid>\n\n                            </Grid>\n\n                            <Grid container >\n\n                                <Grid item md={1}></Grid>\n\n                                <Grid item md={5} className=\"\">\n\n                                    {/* <Checkbox label=\"انتخاب همه کاربران\" value={checked} size=\"small\" color=\"primary\" onClick={ _ => setChecked( state => !state) } /> */}\n\n                                    {/* <FormControlLabel\n\n                                        control={<Checkbox checked={checked} color=\"primary\" onChange={_ => {setChecked(state => !state)}} name=\"checkedA\" />}\n\n                                        label=\"انتخاب همه کاربران\"\n\n                                        className=\"text-white me-0\"\n\n                                    /> */}\n                                            <label>   \n                                                <Field type=\"checkbox\" name=\"toggle\" className=\"ms-2\" />\n\n                                                <label className=\"text-white me-0\" htmlFor=\"toggle\">انتخاب همه کاربران</label>\n                                                {/* {`${props.values.toggle}`} */}\n                                            </label>\n\n                                </Grid>\n\n                            </Grid>\n\n                            <Grid container spacing={3} justify=\"space-between\" className=\"p-3\">\n\n                                <Grid item md={5}>\n\n                                    <div className=\"d-flex w-100\" style={{ maxHeight: \"34px\" }}>\n\n                                        <label className=\"text-end text-white fs-6 ms-4\" style={{ minWidth: \"90px\" }} htmlFor=\"title\">عنوان پیام</label>\n\n                                        <Field\n\n                                            type=\"text\"\n\n                                            name=\"title\"\n\n                                            placeholder=\"\"\n\n                                            required\n\n                                            className=\"form-control bg_input input_text\"\n\n                                        />\n\n                                    </div>\n\n                                </Grid>\n\n                            </Grid>\n\n                            <Grid container spacing={3} justify=\"space-between\" className=\"p-3\">\n\n                                <Grid item md>\n\n                                    <div className=\"d-flex w-100\">\n\n                                        <label className=\"text-end text-white fs-6 ms-4\" style={{ minWidth: \"90px\" }} htmlFor=\"amount\">متن پیام</label>\n\n                                        <Field\n\n                                            as=\"textarea\"\n\n                                            name=\"body\"\n\n                                            placeholder=\"متن پیام را بنویسید\"\n\n                                            required\n\n                                            className=\"form-control bg_input input_text\"\n\n                                        />\n\n                                    </div>\n\n                                </Grid>\n\n                            </Grid>\n\n                            {/* { Boolean(hasError) && <p className=\"text-danger\">{hasError}</p> } */}\n\n                            <div className=\"mt-4 pt-3 ms-5 ps-2 d-flex justify-content-end\">\n\n                                <Button disabled={loginLoading} variant=\"contained\" type=\"submit\" color=\"primary\" >\n\n                                    ارسال پیام\n\n                                    {loginLoading && <CircularProgress size={24} className=\"position-absolute\" />}\n\n                                </Button>\n\n                            </div>\n\n                        </div>\n\n                    </Form>\n\n                </Formik>\n\n            </div>\n\n        </div>\n\n    )\n\n}\n\n\n\nexport default NewMessage\n\n"]},"metadata":{},"sourceType":"module"}