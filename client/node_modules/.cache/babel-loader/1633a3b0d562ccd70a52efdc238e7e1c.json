{"ast":null,"code":"import * as events from '../base/constant';\nimport { detach, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * XhtmlValidation module called when set enableXhtml as true\n */\n\nvar XhtmlValidation =\n/** @class */\nfunction () {\n  function XhtmlValidation(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n\n  XhtmlValidation.prototype.addEventListener = function () {\n    this.parent.on(events.xhtmlValidation, this.enableXhtmlValidation, this);\n    this.parent.on(events.destroy, this.removeEventListener, this);\n  };\n\n  XhtmlValidation.prototype.removeEventListener = function () {\n    this.parent.off(events.xhtmlValidation, this.enableXhtmlValidation);\n    this.parent.off(events.destroy, this.removeEventListener);\n  };\n\n  XhtmlValidation.prototype.enableXhtmlValidation = function () {\n    if (this.parent.enableXhtml) {\n      if (isNullOrUndefined(this.parent.inputElement)) {\n        this.currentElement = this.parent.element;\n      } else {\n        this.currentElement = this.parent.inputElement;\n      }\n\n      this.clean(this.currentElement);\n      this.AddRootElement();\n      this.ImageTags();\n      this.removeTags();\n      this.RemoveUnsupported();\n      this.currentElement.innerHTML = this.selfEncloseValidation(this.currentElement.innerHTML, this.currentElement.innerText === '\\n' ? this.currentElement.innerText.length : this.currentElement.innerText.trim().length);\n      this.parent.setProperties({\n        value: this.currentElement.innerHTML\n      }, true);\n    }\n  };\n  /**\n   * @param {string} currentValue - specifies the string value.\n   * @param {number} valueLength - specifies the length of the current value.\n   * @returns {void}\n    */\n\n\n  XhtmlValidation.prototype.selfEncloseValidation = function (currentValue, valueLength) {\n    if (valueLength === 0 && currentValue.indexOf('table') < 0 && currentValue.indexOf('img') < 0) {\n      var arrayValue = currentValue.split('&nbsp;');\n      arrayValue[arrayValue.length - 1] = '&#8203;' + arrayValue[arrayValue.length - 1];\n      currentValue = arrayValue.join('');\n    }\n\n    currentValue = currentValue.replace(/<br>/g, '<br/>').replace(/<hr>/g, '<hr/>').replace(/ /g, ' ');\n    var valueTemp;\n    var valueDupe = [];\n    var valueOriginal = [];\n    var imgRegexp = [/<img(.*?)>/gi, /<area(.*?)>/gi, /<base(.*?)>/gi, /<col (.*?)>/gi, /<embed(.*?)>/gi, /<input(.*?)>/gi, /<link(.*?)>/gi, /<meta(.*?)>/gi, /<param(.*?)>/gi, /<source(.*?)>/gi, /<track(.*?)>/gi, /<wbr(.*?)>/gi];\n\n    for (var j = 0; j < imgRegexp.length; j++) {\n      valueTemp = imgRegexp[j].exec(currentValue);\n\n      while (valueTemp !== null) {\n        valueDupe.push(valueTemp[0].toString());\n        valueTemp = imgRegexp[j].exec(currentValue);\n      }\n\n      valueOriginal = valueDupe.slice(0);\n\n      for (var i = 0; i < valueDupe.length; i++) {\n        if (valueDupe[i].indexOf('/') === -1 || valueDupe[i].lastIndexOf('/') !== valueDupe[i].length - 2) {\n          valueDupe[i] = valueDupe[i].substr(0, valueDupe[i].length - 1) + ' /' + valueDupe[i].substr(valueDupe[i].length - 1, valueDupe[i].length);\n        }\n      }\n\n      for (var g = 0; g <= valueDupe.length - 1; g++) {\n        currentValue = currentValue.replace(valueOriginal[g], valueDupe[g]);\n      }\n    }\n\n    return currentValue;\n  };\n\n  XhtmlValidation.prototype.AddRootElement = function () {\n    if (this.currentElement.childNodes.length === 1 && this.currentElement.firstChild.nodeName !== 'DIV' || this.currentElement.childNodes.length > 1) {\n      var parentEle = this.parent.createElement('div');\n\n      while (this.currentElement.childNodes.length > 0) {\n        parentEle.appendChild(this.currentElement.childNodes[0]);\n      }\n\n      this.currentElement.appendChild(parentEle);\n    }\n  };\n\n  XhtmlValidation.prototype.clean = function (node) {\n    for (var n = 0; n < node.childNodes.length; n++) {\n      var child = node.childNodes[n];\n\n      if (child.nodeType === 8 || child.nodeName === 'V:IMAGE') {\n        node.removeChild(child);\n        n--;\n      } else if (child.nodeType === 1) {\n        this.clean(child);\n      }\n    }\n\n    return this.currentElement.innerHTML;\n  };\n\n  XhtmlValidation.prototype.ImageTags = function () {\n    var imgNodes = this.currentElement.querySelectorAll('IMG');\n\n    for (var i = imgNodes.length - 1; i >= 0; i--) {\n      if (!imgNodes[i].hasAttribute('alt')) {\n        var img = imgNodes[i];\n        img.setAttribute('alt', '');\n      }\n    }\n  };\n\n  XhtmlValidation.prototype.removeTags = function () {\n    var removeAttribute = [['br', 'ul'], ['br', 'ol'], ['table', 'span'], ['div', 'span'], ['p', 'span']];\n\n    for (var i = 0; i < removeAttribute.length; i++) {\n      this.RemoveElementNode(removeAttribute[i][0], removeAttribute[i][1]);\n    }\n  };\n\n  XhtmlValidation.prototype.RemoveElementNode = function (rmvNode, parentNode) {\n    var parentArray = this.currentElement.querySelectorAll(parentNode);\n\n    for (var i = 0; i < parentArray.length; i++) {\n      var rmvArray = parentArray[i].querySelectorAll(rmvNode);\n\n      for (var j = rmvArray.length; j > 0; j--) {\n        detach(rmvArray[j - 1]);\n      }\n    }\n  };\n\n  XhtmlValidation.prototype.RemoveUnsupported = function () {\n    var underlineEle = this.currentElement.querySelectorAll('u');\n\n    for (var i = underlineEle.length - 1; i >= 0; i--) {\n      var spanEle = this.parent.createElement('span');\n      spanEle.style.textDecoration = 'underline';\n      spanEle.innerHTML = underlineEle[i].innerHTML;\n      underlineEle[i].parentNode.insertBefore(spanEle, underlineEle[i]);\n      detach(underlineEle[i]);\n    }\n\n    var strongEle = this.currentElement.querySelectorAll('strong');\n\n    for (var i = strongEle.length - 1; i >= 0; i--) {\n      var boldEle = this.parent.createElement('b');\n      boldEle.innerHTML = strongEle[i].innerHTML;\n      strongEle[i].parentNode.insertBefore(boldEle, strongEle[i]);\n      detach(strongEle[i]);\n    }\n\n    var attrArray = ['language', 'role', 'target', 'contenteditable', 'cellspacing', 'cellpadding', 'border', 'valign', 'colspan'];\n\n    for (var i = 0; i <= attrArray.length; i++) {\n      this.RemoveAttributeByName(attrArray[i]);\n    }\n  };\n\n  XhtmlValidation.prototype.RemoveAttributeByName = function (attrName) {\n    if (this.currentElement.firstChild !== null) {\n      if (this.currentElement.firstChild.nodeType !== 3) {\n        for (var i = 0; i < this.currentElement.childNodes.length; i++) {\n          var ele = this.currentElement.childNodes[i];\n\n          if (ele.nodeType !== 3 && ele.nodeName !== 'TABLE' && ele.nodeName !== 'TBODY' && ele.nodeName !== 'THEAD' && ele.nodeName !== 'TH' && ele.nodeName !== 'TR' && ele.nodeName !== 'TD') {\n            if (ele.hasAttribute(attrName)) {\n              ele.removeAttribute(attrName);\n            }\n\n            if (ele.hasChildNodes()) {\n              for (var j = 0; j < ele.childNodes.length; j++) {\n                var childEle = ele.childNodes[j];\n\n                if (childEle.nodeType !== 3 && childEle.nodeName !== 'TABLE' && childEle.nodeName !== 'TBODY' && childEle.nodeName !== 'THEAD' && childEle.nodeName !== 'TH' && childEle.nodeName !== 'TR' && childEle.nodeName !== 'TD' && childEle.hasAttribute(attrName)) {\n                  childEle.removeAttribute(attrName);\n                }\n\n                if (childEle.hasChildNodes()) {\n                  for (var k = 0; k < childEle.childNodes.length; k++) {\n                    if (childEle.childNodes[k].nodeType !== 3 && childEle.childNodes[k].nodeName !== 'TABLE' && childEle.childNodes[k].nodeName !== 'TBODY' && childEle.childNodes[k].nodeName !== 'THEAD' && childEle.childNodes[k].nodeName !== 'TH' && childEle.childNodes[k].nodeName !== 'TR' && childEle.childNodes[k].nodeName !== 'TD' && childEle.childNodes[k].hasAttribute(attrName)) {\n                      childEle.childNodes[k].removeAttribute(attrName);\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  };\n\n  return XhtmlValidation;\n}();\n\nexport { XhtmlValidation };","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/xhtml-validation.js"],"names":["events","detach","isNullOrUndefined","XhtmlValidation","parent","addEventListener","prototype","on","xhtmlValidation","enableXhtmlValidation","destroy","removeEventListener","off","enableXhtml","inputElement","currentElement","element","clean","AddRootElement","ImageTags","removeTags","RemoveUnsupported","innerHTML","selfEncloseValidation","innerText","length","trim","setProperties","value","currentValue","valueLength","indexOf","arrayValue","split","join","replace","valueTemp","valueDupe","valueOriginal","imgRegexp","j","exec","push","toString","slice","i","lastIndexOf","substr","g","childNodes","firstChild","nodeName","parentEle","createElement","appendChild","node","n","child","nodeType","removeChild","imgNodes","querySelectorAll","hasAttribute","img","setAttribute","removeAttribute","RemoveElementNode","rmvNode","parentNode","parentArray","rmvArray","underlineEle","spanEle","style","textDecoration","insertBefore","strongEle","boldEle","attrArray","RemoveAttributeByName","attrName","ele","hasChildNodes","childEle","k"],"mappings":"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","sourcesContent":["import * as events from '../base/constant';\nimport { detach, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * XhtmlValidation module called when set enableXhtml as true\n */\nvar XhtmlValidation = /** @class */ (function () {\n    function XhtmlValidation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    XhtmlValidation.prototype.addEventListener = function () {\n        this.parent.on(events.xhtmlValidation, this.enableXhtmlValidation, this);\n        this.parent.on(events.destroy, this.removeEventListener, this);\n    };\n    XhtmlValidation.prototype.removeEventListener = function () {\n        this.parent.off(events.xhtmlValidation, this.enableXhtmlValidation);\n        this.parent.off(events.destroy, this.removeEventListener);\n    };\n    XhtmlValidation.prototype.enableXhtmlValidation = function () {\n        if (this.parent.enableXhtml) {\n            if (isNullOrUndefined(this.parent.inputElement)) {\n                this.currentElement = this.parent.element;\n            }\n            else {\n                this.currentElement = this.parent.inputElement;\n            }\n            this.clean(this.currentElement);\n            this.AddRootElement();\n            this.ImageTags();\n            this.removeTags();\n            this.RemoveUnsupported();\n            this.currentElement.innerHTML = this.selfEncloseValidation(this.currentElement.innerHTML, this.currentElement.innerText === '\\n' ?\n                this.currentElement.innerText.length : this.currentElement.innerText.trim().length);\n            this.parent.setProperties({ value: this.currentElement.innerHTML }, true);\n        }\n    };\n    /**\n     * @param {string} currentValue - specifies the string value.\n     * @param {number} valueLength - specifies the length of the current value.\n     * @returns {void}\n\n     */\n    XhtmlValidation.prototype.selfEncloseValidation = function (currentValue, valueLength) {\n        if (valueLength === 0 && currentValue.indexOf('table') < 0 && currentValue.indexOf('img') < 0) {\n            var arrayValue = currentValue.split('&nbsp;');\n            arrayValue[arrayValue.length - 1] = '&#8203;' + arrayValue[arrayValue.length - 1];\n            currentValue = arrayValue.join('');\n        }\n        currentValue = currentValue.replace(/<br>/g, '<br/>').replace(/<hr>/g, '<hr/>').replace(/ /g, ' ');\n        var valueTemp;\n        var valueDupe = [];\n        var valueOriginal = [];\n        var imgRegexp = [/<img(.*?)>/gi, /<area(.*?)>/gi, /<base(.*?)>/gi, /<col (.*?)>/gi, /<embed(.*?)>/gi,\n            /<input(.*?)>/gi, /<link(.*?)>/gi, /<meta(.*?)>/gi, /<param(.*?)>/gi, /<source(.*?)>/gi,\n            /<track(.*?)>/gi, /<wbr(.*?)>/gi];\n        for (var j = 0; j < imgRegexp.length; j++) {\n            valueTemp = imgRegexp[j].exec(currentValue);\n            while ((valueTemp) !== null) {\n                valueDupe.push(valueTemp[0].toString());\n                valueTemp = imgRegexp[j].exec(currentValue);\n            }\n            valueOriginal = valueDupe.slice(0);\n            for (var i = 0; i < valueDupe.length; i++) {\n                if (valueDupe[i].indexOf('/') === -1 || valueDupe[i].lastIndexOf('/') !== valueDupe[i].length - 2) {\n                    valueDupe[i] = valueDupe[i].substr(0, valueDupe[i].length - 1) + ' /' +\n                        valueDupe[i].substr(valueDupe[i].length - 1, valueDupe[i].length);\n                }\n            }\n            for (var g = 0; g <= valueDupe.length - 1; g++) {\n                currentValue = currentValue.replace(valueOriginal[g], valueDupe[g]);\n            }\n        }\n        return currentValue;\n    };\n    XhtmlValidation.prototype.AddRootElement = function () {\n        if ((this.currentElement.childNodes.length === 1 && this.currentElement.firstChild.nodeName !== 'DIV') ||\n            this.currentElement.childNodes.length > 1) {\n            var parentEle = this.parent.createElement('div');\n            while (this.currentElement.childNodes.length > 0) {\n                parentEle.appendChild(this.currentElement.childNodes[0]);\n            }\n            this.currentElement.appendChild(parentEle);\n        }\n    };\n    XhtmlValidation.prototype.clean = function (node) {\n        for (var n = 0; n < node.childNodes.length; n++) {\n            var child = node.childNodes[n];\n            if (child.nodeType === 8 || child.nodeName === 'V:IMAGE') {\n                node.removeChild(child);\n                n--;\n            }\n            else if (child.nodeType === 1) {\n                this.clean(child);\n            }\n        }\n        return this.currentElement.innerHTML;\n    };\n    XhtmlValidation.prototype.ImageTags = function () {\n        var imgNodes = this.currentElement.querySelectorAll('IMG');\n        for (var i = imgNodes.length - 1; i >= 0; i--) {\n            if (!imgNodes[i].hasAttribute('alt')) {\n                var img = imgNodes[i];\n                img.setAttribute('alt', '');\n            }\n        }\n    };\n    XhtmlValidation.prototype.removeTags = function () {\n        var removeAttribute = [['br', 'ul'], ['br', 'ol'], ['table', 'span'], ['div', 'span'], ['p', 'span']];\n        for (var i = 0; i < removeAttribute.length; i++) {\n            this.RemoveElementNode(removeAttribute[i][0], removeAttribute[i][1]);\n        }\n    };\n    XhtmlValidation.prototype.RemoveElementNode = function (rmvNode, parentNode) {\n        var parentArray = this.currentElement.querySelectorAll(parentNode);\n        for (var i = 0; i < parentArray.length; i++) {\n            var rmvArray = parentArray[i].querySelectorAll(rmvNode);\n            for (var j = rmvArray.length; j > 0; j--) {\n                detach(rmvArray[j - 1]);\n            }\n        }\n    };\n    XhtmlValidation.prototype.RemoveUnsupported = function () {\n        var underlineEle = this.currentElement.querySelectorAll('u');\n        for (var i = underlineEle.length - 1; i >= 0; i--) {\n            var spanEle = this.parent.createElement('span');\n            spanEle.style.textDecoration = 'underline';\n            spanEle.innerHTML = underlineEle[i].innerHTML;\n            underlineEle[i].parentNode.insertBefore(spanEle, underlineEle[i]);\n            detach(underlineEle[i]);\n        }\n        var strongEle = this.currentElement.querySelectorAll('strong');\n        for (var i = strongEle.length - 1; i >= 0; i--) {\n            var boldEle = this.parent.createElement('b');\n            boldEle.innerHTML = strongEle[i].innerHTML;\n            strongEle[i].parentNode.insertBefore(boldEle, strongEle[i]);\n            detach(strongEle[i]);\n        }\n        var attrArray = ['language', 'role', 'target', 'contenteditable', 'cellspacing',\n            'cellpadding', 'border', 'valign', 'colspan'];\n        for (var i = 0; i <= attrArray.length; i++) {\n            this.RemoveAttributeByName(attrArray[i]);\n        }\n    };\n    XhtmlValidation.prototype.RemoveAttributeByName = function (attrName) {\n        if (this.currentElement.firstChild !== null) {\n            if (this.currentElement.firstChild.nodeType !== 3) {\n                for (var i = 0; i < this.currentElement.childNodes.length; i++) {\n                    var ele = this.currentElement.childNodes[i];\n                    if (ele.nodeType !== 3 && ele.nodeName !== 'TABLE' && ele.nodeName !== 'TBODY' && ele.nodeName !== 'THEAD' &&\n                        ele.nodeName !== 'TH' && ele.nodeName !== 'TR' && ele.nodeName !== 'TD') {\n                        if (ele.hasAttribute(attrName)) {\n                            ele.removeAttribute(attrName);\n                        }\n                        if (ele.hasChildNodes()) {\n                            for (var j = 0; j < ele.childNodes.length; j++) {\n                                var childEle = ele.childNodes[j];\n                                if (childEle.nodeType !== 3 && childEle.nodeName !== 'TABLE' && childEle.nodeName !== 'TBODY' &&\n                                    childEle.nodeName !== 'THEAD' && childEle.nodeName !== 'TH' && childEle.nodeName !== 'TR' &&\n                                    childEle.nodeName !== 'TD' && childEle.hasAttribute(attrName)) {\n                                    childEle.removeAttribute(attrName);\n                                }\n                                if (childEle.hasChildNodes()) {\n                                    for (var k = 0; k < childEle.childNodes.length; k++) {\n                                        if (childEle.childNodes[k].nodeType !== 3 && childEle.childNodes[k].nodeName !== 'TABLE' &&\n                                            childEle.childNodes[k].nodeName !== 'TBODY' && childEle.childNodes[k].nodeName !== 'THEAD' &&\n                                            childEle.childNodes[k].nodeName !== 'TH' && childEle.childNodes[k].nodeName !== 'TR'\n                                            && childEle.childNodes[k].nodeName !== 'TD'\n                                            && childEle.childNodes[k].hasAttribute(attrName)) {\n                                            childEle.childNodes[k].removeAttribute(attrName);\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    return XhtmlValidation;\n}());\nexport { XhtmlValidation };\n"]},"metadata":{},"sourceType":"module"}