{"ast":null,"code":"import { createElement, closest, detach, Browser, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport * as CONSTANT from './../base/constant';\nimport { InsertHtml } from './inserthtml';\n/**\n * Link internal component\n *\n * @hidden\n\n */\n\nvar TableCommand =\n/** @class */\nfunction () {\n  /**\n   * Constructor for creating the Formats plugin\n   *\n   * @param {EditorManager} parent - specifies the parent element\n   * @hidden\n    */\n  function TableCommand(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n\n  TableCommand.prototype.addEventListener = function () {\n    this.parent.observer.on(CONSTANT.TABLE, this.createTable, this);\n    this.parent.observer.on(CONSTANT.INSERT_ROW, this.insertRow, this);\n    this.parent.observer.on(CONSTANT.INSERT_COLUMN, this.insertColumn, this);\n    this.parent.observer.on(CONSTANT.DELETEROW, this.deleteRow, this);\n    this.parent.observer.on(CONSTANT.DELETECOLUMN, this.deleteColumn, this);\n    this.parent.observer.on(CONSTANT.REMOVETABLE, this.removeTable, this);\n    this.parent.observer.on(CONSTANT.TABLEHEADER, this.tableHeader, this);\n    this.parent.observer.on(CONSTANT.TABLE_VERTICAL_ALIGN, this.tableVerticalAlign, this);\n    this.parent.observer.on(CONSTANT.TABLE_MERGE, this.cellMerge, this);\n    this.parent.observer.on(CONSTANT.TABLE_HORIZONTAL_SPLIT, this.HorizontalSplit, this);\n    this.parent.observer.on(CONSTANT.TABLE_VERTICAL_SPLIT, this.VerticalSplit, this);\n    this.parent.observer.on(CONSTANT.TABLE_MOVE, this.tableMove, this);\n  };\n\n  TableCommand.prototype.createTable = function (e) {\n    var table = createElement('table', {\n      className: 'e-rte-table'\n    });\n    var tblBody = createElement('tbody');\n\n    if (!isNOU(e.item.width.width)) {\n      table.style.width = this.calculateStyleValue(e.item.width.width);\n    }\n\n    if (!isNOU(e.item.width.minWidth)) {\n      table.style.minWidth = this.calculateStyleValue(e.item.width.minWidth);\n    }\n\n    if (!isNOU(e.item.width.maxWidth)) {\n      table.style.maxWidth = this.calculateStyleValue(e.item.width.maxWidth);\n    }\n\n    var tdWid = parseInt(e.item.width.width, 10) > 100 ? 100 / e.item.columns : parseInt(e.item.width.width, 10) / e.item.columns;\n\n    for (var i = 0; i < e.item.rows; i++) {\n      var row = createElement('tr');\n\n      for (var j = 0; j < e.item.columns; j++) {\n        var cell = createElement('td');\n        cell.appendChild(createElement('br'));\n        cell.style.width = tdWid + '%';\n        row.appendChild(cell);\n      }\n\n      tblBody.appendChild(row);\n    }\n\n    table.appendChild(tblBody);\n    e.item.selection.restore();\n    InsertHtml.Insert(this.parent.currentDocument, table, this.parent.editableElement);\n    this.removeEmptyNode();\n    e.item.selection.setSelectionText(this.parent.currentDocument, table.querySelector('td'), table.querySelector('td'), 0, 0);\n\n    if (table.nextElementSibling === null) {\n      var insertElem = void 0;\n\n      if (e.enterAction === 'DIV') {\n        insertElem = createElement('div');\n        insertElem.appendChild(createElement('br'));\n      } else if (e.enterAction === 'BR') {\n        insertElem = createElement('br');\n      } else {\n        insertElem = createElement('p');\n        insertElem.appendChild(createElement('br'));\n      }\n\n      this.insertAfter(insertElem, table);\n    }\n\n    table.querySelector('td').classList.add('e-cell-select');\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: 'Table',\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: [table]\n      });\n    }\n\n    return table;\n  };\n\n  TableCommand.prototype.calculateStyleValue = function (value) {\n    var styleValue;\n\n    if (typeof value === 'string') {\n      if (value.indexOf('px') || value.indexOf('%') || value.indexOf('auto')) {\n        styleValue = value;\n      } else {\n        styleValue = value + 'px';\n      }\n    } else {\n      styleValue = value + 'px';\n    }\n\n    return styleValue;\n  };\n\n  TableCommand.prototype.removeEmptyNode = function () {\n    var emptyUl = this.parent.editableElement.querySelectorAll('ul:empty, ol:empty');\n\n    for (var i = 0; i < emptyUl.length; i++) {\n      detach(emptyUl[i]);\n    }\n\n    var emptyLiChild = this.parent.editableElement.querySelectorAll('li *:empty');\n\n    for (var i = 0; i < emptyLiChild.length; i++) {\n      detach(emptyLiChild[i]);\n\n      if (emptyLiChild.length === i + 1) {\n        emptyLiChild = this.parent.editableElement.querySelectorAll('li *:empty');\n        i = -1;\n      }\n    }\n\n    var emptyLi = this.parent.editableElement.querySelectorAll('li:empty');\n\n    for (var i = 0; i < emptyLi.length; i++) {\n      detach(emptyLi[i]);\n    }\n  };\n\n  TableCommand.prototype.insertAfter = function (newNode, referenceNode) {\n    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  };\n\n  TableCommand.prototype.getSelectedCellMinMaxIndex = function (e) {\n    var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n    var a = 0;\n    var minI = e.length;\n    var maxI = 0;\n    var minJ = e[0].length;\n    var maxJ = 0; //eslint-disable-next-line\n\n    for (var i = 0; a < selectedCells.length; a++) {\n      var selectedCellIndex = this.getCorrespondingIndex(selectedCells[a], e);\n      var minMaxIndex = this.FindIndex(selectedCellIndex[0], selectedCellIndex[1], e); //eslint-disable-next-line\n\n      minI = Math.min(selectedCellIndex[0], minI), maxI = Math.max(minMaxIndex[0], maxI), minJ = Math.min(selectedCellIndex[1], minJ), maxJ = Math.max(minMaxIndex[1], maxJ);\n    }\n\n    return {\n      startRow: minI,\n      endRow: maxI,\n      startColumn: minJ,\n      endColumn: maxJ\n    };\n  };\n\n  TableCommand.prototype.insertRow = function (e) {\n    var isBelow = e.item.subCommand === 'InsertRowBefore' ? false : true;\n    var selectedCell = e.item.selection.range.startContainer;\n\n    if (!(selectedCell.nodeName === 'TH' || selectedCell.nodeName === 'TD')) {\n      selectedCell = closest(selectedCell.parentElement, 'td,th');\n    }\n\n    if (selectedCell.nodeName.toLowerCase() === 'th' && e.item.subCommand === 'InsertRowBefore') {\n      return;\n    }\n\n    this.curTable = closest(this.parent.nodeSelection.range.startContainer.parentElement, 'table');\n\n    if (this.curTable.querySelectorAll('.e-cell-select').length === 0) {\n      var lastRow = this.curTable.rows[this.curTable.rows.length - 1];\n      var cloneRow = lastRow.cloneNode(true);\n      cloneRow.removeAttribute('rowspan');\n      this.insertAfter(cloneRow, lastRow);\n    } else {\n      var allCells = this.getCorrespondingColumns();\n      var minMaxIndex = this.getSelectedCellMinMaxIndex(allCells);\n      var minVal = isBelow ? minMaxIndex.endRow : minMaxIndex.startRow;\n      var newRow = createElement('tr');\n      var isHeaderSelect = this.curTable.querySelectorAll('th.e-cell-select').length > 0;\n\n      for (var i = 0; i < allCells[minVal].length; i++) {\n        if (isBelow && minVal < allCells.length - 1 && allCells[minVal][i] === allCells[minVal + 1][i] || !isBelow && 0 < minVal && allCells[minVal][i] === allCells[minVal - 1][i]) {\n          if (0 === i || 0 < i && allCells[minVal][i] !== allCells[minVal][i - 1]) {\n            allCells[minVal][i].setAttribute('rowspan', (parseInt(allCells[minVal][i].getAttribute('rowspan'), 10) + 1).toString());\n          }\n        } else {\n          var tdElement = createElement('td');\n          tdElement.appendChild(createElement('br'));\n          newRow.appendChild(tdElement);\n          tdElement.setAttribute('style', allCells[isHeaderSelect && isBelow ? minVal + 1 : minVal][i].getAttribute('style'));\n        }\n      } // eslint-disable-next-line\n\n\n      var selectedRow = void 0;\n\n      if (isHeaderSelect && isBelow) {\n        selectedRow = this.curTable.querySelector('tbody').childNodes[0];\n      } else {\n        selectedRow = this.curTable.rows[minVal];\n      } // eslint-disable-next-line\n\n\n      e.item.subCommand === 'InsertRowBefore' ? selectedRow.parentElement.insertBefore(newRow, selectedRow) : isHeaderSelect ? selectedRow.parentElement.insertBefore(newRow, selectedRow) : this.insertAfter(newRow, selectedRow);\n    }\n\n    e.item.selection.setSelectionText(this.parent.currentDocument, e.item.selection.range.startContainer, e.item.selection.range.startContainer, 0, 0);\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.insertColumn = function (e) {\n    var selectedCell = e.item.selection.range.startContainer;\n\n    if (!(selectedCell.nodeName === 'TH' || selectedCell.nodeName === 'TD')) {\n      selectedCell = closest(selectedCell.parentElement, 'td,th');\n    }\n\n    var curRow = closest(selectedCell, 'tr');\n    var curCell;\n    var allRows = closest(curRow, 'table').rows;\n    var colIndex = Array.prototype.slice.call(curRow.querySelectorAll(':scope > td, :scope > th')).indexOf(selectedCell);\n    var previousWidth = parseInt(e.item.width, 10) / curRow.querySelectorAll(':scope > td, :scope > th').length;\n    var currentWidth = parseInt(e.item.width, 10) / (curRow.querySelectorAll(':scope > td, :scope > th').length + 1);\n    var currentTabElm = closest(curRow, 'table');\n    var thTdElm = closest(curRow, 'table').querySelectorAll('th,td');\n\n    for (var i = 0; i < thTdElm.length; i++) {\n      thTdElm[i].dataset.oldWidth = thTdElm[i].offsetWidth / currentTabElm.offsetWidth * 100 + '%';\n    }\n\n    for (var i = 0; i < allRows.length; i++) {\n      curCell = allRows[i].querySelectorAll(':scope > td, :scope > th')[colIndex];\n      var colTemplate = curCell.cloneNode(true);\n      colTemplate.innerHTML = '';\n      colTemplate.appendChild(createElement('br'));\n      colTemplate.removeAttribute('class');\n      colTemplate.removeAttribute('colspan');\n      colTemplate.removeAttribute('rowspan'); // eslint-disable-next-line\n\n      e.item.subCommand === 'InsertColumnLeft' ? curCell.parentElement.insertBefore(colTemplate, curCell) : this.insertAfter(colTemplate, curCell);\n      colTemplate.style.width = currentWidth.toFixed(4) + '%';\n      delete colTemplate.dataset.oldWidth;\n    }\n\n    for (var i = 0; i < thTdElm.length; i++) {\n      thTdElm[i].style.width = (Number(thTdElm[i].dataset.oldWidth.split('%')[0]) * currentWidth / previousWidth).toFixed(4) + '%';\n      delete thTdElm[i].dataset.oldWidth;\n    }\n\n    e.item.selection.setSelectionText(this.parent.currentDocument, selectedCell, selectedCell, 0, 0);\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.deleteColumn = function (e) {\n    var selectedCell = e.item.selection.range.startContainer;\n\n    if (selectedCell.nodeType === 3) {\n      selectedCell = closest(selectedCell.parentElement, 'td,th');\n    }\n\n    var tBodyHeadEle = closest(selectedCell, selectedCell.tagName === 'TH' ? 'thead' : 'tbody');\n    var rowIndex = tBodyHeadEle && Array.prototype.indexOf.call(tBodyHeadEle.childNodes, selectedCell.parentNode);\n    this.curTable = closest(selectedCell, 'table');\n    var curRow = closest(selectedCell, 'tr');\n\n    if (curRow.querySelectorAll('th,td').length === 1) {\n      e.item.selection.restore();\n      detach(closest(selectedCell.parentElement, 'table'));\n    } else {\n      var deleteIndex = void 0;\n      var allCells = this.getCorrespondingColumns(); //eslint-disable-next-line\n\n      var selectedMinMaxIndex = this.getSelectedCellMinMaxIndex(allCells);\n      var minCol = selectedMinMaxIndex.startColumn;\n      var maxCol = selectedMinMaxIndex.endColumn;\n\n      for (var i = 0; i < allCells.length; i++) {\n        var currentRow = allCells[i];\n\n        for (var j = 0; j < currentRow.length; j++) {\n          var currentCell = currentRow[j]; //eslint-disable-next-line\n\n          var currentCellIndex = this.getCorrespondingIndex(currentCell, allCells);\n          var colSpanVal = parseInt(currentCell.getAttribute('colspan'), 10) || 1;\n\n          if (currentCellIndex[1] + (colSpanVal - 1) >= minCol && currentCellIndex[1] <= maxCol) {\n            if (colSpanVal > 1) {\n              currentCell.setAttribute('colspan', (colSpanVal - 1).toString());\n            } else {\n              detach(currentCell);\n              deleteIndex = j;\n\n              if (Browser.isIE) {\n                e.item.selection.setSelectionText(this.parent.currentDocument, this.curTable.querySelector('td'), this.curTable.querySelector('td'), 0, 0);\n                this.curTable.querySelector('td, th').classList.add('e-cell-select');\n              }\n            }\n          }\n        }\n      }\n\n      if (deleteIndex > -1) {\n        var rowHeadEle = tBodyHeadEle.children[rowIndex];\n        var nextFocusCell = rowHeadEle && rowHeadEle.children[deleteIndex <= rowHeadEle.children.length - 1 ? deleteIndex : deleteIndex - 1];\n\n        if (nextFocusCell) {\n          e.item.selection.setSelectionText(this.parent.currentDocument, nextFocusCell, nextFocusCell, 0, 0);\n          nextFocusCell.classList.add('e-cell-select');\n        }\n      }\n    }\n\n    if (e.callBack) {\n      var sContainer = this.parent.nodeSelection.getRange(this.parent.currentDocument).startContainer;\n\n      if (sContainer.nodeName !== 'TD') {\n        var startChildLength = this.parent.nodeSelection.getRange(this.parent.currentDocument).startOffset;\n        var focusNode = sContainer.children[startChildLength];\n\n        if (focusNode) {\n          this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, focusNode, 0);\n        }\n      }\n\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.deleteRow = function (e) {\n    var selectedCell = e.item.selection.range.startContainer;\n\n    if (selectedCell.nodeType === 3) {\n      selectedCell = closest(selectedCell.parentElement, 'td,th');\n    }\n\n    var colIndex = Array.prototype.indexOf.call(selectedCell.parentNode.childNodes, selectedCell);\n    this.curTable = closest(selectedCell, 'table');\n    var currentRow;\n    var allCells = this.getCorrespondingColumns();\n    var minMaxIndex = this.getSelectedCellMinMaxIndex(allCells);\n    var maxI;\n    var j;\n\n    if (this.curTable.rows.length === 1) {\n      e.item.selection.restore();\n      detach(closest(selectedCell.parentElement, 'table'));\n    } else {\n      for (maxI = minMaxIndex.endRow; maxI >= minMaxIndex.startRow; maxI--) {\n        currentRow = this.curTable.rows[maxI];\n\n        for (j = 0; j < allCells[maxI].length; j++) {\n          if (j === 0 || allCells[maxI][j] !== allCells[maxI][j - 1]) {\n            if (1 < parseInt(allCells[maxI][j].getAttribute('rowspan'), 10)) {\n              var rowSpanVal = parseInt(allCells[maxI][j].getAttribute('rowspan'), 10) - 1; //eslint-disable-next-line\n\n              1 === rowSpanVal ? allCells[maxI][j].removeAttribute('rowspan') : allCells[maxI][j].setAttribute('rowspan', rowSpanVal.toString());\n            }\n          }\n\n          if (maxI < allCells.length - 1 && allCells[maxI][j] === allCells[maxI + 1][j] && (0 === maxI || allCells[maxI][j] !== allCells[maxI - 1][j])) {\n            var element = allCells[maxI][j];\n            var index = void 0;\n\n            for (index = j; 0 < index && allCells[maxI][index] === allCells[maxI][index - 1]; index--) {\n              if (index === 0) {\n                this.curTable.rows[maxI + 1].prepend(element);\n              } else {\n                allCells[maxI + 1][index - 1].insertAdjacentElement('afterend', element);\n              }\n            }\n          }\n        }\n\n        var deleteIndex = currentRow.rowIndex;\n        this.curTable.deleteRow(deleteIndex);\n        var focusTrEle = !isNOU(this.curTable.rows[deleteIndex]) ? this.curTable.querySelectorAll('tbody tr')[deleteIndex] : this.curTable.querySelectorAll('tbody tr')[deleteIndex - 1];\n        var nextFocusCell = focusTrEle && focusTrEle.querySelectorAll('td')[colIndex];\n\n        if (nextFocusCell) {\n          e.item.selection.setSelectionText(this.parent.currentDocument, nextFocusCell, nextFocusCell, 0, 0);\n          nextFocusCell.classList.add('e-cell-select');\n        } else {\n          e.item.selection.setSelectionText(this.parent.currentDocument, this.curTable.querySelector('td'), this.curTable.querySelector('td'), 0, 0);\n          this.curTable.querySelector('td, th').classList.add('e-cell-select');\n        }\n      }\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.removeTable = function (e) {\n    var selectedCell = e.item.selection.range.startContainer;\n    selectedCell = selectedCell.nodeType === 3 ? selectedCell.parentNode : selectedCell;\n    var selectedTable = closest(selectedCell.parentElement, 'table');\n\n    if (selectedTable) {\n      e.item.selection.restore();\n      detach(selectedTable);\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.tableHeader = function (e) {\n    var headerExit = false;\n    var selectedCell = e.item.selection.range.startContainer;\n    selectedCell = selectedCell.nodeType === 3 ? selectedCell.parentNode : selectedCell;\n    var table = closest(selectedCell.parentElement, 'table');\n    [].slice.call(table.childNodes).forEach(function (el) {\n      if (el.nodeName === 'THEAD') {\n        headerExit = true;\n      }\n    });\n\n    if (table && !headerExit) {\n      var cellCount = table.querySelector('tr').childElementCount;\n      var colSpanCount = 0;\n\n      for (var i = 0; i < cellCount; i++) {\n        colSpanCount = colSpanCount + (parseInt(table.querySelector('tr').children[i].getAttribute('colspan'), 10) || 1);\n      }\n\n      var header = table.createTHead();\n      var row = header.insertRow(0);\n\n      for (var j = 0; j < colSpanCount; j++) {\n        var th = createElement('th');\n        th.appendChild(createElement('br'));\n        row.appendChild(th);\n      }\n    } else {\n      table.deleteTHead();\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.tableVerticalAlign = function (e) {\n    if (e.item.subCommand === 'AlignTop') {\n      e.item.tableCell.style.verticalAlign = 'top';\n    } else if (e.item.subCommand === 'AlignMiddle') {\n      e.item.tableCell.style.verticalAlign = 'middle';\n    } else {\n      e.item.tableCell.style.verticalAlign = 'bottom';\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.cellMerge = function (e) {\n    if (isNOU(this.curTable)) {\n      this.curTable = closest(this.parent.nodeSelection.range.startContainer.parentElement, 'table');\n    }\n\n    var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n\n    if (selectedCells.length < 2) {\n      return;\n    }\n\n    this.mergeCellContent();\n    var minMaxIndexes = this.getSelectedMinMaxIndexes(this.getCorrespondingColumns());\n    var firstCell = selectedCells[0];\n    var rowSelectedCells = firstCell.parentElement.querySelectorAll('.e-cell-select');\n\n    if (minMaxIndexes.startColumn < minMaxIndexes.endColumn) {\n      firstCell.setAttribute('colspan', (minMaxIndexes.endColumn - minMaxIndexes.startColumn + 1).toString());\n    }\n\n    if (minMaxIndexes.startRow < minMaxIndexes.endRow) {\n      firstCell.setAttribute('rowspan', (minMaxIndexes.endRow - minMaxIndexes.startRow + 1).toString());\n    }\n\n    var totalWidth = 0;\n\n    for (var j = rowSelectedCells.length - 1; j >= 0; j--) {\n      totalWidth = totalWidth + parseFloat(rowSelectedCells[j].style.width);\n    }\n\n    firstCell.style.width = totalWidth + '%';\n\n    for (var i = 1; i <= selectedCells.length - 1; i++) {\n      detach(selectedCells[i]);\n    }\n\n    for (var i = 0; i < this.curTable.rows.length; i++) {\n      if (this.curTable.rows[i].innerHTML === '') {\n        detach(this.curTable.rows[i]);\n      }\n    }\n\n    this.updateRowSpanStyle(minMaxIndexes.startRow, minMaxIndexes.endRow, this.getCorrespondingColumns());\n    this.updateColSpanStyle(minMaxIndexes.startColumn, minMaxIndexes.endColumn, this.getCorrespondingColumns());\n    e.item.selection.setSelectionText(this.parent.currentDocument, e.item.selection.range.startContainer, e.item.selection.range.startContainer, 0, 0);\n\n    if (this.parent.nodeSelection.range) {\n      this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, // eslint-disable-next-line\n      this.parent.nodeSelection.range.endContainer, 0);\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.updateColSpanStyle = function (min, max, elements) {\n    var colValue;\n    var colIndex;\n    var colMin;\n    var index = 0;\n    var attrValue;\n    var count = 0;\n    var eleArray = elements; //eslint-disable-next-line\n\n    if (min < (max = Math.min(max, eleArray[0].length - 1))) {\n      for (colIndex === min; colIndex <= max; colIndex++) {\n        // eslint-disable-next-line\n        if (!(min < colIndex && eleArray[0][colIndex] === eleArray[0][colIndex - 1]) && 1 < (index = Math.min(parseInt(eleArray[0][colIndex].getAttribute('colspan'), 10) || 1, max - min + 1)) && eleArray[0][colIndex] === eleArray[0][colIndex + 1]) {\n          for (count = index - 1, colValue = 1; colValue < eleArray.length; colValue++) {\n            if (eleArray[colValue][colIndex] !== eleArray[colValue - 1][colIndex]) {\n              /* eslint-disable */\n              for (colMin = colIndex; colMin < colIndex + index; colMin++) {\n                if (1 < (attrValue = parseInt(eleArray[colValue][colMin].getAttribute('colspan'), 10) || 1) && eleArray[colValue][colMin] === eleArray[colValue][colMin + 1]) {\n                  colMin += count = Math.min(count, attrValue - 1);\n                } else if (!(count = Math.max(0, count - 1))) {\n                  break;\n                }\n                /* eslint-enable */\n\n              }\n            }\n\n            if (!count) {\n              break;\n            }\n          }\n        }\n      }\n\n      if (count) {\n        this.updateCellAttribute(eleArray, count, 'colspan', 0, eleArray.length - 1, min, max);\n      }\n    }\n  };\n\n  TableCommand.prototype.updateRowSpanStyle = function (min, max, ele) {\n    var rowValue;\n    var colIndex;\n    var rowMin;\n    var index = 0;\n    var attrValue;\n    var count = 0;\n    var eleArray = ele; // eslint-disable-next-line\n\n    if (min < (max = Math.min(max, eleArray.length - 1))) {\n      for (rowValue = min; rowValue <= max; rowValue++) {\n        // eslint-disable-next-line\n        if (!(min < rowValue && eleArray[rowValue][0] === eleArray[rowValue - 1][0]) && 1 < (index = Math.min(parseInt(eleArray[rowValue][0].getAttribute('rowspan'), 10) || 1, max - min + 1)) && eleArray[rowValue][0] === eleArray[rowValue + 1][0]) {\n          for (count = index - 1, colIndex = 1; colIndex < eleArray[0].length; colIndex++) {\n            if (eleArray[rowValue][colIndex] !== eleArray[rowValue][colIndex - 1]) {\n              for (rowMin = rowValue; rowMin < rowValue + index; rowMin++) {\n                // eslint-disable-next-line\n                if (1 < (attrValue = parseInt(eleArray[rowMin][colIndex].getAttribute('rowspan'), 10) || 1) && eleArray[rowMin][colIndex] === eleArray[rowMin + 1][colIndex]) {\n                  rowMin += count = Math.min(count, attrValue - 1);\n                } // eslint-disable-next-line\n                else if (!(count = Math.max(0, count - 1))) {\n                    break;\n                  }\n              }\n\n              if (!count) {\n                break;\n              }\n            }\n          }\n        }\n      }\n\n      if (count) {\n        this.updateCellAttribute(eleArray, count, 'rowspan', min, max, 0, eleArray[0].length - 1);\n      }\n    }\n  };\n\n  TableCommand.prototype.updateCellAttribute = function (elements, index, attr, min, max, firstIndex, length) {\n    var rowIndex;\n    var colIndex;\n    var spanCount;\n\n    for (rowIndex = min; rowIndex <= max; rowIndex++) {\n      for (colIndex = firstIndex; colIndex <= length; colIndex++) {\n        // eslint-disable-next-line\n        min < rowIndex && elements[rowIndex][colIndex] === elements[rowIndex - 1][colIndex] || firstIndex < colIndex && elements[rowIndex][colIndex] === elements[rowIndex][colIndex - 1] || 1 < (spanCount = parseInt(elements[rowIndex][colIndex].getAttribute(attr), 10) || 1) && (1 < spanCount - index ? elements[rowIndex][colIndex].setAttribute(attr, (spanCount - index).toString()) : elements[rowIndex][colIndex].removeAttribute(attr));\n      }\n    }\n  };\n\n  TableCommand.prototype.mergeCellContent = function () {\n    var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n    var innerHtml = selectedCells[0].innerHTML;\n\n    for (var i = 1; i < selectedCells.length - 1; i++) {\n      if ('<br>' !== selectedCells[i].innerHTML) {\n        innerHtml = innerHtml + selectedCells[i].innerHTML;\n      }\n    }\n\n    selectedCells[0].innerHTML = innerHtml;\n  };\n\n  TableCommand.prototype.getSelectedMinMaxIndexes = function (correspondingCells) {\n    var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n\n    if (0 < selectedCells.length) {\n      var minRow = correspondingCells.length;\n      var maxRow = 0;\n      var minCol = correspondingCells[0].length;\n      var maxCol = 0;\n\n      for (var i = 0; i < selectedCells.length; i++) {\n        var currentRowCol = this.getCorrespondingIndex(selectedCells[i], correspondingCells);\n        var targetRowCol = this.FindIndex(currentRowCol[0], currentRowCol[1], correspondingCells);\n        minRow = Math.min(currentRowCol[0], minRow);\n        maxRow = Math.max(targetRowCol[0], maxRow);\n        minCol = Math.min(currentRowCol[1], minCol);\n        maxCol = Math.max(targetRowCol[1], maxCol);\n      }\n\n      return {\n        startRow: minRow,\n        endRow: maxRow,\n        startColumn: minCol,\n        endColumn: maxCol\n      };\n    }\n\n    return null;\n  };\n\n  TableCommand.prototype.HorizontalSplit = function (e) {\n    var selectedCell = e.item.selection.range.startContainer;\n    this.curTable = closest(selectedCell.parentElement, 'table');\n\n    if (this.curTable.querySelectorAll('.e-cell-select').length > 1) {\n      return;\n    }\n\n    this.activeCell = this.curTable.querySelector('.e-cell-select');\n    var newCell = this.activeCell.cloneNode(true);\n    newCell.removeAttribute('class');\n    newCell.innerHTML = '</br>';\n    var activeCellIndex = this.getCorrespondingIndex(this.activeCell, this.getCorrespondingColumns());\n    var correspondingCells = this.getCorrespondingColumns();\n    var activeCellRowSpan = this.activeCell.getAttribute('rowspan') ? parseInt(this.activeCell.getAttribute('rowspan'), 10) : 1;\n\n    if (activeCellRowSpan > 1) {\n      var avgCount = Math.ceil(activeCellRowSpan / 2); // eslint-disable-next-line\n\n      1 < avgCount ? this.activeCell.setAttribute('rowspan', avgCount.toString()) : this.activeCell.removeAttribute('rowspan'); // eslint-disable-next-line\n\n      1 < activeCellRowSpan - avgCount ? newCell.setAttribute('rowspan', (activeCellRowSpan - avgCount).toString()) : newCell.removeAttribute('rowspan');\n      var avgRowIndex = void 0;\n      var colIndex = void 0;\n\n      for (avgRowIndex = activeCellIndex[0] + Math.ceil(activeCellRowSpan / 2), colIndex = 0 === activeCellIndex[1] ? activeCellIndex[1] : activeCellIndex[1] - 1; 0 <= colIndex && (correspondingCells[avgRowIndex][colIndex] === correspondingCells[avgRowIndex][colIndex - 1] || 0 < avgRowIndex && correspondingCells[avgRowIndex][colIndex] === correspondingCells[avgRowIndex - 1][colIndex]);) {\n        colIndex--;\n      }\n\n      if (colIndex === -1) {\n        // eslint-disable-next-line\n        this.curTable.rows[avgRowIndex].firstChild ? this.curTable.rows[avgRowIndex].prepend(newCell) : this.curTable.appendChild(newCell);\n      } else {\n        correspondingCells[avgRowIndex][colIndex].insertAdjacentElement('afterend', newCell);\n      }\n    } else {\n      var newTrEle = createElement('tr');\n      newTrEle.appendChild(newCell);\n      var selectedRow = correspondingCells[activeCellIndex[0]];\n\n      for (var j = 0; j <= selectedRow.length - 1; j++) {\n        if (selectedRow[j] !== selectedRow[j - 1] && selectedRow[j] !== this.activeCell) {\n          selectedRow[j].setAttribute('rowspan', ((parseInt(selectedRow[j].getAttribute('rowspan'), 10) ? parseInt(selectedRow[j].getAttribute('rowspan'), 10) : 1) + 1).toString());\n        }\n      }\n\n      this.activeCell.parentNode.insertAdjacentElement('afterend', newTrEle);\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.VerticalSplit = function (e) {\n    var selectedCell = e.item.selection.range.startContainer;\n    this.curTable = closest(selectedCell.parentElement, 'table');\n\n    if (this.curTable.querySelectorAll('.e-cell-select').length > 1) {\n      return;\n    }\n\n    this.activeCell = this.curTable.querySelector('.e-cell-select');\n    var allRows = this.curTable.rows;\n    var newCell = this.activeCell.cloneNode(true);\n    newCell.removeAttribute('class');\n    newCell.innerHTML = '</br>';\n    var avgWidth = parseFloat(this.activeCell.style.width) / 2;\n\n    if (this.activeCell.tagName === 'TH' && isNaN(avgWidth)) {\n      var cellCount = this.curTable.querySelector('tr').childElementCount;\n      var colSpanCount = 0;\n\n      for (var i = 0; i < cellCount; i++) {\n        colSpanCount = colSpanCount + (parseInt(this.curTable.querySelector('tr').children[i].getAttribute('colspan'), 10) || 1);\n      }\n\n      avgWidth = parseFloat((this.activeCell.offsetWidth / 2 / this.curTable.offsetWidth * 100).toFixed(1));\n    }\n\n    var activeCellIndex = this.getCorrespondingIndex(this.activeCell, this.getCorrespondingColumns());\n    var correspondingColumns = this.getCorrespondingColumns();\n    var activeCellcolSpan = parseInt(this.activeCell.getAttribute('colspan'), 10);\n\n    if (activeCellcolSpan > 1) {\n      // eslint-disable-next-line\n      1 < Math.ceil(activeCellcolSpan / 2) ? this.activeCell.setAttribute('colspan', (activeCellcolSpan / 2).toString()) : this.activeCell.removeAttribute('colspan'); // eslint-disable-next-line\n\n      1 < activeCellcolSpan - activeCellcolSpan / 2 ? newCell.setAttribute('colspan', // eslint-disable-next-line\n      (activeCellcolSpan - activeCellcolSpan / 2).toString()) : newCell.removeAttribute('colspan');\n    } else {\n      for (var i = 0; i <= allRows.length - 1; i++) {\n        if (0 === i || correspondingColumns[i][activeCellIndex[1]] !== correspondingColumns[i - 1][activeCellIndex[1]]) {\n          var currentCell = correspondingColumns[i][activeCellIndex[1]];\n\n          if (currentCell !== this.activeCell) {\n            currentCell.setAttribute('colspan', ((parseInt(currentCell.getAttribute('colspan'), 10) ? parseInt(currentCell.getAttribute('colspan'), 10) : 1) + 1).toString());\n          }\n        }\n      }\n    }\n\n    this.activeCell.style.width = avgWidth + '%';\n    newCell.style.width = avgWidth + '%';\n    this.activeCell.parentNode.insertBefore(newCell, this.activeCell.nextSibling);\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  TableCommand.prototype.getCorrespondingColumns = function () {\n    var elementArray = []; // eslint-disable-next-line\n\n    var _this = this;\n\n    var colspan = 0;\n    var allRows = _this.curTable.rows;\n\n    for (var i = 0; i <= allRows.length - 1; i++) {\n      var ele = allRows[i];\n      var index = 0;\n\n      for (var j = 0; j <= ele.children.length - 1; j++) {\n        /* eslint-disable */\n        var colEle = ele.children[j];\n\n        for (var ele_1 = colEle, colspan_1 = parseInt(ele_1.getAttribute('colspan'), 10) || 1, rowSpan = parseInt(ele_1.getAttribute('rowspan'), 10) || 1, rowIndex = i; rowIndex < i + rowSpan; rowIndex++) {\n          for (var colIndex = index; colIndex < index + colspan_1; colIndex++) {\n            elementArray[rowIndex] || (elementArray[rowIndex] = []);\n            elementArray[rowIndex][colIndex] ? index++ : elementArray[rowIndex][colIndex] = colEle;\n          }\n        }\n\n        index += colspan;\n      }\n      /* eslint-enable */\n\n    }\n\n    return elementArray;\n  }; // eslint-disable-next-line\n\n\n  TableCommand.prototype.FindIndex = function (rowIndex, columnIndex, cells) {\n    var nextIndex;\n    var nextCol;\n\n    for (nextIndex = rowIndex + 1, nextCol = columnIndex + 1; nextIndex < cells.length;) {\n      if (cells[nextIndex][columnIndex] !== cells[rowIndex][columnIndex]) {\n        nextIndex--;\n        break;\n      }\n\n      nextIndex++;\n    }\n\n    for (nextIndex === cells.length && nextIndex--; nextCol < cells[rowIndex].length;) {\n      if (cells[rowIndex][nextCol] !== cells[rowIndex][columnIndex]) {\n        nextCol--;\n        break;\n      }\n\n      nextCol++;\n    }\n\n    return nextCol === cells[rowIndex].length && nextCol--, [nextIndex, nextCol];\n  };\n\n  TableCommand.prototype.getCorrespondingIndex = function (cell, allCells) {\n    //let value: RowCol = new RowCol();\n    for (var i = 0; i < allCells.length; i++) {\n      for (var j = 0; j < allCells[i].length; j++) {\n        if (allCells[i][j] === cell) {\n          return [i, j];\n        }\n      }\n    }\n\n    return [];\n  };\n\n  TableCommand.prototype.highlightCells = function (minRow, maxRow, minCol, maxCol, eleArray) {\n    var j;\n    var k;\n    var startCell;\n    var endCell;\n    var minRowIndex = minRow;\n    var maxRowIndex = maxRow;\n    var minColIndex = minCol;\n    var maxColIndex = maxCol;\n    var minMaxValues = new MinMax();\n\n    for (j = minRowIndex; j <= maxRowIndex; j++) {\n      /* eslint-disable */\n      if ((1 < (parseInt(eleArray[j][minColIndex].getAttribute('rowspan'), 10) || 1) || 1 < (parseInt(eleArray[j][minColIndex].getAttribute('colspan'), 10) || 1)) && (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[j][minColIndex], eleArray))[0], startCell[1], eleArray))) {\n        minRowIndex = Math.min(startCell[0], minRowIndex);\n        maxRowIndex = Math.max(endCell[0], maxRowIndex);\n        minColIndex = Math.min(startCell[1], minColIndex);\n        maxColIndex = Math.max(endCell[1], maxColIndex);\n      } else if ((1 < (parseInt(eleArray[j][maxColIndex].getAttribute('rowspan'), 10) || 1) || 1 < (parseInt(eleArray[j][maxColIndex].getAttribute('colspan'), 10) || 1)) && (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[j][maxColIndex], eleArray))[0], startCell[1], eleArray))) {\n        minRowIndex = Math.min(startCell[0], minRowIndex);\n        maxRowIndex = Math.max(endCell[0], maxRowIndex);\n        minColIndex = Math.min(startCell[1], minColIndex);\n        maxColIndex = Math.max(endCell[1], maxColIndex);\n      }\n\n      for (k = minColIndex; k <= maxColIndex; k++) {\n        if ((1 < (parseInt(eleArray[minRowIndex][k].getAttribute('rowspan'), 10) || 1) || 1 < (parseInt(eleArray[minRowIndex][k].getAttribute('colspan'), 10) || 1)) && (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[minRowIndex][k], eleArray))[0], startCell[1], eleArray))) {\n          minRowIndex = Math.min(startCell[0], minRowIndex);\n          maxRowIndex = Math.max(endCell[0], maxRowIndex);\n          minColIndex = Math.min(startCell[1], minColIndex);\n          maxColIndex = Math.max(endCell[1], maxColIndex);\n        } else if ((1 < (parseInt(eleArray[maxRowIndex][k].getAttribute('rowspan'), 10) || 1) || 1 < (parseInt(eleArray[maxRowIndex][k].getAttribute('colspan'), 10) || 1)) && (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[maxRowIndex][k], eleArray))[0], startCell[1], eleArray))) {\n          minRowIndex = Math.min(startCell[0], minRowIndex);\n          maxRowIndex = Math.max(endCell[0], maxRowIndex);\n          minColIndex = Math.min(startCell[1], minColIndex);\n          maxColIndex = Math.max(endCell[1], maxColIndex);\n        }\n      }\n\n      minMaxValues = minRowIndex === minRow && maxRowIndex === maxRow && minColIndex === minCol && maxColIndex === maxCol ? {\n        startRow: minRow,\n        endRow: maxRow,\n        startColumn: minCol,\n        endColumn: maxCol\n      } : this.highlightCells(minRowIndex, maxRowIndex, minColIndex, maxColIndex, eleArray);\n    }\n\n    return minMaxValues;\n    /* eslint-enable */\n  };\n\n  TableCommand.prototype.tableMove = function (e) {\n    this.activeCell = e.selectNode[0];\n    var target = e.event.target;\n    var activeCellTag = this.activeCell.tagName;\n    var targetCellTag = target.tagName;\n    this.curTable = closest(target, 'table');\n\n    if (this.curTable.querySelectorAll('.e-cell-select').length > 1) {\n      this.parent.nodeSelection.Clear(this.parent.currentDocument);\n    }\n\n    if (target.tagName !== 'TD' && target.tagName !== 'TH' && activeCellTag !== targetCellTag) {\n      return;\n    }\n\n    var activeRowIndex = Array.prototype.slice.call(this.activeCell.parentElement.parentElement.children).indexOf(this.activeCell.parentElement);\n    var activeColumnIndex = Array.prototype.slice.call(this.activeCell.parentElement.children).indexOf(this.activeCell);\n    var targetRowIndex = Array.prototype.slice.call(target.parentElement.parentElement.children).indexOf(target.parentElement);\n    var targetColumnIndex = Array.prototype.slice.call(target.parentElement.children).indexOf(target);\n    var activeCellList = this.curTable.querySelectorAll('.e-cell-select');\n\n    for (var i = activeCellList.length - 1; i >= 0; i--) {\n      if (this.activeCell !== activeCellList[i]) {\n        activeCellList[i].classList.remove('e-cell-select');\n      }\n    }\n\n    if (activeRowIndex === targetRowIndex && activeColumnIndex === targetColumnIndex) {\n      return;\n    }\n\n    var correspondingCells = this.getCorrespondingColumns();\n    var activeIndexes = this.getCorrespondingIndex(this.activeCell, correspondingCells);\n    var targetIndexes = this.getCorrespondingIndex(target, correspondingCells);\n    var minMaxIndexes = this.highlightCells(Math.min(activeIndexes[0], targetIndexes[0]), Math.max(activeIndexes[0],\n    /* eslint-disable */\n    targetIndexes[0]), Math.min(activeIndexes[1], targetIndexes[1]), Math.max(activeIndexes[1], targetIndexes[1]), correspondingCells);\n\n    for (var rowIndex = minMaxIndexes.startRow; rowIndex <= minMaxIndexes.endRow; rowIndex++) {\n      for (var colIndex = minMaxIndexes.startColumn; colIndex <= minMaxIndexes.endColumn; colIndex++) {\n        correspondingCells[rowIndex][colIndex].classList.add('e-cell-select');\n      }\n    }\n\n    if (this.parent.nodeSelection.range) {\n      this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, this.parent.nodeSelection.range.endContainer, this.parent.nodeSelection.range.endContainer, 0, 0);\n      this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, this.parent.nodeSelection.range.endContainer, 0);\n    }\n  };\n\n  ;\n  return TableCommand;\n}();\n\nexport { TableCommand };\n\nvar MinMax =\n/** @class */\nfunction () {\n  function MinMax() {}\n\n  return MinMax;\n}();","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/table.js"],"names":["createElement","closest","detach","Browser","isNullOrUndefined","isNOU","CONSTANT","InsertHtml","TableCommand","parent","addEventListener","prototype","observer","on","TABLE","createTable","INSERT_ROW","insertRow","INSERT_COLUMN","insertColumn","DELETEROW","deleteRow","DELETECOLUMN","deleteColumn","REMOVETABLE","removeTable","TABLEHEADER","tableHeader","TABLE_VERTICAL_ALIGN","tableVerticalAlign","TABLE_MERGE","cellMerge","TABLE_HORIZONTAL_SPLIT","HorizontalSplit","TABLE_VERTICAL_SPLIT","VerticalSplit","TABLE_MOVE","tableMove","e","table","className","tblBody","item","width","style","calculateStyleValue","minWidth","maxWidth","tdWid","parseInt","columns","i","rows","row","j","cell","appendChild","selection","restore","Insert","currentDocument","editableElement","removeEmptyNode","setSelectionText","querySelector","nextElementSibling","insertElem","enterAction","insertAfter","classList","add","callBack","requestType","editorMode","event","range","nodeSelection","getRange","elements","value","styleValue","indexOf","emptyUl","querySelectorAll","length","emptyLiChild","emptyLi","newNode","referenceNode","parentNode","insertBefore","nextSibling","getSelectedCellMinMaxIndex","selectedCells","curTable","a","minI","maxI","minJ","maxJ","selectedCellIndex","getCorrespondingIndex","minMaxIndex","FindIndex","Math","min","max","startRow","endRow","startColumn","endColumn","isBelow","subCommand","selectedCell","startContainer","nodeName","parentElement","toLowerCase","lastRow","cloneRow","cloneNode","removeAttribute","allCells","getCorrespondingColumns","minVal","newRow","isHeaderSelect","setAttribute","getAttribute","toString","tdElement","selectedRow","childNodes","getSelectedNodes","curRow","curCell","allRows","colIndex","Array","slice","call","previousWidth","currentWidth","currentTabElm","thTdElm","dataset","oldWidth","offsetWidth","colTemplate","innerHTML","toFixed","Number","split","nodeType","tBodyHeadEle","tagName","rowIndex","deleteIndex","selectedMinMaxIndex","minCol","maxCol","currentRow","currentCell","currentCellIndex","colSpanVal","isIE","rowHeadEle","children","nextFocusCell","sContainer","startChildLength","startOffset","focusNode","setCursorPoint","rowSpanVal","element","index","prepend","insertAdjacentElement","focusTrEle","selectedTable","headerExit","forEach","el","cellCount","childElementCount","colSpanCount","header","createTHead","th","deleteTHead","tableCell","verticalAlign","mergeCellContent","minMaxIndexes","getSelectedMinMaxIndexes","firstCell","rowSelectedCells","totalWidth","parseFloat","updateRowSpanStyle","updateColSpanStyle","endContainer","colValue","colMin","attrValue","count","eleArray","updateCellAttribute","ele","rowValue","rowMin","attr","firstIndex","spanCount","innerHtml","correspondingCells","minRow","maxRow","currentRowCol","targetRowCol","activeCell","newCell","activeCellIndex","activeCellRowSpan","avgCount","ceil","avgRowIndex","firstChild","newTrEle","avgWidth","isNaN","correspondingColumns","activeCellcolSpan","elementArray","_this","colspan","colEle","ele_1","colspan_1","rowSpan","columnIndex","cells","nextIndex","nextCol","highlightCells","k","startCell","endCell","minRowIndex","maxRowIndex","minColIndex","maxColIndex","minMaxValues","MinMax","selectNode","target","activeCellTag","targetCellTag","Clear","activeRowIndex","activeColumnIndex","targetRowIndex","targetColumnIndex","activeCellList","remove","activeIndexes","targetIndexes"],"mappings":"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","sourcesContent":["import { createElement, closest, detach, Browser, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport * as CONSTANT from './../base/constant';\nimport { InsertHtml } from './inserthtml';\n/**\n * Link internal component\n *\n * @hidden\n\n */\nvar TableCommand = /** @class */ (function () {\n    /**\n     * Constructor for creating the Formats plugin\n     *\n     * @param {EditorManager} parent - specifies the parent element\n     * @hidden\n\n     */\n    function TableCommand(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    TableCommand.prototype.addEventListener = function () {\n        this.parent.observer.on(CONSTANT.TABLE, this.createTable, this);\n        this.parent.observer.on(CONSTANT.INSERT_ROW, this.insertRow, this);\n        this.parent.observer.on(CONSTANT.INSERT_COLUMN, this.insertColumn, this);\n        this.parent.observer.on(CONSTANT.DELETEROW, this.deleteRow, this);\n        this.parent.observer.on(CONSTANT.DELETECOLUMN, this.deleteColumn, this);\n        this.parent.observer.on(CONSTANT.REMOVETABLE, this.removeTable, this);\n        this.parent.observer.on(CONSTANT.TABLEHEADER, this.tableHeader, this);\n        this.parent.observer.on(CONSTANT.TABLE_VERTICAL_ALIGN, this.tableVerticalAlign, this);\n        this.parent.observer.on(CONSTANT.TABLE_MERGE, this.cellMerge, this);\n        this.parent.observer.on(CONSTANT.TABLE_HORIZONTAL_SPLIT, this.HorizontalSplit, this);\n        this.parent.observer.on(CONSTANT.TABLE_VERTICAL_SPLIT, this.VerticalSplit, this);\n        this.parent.observer.on(CONSTANT.TABLE_MOVE, this.tableMove, this);\n    };\n    TableCommand.prototype.createTable = function (e) {\n        var table = createElement('table', { className: 'e-rte-table' });\n        var tblBody = createElement('tbody');\n        if (!isNOU(e.item.width.width)) {\n            table.style.width = this.calculateStyleValue(e.item.width.width);\n        }\n        if (!isNOU(e.item.width.minWidth)) {\n            table.style.minWidth = this.calculateStyleValue(e.item.width.minWidth);\n        }\n        if (!isNOU(e.item.width.maxWidth)) {\n            table.style.maxWidth = this.calculateStyleValue(e.item.width.maxWidth);\n        }\n        var tdWid = parseInt(e.item.width.width, 10) > 100 ?\n            100 / e.item.columns : parseInt(e.item.width.width, 10) / e.item.columns;\n        for (var i = 0; i < e.item.rows; i++) {\n            var row = createElement('tr');\n            for (var j = 0; j < e.item.columns; j++) {\n                var cell = createElement('td');\n                cell.appendChild(createElement('br'));\n                cell.style.width = tdWid + '%';\n                row.appendChild(cell);\n            }\n            tblBody.appendChild(row);\n        }\n        table.appendChild(tblBody);\n        e.item.selection.restore();\n        InsertHtml.Insert(this.parent.currentDocument, table, this.parent.editableElement);\n        this.removeEmptyNode();\n        e.item.selection.setSelectionText(this.parent.currentDocument, table.querySelector('td'), table.querySelector('td'), 0, 0);\n        if (table.nextElementSibling === null) {\n            var insertElem = void 0;\n            if (e.enterAction === 'DIV') {\n                insertElem = createElement('div');\n                insertElem.appendChild(createElement('br'));\n            }\n            else if (e.enterAction === 'BR') {\n                insertElem = createElement('br');\n            }\n            else {\n                insertElem = createElement('p');\n                insertElem.appendChild(createElement('br'));\n            }\n            this.insertAfter(insertElem, table);\n        }\n        table.querySelector('td').classList.add('e-cell-select');\n        if (e.callBack) {\n            e.callBack({\n                requestType: 'Table',\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: [table]\n            });\n        }\n        return table;\n    };\n    TableCommand.prototype.calculateStyleValue = function (value) {\n        var styleValue;\n        if (typeof (value) === 'string') {\n            if (value.indexOf('px') || value.indexOf('%') || value.indexOf('auto')) {\n                styleValue = value;\n            }\n            else {\n                styleValue = value + 'px';\n            }\n        }\n        else {\n            styleValue = value + 'px';\n        }\n        return styleValue;\n    };\n    TableCommand.prototype.removeEmptyNode = function () {\n        var emptyUl = this.parent.editableElement.querySelectorAll('ul:empty, ol:empty');\n        for (var i = 0; i < emptyUl.length; i++) {\n            detach(emptyUl[i]);\n        }\n        var emptyLiChild = this.parent.editableElement.querySelectorAll('li *:empty');\n        for (var i = 0; i < emptyLiChild.length; i++) {\n            detach(emptyLiChild[i]);\n            if (emptyLiChild.length === i + 1) {\n                emptyLiChild = this.parent.editableElement.querySelectorAll('li *:empty');\n                i = -1;\n            }\n        }\n        var emptyLi = this.parent.editableElement.querySelectorAll('li:empty');\n        for (var i = 0; i < emptyLi.length; i++) {\n            detach(emptyLi[i]);\n        }\n    };\n    TableCommand.prototype.insertAfter = function (newNode, referenceNode) {\n        referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n    };\n    TableCommand.prototype.getSelectedCellMinMaxIndex = function (e) {\n        var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n        var a = 0;\n        var minI = e.length;\n        var maxI = 0;\n        var minJ = e[0].length;\n        var maxJ = 0;\n        //eslint-disable-next-line\n        for (var i = 0; a < selectedCells.length; a++) {\n            var selectedCellIndex = this.getCorrespondingIndex(selectedCells[a], e);\n            var minMaxIndex = this.FindIndex(selectedCellIndex[0], selectedCellIndex[1], e);\n            //eslint-disable-next-line\n            minI = Math.min(selectedCellIndex[0], minI),\n                maxI = Math.max(minMaxIndex[0], maxI),\n                minJ = Math.min(selectedCellIndex[1], minJ),\n                maxJ = Math.max(minMaxIndex[1], maxJ);\n        }\n        return {\n            startRow: minI,\n            endRow: maxI,\n            startColumn: minJ,\n            endColumn: maxJ\n        };\n    };\n    TableCommand.prototype.insertRow = function (e) {\n        var isBelow = e.item.subCommand === 'InsertRowBefore' ? false : true;\n        var selectedCell = e.item.selection.range.startContainer;\n        if (!(selectedCell.nodeName === 'TH' || selectedCell.nodeName === 'TD')) {\n            selectedCell = closest(selectedCell.parentElement, 'td,th');\n        }\n        if (selectedCell.nodeName.toLowerCase() === 'th' && e.item.subCommand === 'InsertRowBefore') {\n            return;\n        }\n        this.curTable = closest(this.parent.nodeSelection.range.startContainer.parentElement, 'table');\n        if (this.curTable.querySelectorAll('.e-cell-select').length === 0) {\n            var lastRow = this.curTable.rows[this.curTable.rows.length - 1];\n            var cloneRow = lastRow.cloneNode(true);\n            cloneRow.removeAttribute('rowspan');\n            this.insertAfter(cloneRow, lastRow);\n        }\n        else {\n            var allCells = this.getCorrespondingColumns();\n            var minMaxIndex = this.getSelectedCellMinMaxIndex(allCells);\n            var minVal = isBelow ? minMaxIndex.endRow : minMaxIndex.startRow;\n            var newRow = createElement('tr');\n            var isHeaderSelect = this.curTable.querySelectorAll('th.e-cell-select').length > 0;\n            for (var i = 0; i < allCells[minVal].length; i++) {\n                if (isBelow && minVal < allCells.length - 1 && allCells[minVal][i] === allCells[minVal + 1][i] ||\n                    !isBelow && 0 < minVal && allCells[minVal][i] === allCells[minVal - 1][i]) {\n                    if (0 === i || 0 < i && allCells[minVal][i] !== allCells[minVal][i - 1]) {\n                        allCells[minVal][i].setAttribute('rowspan', (parseInt(allCells[minVal][i].getAttribute('rowspan'), 10) + 1).toString());\n                    }\n                }\n                else {\n                    var tdElement = createElement('td');\n                    tdElement.appendChild(createElement('br'));\n                    newRow.appendChild(tdElement);\n                    tdElement.setAttribute('style', allCells[(isHeaderSelect && isBelow) ? (minVal + 1) : minVal][i].getAttribute('style'));\n                }\n            }\n            // eslint-disable-next-line\n            var selectedRow = void 0;\n            if (isHeaderSelect && isBelow) {\n                selectedRow = this.curTable.querySelector('tbody').childNodes[0];\n            }\n            else {\n                selectedRow = this.curTable.rows[minVal];\n            }\n            // eslint-disable-next-line\n            (e.item.subCommand === 'InsertRowBefore') ? selectedRow.parentElement.insertBefore(newRow, selectedRow) :\n                (isHeaderSelect ? selectedRow.parentElement.insertBefore(newRow, selectedRow) :\n                    this.insertAfter(newRow, selectedRow));\n        }\n        e.item.selection.setSelectionText(this.parent.currentDocument, e.item.selection.range.startContainer, e.item.selection.range.startContainer, 0, 0);\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.insertColumn = function (e) {\n        var selectedCell = e.item.selection.range.startContainer;\n        if (!(selectedCell.nodeName === 'TH' || selectedCell.nodeName === 'TD')) {\n            selectedCell = closest(selectedCell.parentElement, 'td,th');\n        }\n        var curRow = closest(selectedCell, 'tr');\n        var curCell;\n        var allRows = closest((curRow), 'table').rows;\n        var colIndex = Array.prototype.slice.call(curRow.querySelectorAll(':scope > td, :scope > th')).indexOf(selectedCell);\n        var previousWidth = parseInt(e.item.width, 10) / (curRow.querySelectorAll(':scope > td, :scope > th').length);\n        var currentWidth = parseInt(e.item.width, 10) / (curRow.querySelectorAll(':scope > td, :scope > th').length + 1);\n        var currentTabElm = closest(curRow, 'table');\n        var thTdElm = closest(curRow, 'table').querySelectorAll('th,td');\n        for (var i = 0; i < thTdElm.length; i++) {\n            thTdElm[i].dataset.oldWidth = (thTdElm[i].offsetWidth / currentTabElm.offsetWidth * 100) + '%';\n        }\n        for (var i = 0; i < allRows.length; i++) {\n            curCell = allRows[i].querySelectorAll(':scope > td, :scope > th')[colIndex];\n            var colTemplate = curCell.cloneNode(true);\n            colTemplate.innerHTML = '';\n            colTemplate.appendChild(createElement('br'));\n            colTemplate.removeAttribute('class');\n            colTemplate.removeAttribute('colspan');\n            colTemplate.removeAttribute('rowspan');\n            // eslint-disable-next-line\n            (e.item.subCommand === 'InsertColumnLeft') ? curCell.parentElement.insertBefore(colTemplate, curCell) :\n                this.insertAfter(colTemplate, curCell);\n            colTemplate.style.width = currentWidth.toFixed(4) + '%';\n            delete colTemplate.dataset.oldWidth;\n        }\n        for (var i = 0; i < thTdElm.length; i++) {\n            thTdElm[i].style.width = (Number(thTdElm[i].dataset.oldWidth.split('%')[0]) * currentWidth / previousWidth).toFixed(4) + '%';\n            delete thTdElm[i].dataset.oldWidth;\n        }\n        e.item.selection.setSelectionText(this.parent.currentDocument, selectedCell, selectedCell, 0, 0);\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.deleteColumn = function (e) {\n        var selectedCell = e.item.selection.range.startContainer;\n        if (selectedCell.nodeType === 3) {\n            selectedCell = closest(selectedCell.parentElement, 'td,th');\n        }\n        var tBodyHeadEle = closest(selectedCell, selectedCell.tagName === 'TH' ? 'thead' : 'tbody');\n        var rowIndex = tBodyHeadEle && Array.prototype.indexOf.call(tBodyHeadEle.childNodes, selectedCell.parentNode);\n        this.curTable = closest(selectedCell, 'table');\n        var curRow = closest(selectedCell, 'tr');\n        if (curRow.querySelectorAll('th,td').length === 1) {\n            e.item.selection.restore();\n            detach(closest(selectedCell.parentElement, 'table'));\n        }\n        else {\n            var deleteIndex = void 0;\n            var allCells = this.getCorrespondingColumns();\n            //eslint-disable-next-line\n            var selectedMinMaxIndex = this.getSelectedCellMinMaxIndex(allCells);\n            var minCol = selectedMinMaxIndex.startColumn;\n            var maxCol = selectedMinMaxIndex.endColumn;\n            for (var i = 0; i < allCells.length; i++) {\n                var currentRow = allCells[i];\n                for (var j = 0; j < currentRow.length; j++) {\n                    var currentCell = currentRow[j];\n                    //eslint-disable-next-line\n                    var currentCellIndex = this.getCorrespondingIndex(currentCell, allCells);\n                    var colSpanVal = parseInt(currentCell.getAttribute('colspan'), 10) || 1;\n                    if (currentCellIndex[1] + (colSpanVal - 1) >= minCol && currentCellIndex[1] <= maxCol) {\n                        if (colSpanVal > 1) {\n                            currentCell.setAttribute('colspan', (colSpanVal - 1).toString());\n                        }\n                        else {\n                            detach(currentCell);\n                            deleteIndex = j;\n                            if (Browser.isIE) {\n                                e.item.selection.setSelectionText(this.parent.currentDocument, this.curTable.querySelector('td'), this.curTable.querySelector('td'), 0, 0);\n                                this.curTable.querySelector('td, th').classList.add('e-cell-select');\n                            }\n                        }\n                    }\n                }\n            }\n            if (deleteIndex > -1) {\n                var rowHeadEle = tBodyHeadEle.children[rowIndex];\n                var nextFocusCell = rowHeadEle &&\n                    rowHeadEle.children[(deleteIndex <= rowHeadEle.children.length - 1 ? deleteIndex : deleteIndex - 1)];\n                if (nextFocusCell) {\n                    e.item.selection.setSelectionText(this.parent.currentDocument, nextFocusCell, nextFocusCell, 0, 0);\n                    nextFocusCell.classList.add('e-cell-select');\n                }\n            }\n        }\n        if (e.callBack) {\n            var sContainer = this.parent.nodeSelection.getRange(this.parent.currentDocument).startContainer;\n            if (sContainer.nodeName !== 'TD') {\n                var startChildLength = this.parent.nodeSelection.getRange(this.parent.currentDocument).startOffset;\n                var focusNode = sContainer.children[startChildLength];\n                if (focusNode) {\n                    this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, focusNode, 0);\n                }\n            }\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.deleteRow = function (e) {\n        var selectedCell = e.item.selection.range.startContainer;\n        if (selectedCell.nodeType === 3) {\n            selectedCell = closest(selectedCell.parentElement, 'td,th');\n        }\n        var colIndex = Array.prototype.indexOf.call(selectedCell.parentNode.childNodes, selectedCell);\n        this.curTable = closest(selectedCell, 'table');\n        var currentRow;\n        var allCells = this.getCorrespondingColumns();\n        var minMaxIndex = this.getSelectedCellMinMaxIndex(allCells);\n        var maxI;\n        var j;\n        if (this.curTable.rows.length === 1) {\n            e.item.selection.restore();\n            detach(closest(selectedCell.parentElement, 'table'));\n        }\n        else {\n            for (maxI = minMaxIndex.endRow; maxI >= minMaxIndex.startRow; maxI--) {\n                currentRow = this.curTable.rows[maxI];\n                for (j = 0; j < allCells[maxI].length; j++) {\n                    if (j === 0 || allCells[maxI][j] !== allCells[maxI][j - 1]) {\n                        if (1 < parseInt(allCells[maxI][j].getAttribute('rowspan'), 10)) {\n                            var rowSpanVal = parseInt(allCells[maxI][j].getAttribute('rowspan'), 10) - 1;\n                            //eslint-disable-next-line\n                            1 === rowSpanVal ? allCells[maxI][j].removeAttribute('rowspan') : allCells[maxI][j].setAttribute('rowspan', rowSpanVal.toString());\n                        }\n                    }\n                    if (maxI < allCells.length - 1 && allCells[maxI][j] === allCells[maxI + 1][j] && (0 === maxI ||\n                        allCells[maxI][j] !== allCells[maxI - 1][j])) {\n                        var element = allCells[maxI][j];\n                        var index = void 0;\n                        for (index = j; 0 < index && allCells[maxI][index] === allCells[maxI][index - 1]; index--) {\n                            if (index === 0) {\n                                this.curTable.rows[maxI + 1].prepend(element);\n                            }\n                            else {\n                                allCells[maxI + 1][index - 1].insertAdjacentElement('afterend', element);\n                            }\n                        }\n                    }\n                }\n                var deleteIndex = currentRow.rowIndex;\n                this.curTable.deleteRow(deleteIndex);\n                var focusTrEle = !isNOU(this.curTable.rows[deleteIndex]) ? this.curTable.querySelectorAll('tbody tr')[deleteIndex]\n                    : this.curTable.querySelectorAll('tbody tr')[deleteIndex - 1];\n                var nextFocusCell = focusTrEle && focusTrEle.querySelectorAll('td')[colIndex];\n                if (nextFocusCell) {\n                    e.item.selection.setSelectionText(this.parent.currentDocument, nextFocusCell, nextFocusCell, 0, 0);\n                    nextFocusCell.classList.add('e-cell-select');\n                }\n                else {\n                    e.item.selection.setSelectionText(this.parent.currentDocument, this.curTable.querySelector('td'), this.curTable.querySelector('td'), 0, 0);\n                    this.curTable.querySelector('td, th').classList.add('e-cell-select');\n                }\n            }\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.removeTable = function (e) {\n        var selectedCell = e.item.selection.range.startContainer;\n        selectedCell = (selectedCell.nodeType === 3) ? selectedCell.parentNode : selectedCell;\n        var selectedTable = closest(selectedCell.parentElement, 'table');\n        if (selectedTable) {\n            e.item.selection.restore();\n            detach(selectedTable);\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.tableHeader = function (e) {\n        var headerExit = false;\n        var selectedCell = e.item.selection.range.startContainer;\n        selectedCell = (selectedCell.nodeType === 3) ? selectedCell.parentNode : selectedCell;\n        var table = closest(selectedCell.parentElement, 'table');\n        [].slice.call(table.childNodes).forEach(function (el) {\n            if (el.nodeName === 'THEAD') {\n                headerExit = true;\n            }\n        });\n        if (table && !headerExit) {\n            var cellCount = table.querySelector('tr').childElementCount;\n            var colSpanCount = 0;\n            for (var i = 0; i < cellCount; i++) {\n                colSpanCount = colSpanCount + (parseInt(table.querySelector('tr').children[i].getAttribute('colspan'), 10) || 1);\n            }\n            var header = table.createTHead();\n            var row = header.insertRow(0);\n            for (var j = 0; j < colSpanCount; j++) {\n                var th = createElement('th');\n                th.appendChild(createElement('br'));\n                row.appendChild(th);\n            }\n        }\n        else {\n            table.deleteTHead();\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.tableVerticalAlign = function (e) {\n        if (e.item.subCommand === 'AlignTop') {\n            e.item.tableCell.style.verticalAlign = 'top';\n        }\n        else if (e.item.subCommand === 'AlignMiddle') {\n            e.item.tableCell.style.verticalAlign = 'middle';\n        }\n        else {\n            e.item.tableCell.style.verticalAlign = 'bottom';\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.cellMerge = function (e) {\n        if (isNOU(this.curTable)) {\n            this.curTable = closest(this.parent.nodeSelection.range.startContainer.parentElement, 'table');\n        }\n        var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n        if (selectedCells.length < 2) {\n            return;\n        }\n        this.mergeCellContent();\n        var minMaxIndexes = this.getSelectedMinMaxIndexes(this.getCorrespondingColumns());\n        var firstCell = selectedCells[0];\n        var rowSelectedCells = firstCell.parentElement.querySelectorAll('.e-cell-select');\n        if (minMaxIndexes.startColumn < minMaxIndexes.endColumn) {\n            firstCell.setAttribute('colspan', (minMaxIndexes.endColumn - minMaxIndexes.startColumn + 1).toString());\n        }\n        if (minMaxIndexes.startRow < minMaxIndexes.endRow) {\n            firstCell.setAttribute('rowspan', (minMaxIndexes.endRow - minMaxIndexes.startRow + 1).toString());\n        }\n        var totalWidth = 0;\n        for (var j = rowSelectedCells.length - 1; j >= 0; j--) {\n            totalWidth = totalWidth + parseFloat(rowSelectedCells[j].style.width);\n        }\n        firstCell.style.width = totalWidth + '%';\n        for (var i = 1; i <= selectedCells.length - 1; i++) {\n            detach(selectedCells[i]);\n        }\n        for (var i = 0; i < this.curTable.rows.length; i++) {\n            if (this.curTable.rows[i].innerHTML === '') {\n                detach(this.curTable.rows[i]);\n            }\n        }\n        this.updateRowSpanStyle(minMaxIndexes.startRow, minMaxIndexes.endRow, this.getCorrespondingColumns());\n        this.updateColSpanStyle(minMaxIndexes.startColumn, minMaxIndexes.endColumn, this.getCorrespondingColumns());\n        e.item.selection.setSelectionText(this.parent.currentDocument, e.item.selection.range.startContainer, e.item.selection.range.startContainer, 0, 0);\n        if (this.parent.nodeSelection.range) {\n            this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, \n            // eslint-disable-next-line\n            this.parent.nodeSelection.range.endContainer, 0);\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.updateColSpanStyle = function (min, max, elements) {\n        var colValue;\n        var colIndex;\n        var colMin;\n        var index = 0;\n        var attrValue;\n        var count = 0;\n        var eleArray = elements;\n        //eslint-disable-next-line\n        if (min < (max = Math.min(max, eleArray[0].length - 1))) {\n            for (colIndex === min; colIndex <= max; colIndex++) {\n                // eslint-disable-next-line\n                if (!(min < colIndex && eleArray[0][colIndex] === eleArray[0][colIndex - 1]) && 1 < (index =\n                    Math.min(parseInt(eleArray[0][colIndex].getAttribute('colspan'), 10) || 1, max - min + 1)) &&\n                    eleArray[0][colIndex] === eleArray[0][colIndex + 1]) {\n                    for (count = index - 1, colValue = 1; colValue < eleArray.length; colValue++) {\n                        if (eleArray[colValue][colIndex] !== eleArray[colValue - 1][colIndex]) {\n                            /* eslint-disable */\n                            for (colMin = colIndex; colMin < colIndex + index; colMin++) {\n                                if (1 < (attrValue = parseInt(eleArray[colValue][colMin].getAttribute('colspan'), 10) || 1) &&\n                                    eleArray[colValue][colMin] === eleArray[colValue][colMin + 1]) {\n                                    colMin += count = Math.min(count, attrValue - 1);\n                                }\n                                else if (!(count = Math.max(0, count - 1))) {\n                                    break;\n                                }\n                                /* eslint-enable */\n                            }\n                        }\n                        if (!count) {\n                            break;\n                        }\n                    }\n                }\n            }\n            if (count) {\n                this.updateCellAttribute(eleArray, count, 'colspan', 0, eleArray.length - 1, min, max);\n            }\n        }\n    };\n    TableCommand.prototype.updateRowSpanStyle = function (min, max, ele) {\n        var rowValue;\n        var colIndex;\n        var rowMin;\n        var index = 0;\n        var attrValue;\n        var count = 0;\n        var eleArray = ele;\n        // eslint-disable-next-line\n        if (min < (max = Math.min(max, eleArray.length - 1))) {\n            for (rowValue = min; rowValue <= max; rowValue++) {\n                // eslint-disable-next-line\n                if (!(min < rowValue && eleArray[rowValue][0] === eleArray[rowValue - 1][0]) && 1 < (index = Math.min(parseInt(eleArray[rowValue][0].getAttribute('rowspan'), 10) || 1, max - min + 1)) && eleArray[rowValue][0] === eleArray[rowValue + 1][0]) {\n                    for (count = index - 1, colIndex = 1; colIndex < eleArray[0].length; colIndex++) {\n                        if (eleArray[rowValue][colIndex] !== eleArray[rowValue][colIndex - 1]) {\n                            for (rowMin = rowValue; rowMin < rowValue + index; rowMin++) {\n                                // eslint-disable-next-line\n                                if (1 < (attrValue = parseInt(eleArray[rowMin][colIndex].getAttribute('rowspan'), 10) || 1) && eleArray[rowMin][colIndex] === eleArray[rowMin + 1][colIndex]) {\n                                    rowMin += count = Math.min(count, attrValue - 1);\n                                }\n                                // eslint-disable-next-line\n                                else if (!(count = Math.max(0, count - 1))) {\n                                    break;\n                                }\n                            }\n                            if (!count) {\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            if (count) {\n                this.updateCellAttribute(eleArray, count, 'rowspan', min, max, 0, eleArray[0].length - 1);\n            }\n        }\n    };\n    TableCommand.prototype.updateCellAttribute = function (elements, index, attr, min, max, firstIndex, length) {\n        var rowIndex;\n        var colIndex;\n        var spanCount;\n        for (rowIndex = min; rowIndex <= max; rowIndex++) {\n            for (colIndex = firstIndex; colIndex <= length; colIndex++) {\n                // eslint-disable-next-line\n                min < rowIndex && elements[rowIndex][colIndex] === elements[rowIndex - 1][colIndex] ||\n                    firstIndex < colIndex && elements[rowIndex][colIndex] === elements[rowIndex][colIndex - 1] ||\n                    1 < (spanCount = parseInt(elements[rowIndex][colIndex].getAttribute(attr), 10) || 1) &&\n                        (1 < spanCount - index ? elements[rowIndex][colIndex].setAttribute(attr, (spanCount - index).toString()) :\n                            elements[rowIndex][colIndex].removeAttribute(attr));\n            }\n        }\n    };\n    TableCommand.prototype.mergeCellContent = function () {\n        var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n        var innerHtml = selectedCells[0].innerHTML;\n        for (var i = 1; i < selectedCells.length - 1; i++) {\n            if ('<br>' !== selectedCells[i].innerHTML) {\n                innerHtml = innerHtml + selectedCells[i].innerHTML;\n            }\n        }\n        selectedCells[0].innerHTML = innerHtml;\n    };\n    TableCommand.prototype.getSelectedMinMaxIndexes = function (correspondingCells) {\n        var selectedCells = this.curTable.querySelectorAll('.e-cell-select');\n        if (0 < selectedCells.length) {\n            var minRow = correspondingCells.length;\n            var maxRow = 0;\n            var minCol = correspondingCells[0].length;\n            var maxCol = 0;\n            for (var i = 0; i < selectedCells.length; i++) {\n                var currentRowCol = this.getCorrespondingIndex(selectedCells[i], correspondingCells);\n                var targetRowCol = this.FindIndex(currentRowCol[0], currentRowCol[1], correspondingCells);\n                minRow = Math.min(currentRowCol[0], minRow);\n                maxRow = Math.max(targetRowCol[0], maxRow);\n                minCol = Math.min(currentRowCol[1], minCol);\n                maxCol = Math.max(targetRowCol[1], maxCol);\n            }\n            return {\n                startRow: minRow,\n                endRow: maxRow,\n                startColumn: minCol,\n                endColumn: maxCol\n            };\n        }\n        return null;\n    };\n    TableCommand.prototype.HorizontalSplit = function (e) {\n        var selectedCell = e.item.selection.range.startContainer;\n        this.curTable = closest(selectedCell.parentElement, 'table');\n        if (this.curTable.querySelectorAll('.e-cell-select').length > 1) {\n            return;\n        }\n        this.activeCell = this.curTable.querySelector('.e-cell-select');\n        var newCell = this.activeCell.cloneNode(true);\n        newCell.removeAttribute('class');\n        newCell.innerHTML = '</br>';\n        var activeCellIndex = this.getCorrespondingIndex(this.activeCell, this.getCorrespondingColumns());\n        var correspondingCells = this.getCorrespondingColumns();\n        var activeCellRowSpan = this.activeCell.getAttribute('rowspan') ? parseInt(this.activeCell.getAttribute('rowspan'), 10) : 1;\n        if (activeCellRowSpan > 1) {\n            var avgCount = Math.ceil(activeCellRowSpan / 2);\n            // eslint-disable-next-line\n            1 < avgCount ? this.activeCell.setAttribute('rowspan', avgCount.toString()) :\n                this.activeCell.removeAttribute('rowspan');\n            // eslint-disable-next-line\n            1 < (activeCellRowSpan - avgCount) ? newCell.setAttribute('rowspan', (activeCellRowSpan - avgCount).toString()) : newCell.removeAttribute('rowspan');\n            var avgRowIndex = void 0;\n            var colIndex = void 0;\n            for (avgRowIndex = activeCellIndex[0] + Math.ceil(activeCellRowSpan / 2),\n                colIndex = 0 === activeCellIndex[1] ? activeCellIndex[1]\n                    : activeCellIndex[1] - 1; 0 <= colIndex && (correspondingCells[avgRowIndex][colIndex] ===\n                correspondingCells[avgRowIndex][colIndex - 1] || 0 < avgRowIndex && correspondingCells[avgRowIndex][colIndex]\n                === correspondingCells[avgRowIndex - 1][colIndex]);) {\n                colIndex--;\n            }\n            if (colIndex === -1) {\n                // eslint-disable-next-line\n                this.curTable.rows[avgRowIndex].firstChild ? this.curTable.rows[avgRowIndex].prepend(newCell) : this.curTable.appendChild(newCell);\n            }\n            else {\n                correspondingCells[avgRowIndex][colIndex].insertAdjacentElement('afterend', newCell);\n            }\n        }\n        else {\n            var newTrEle = createElement('tr');\n            newTrEle.appendChild(newCell);\n            var selectedRow = correspondingCells[activeCellIndex[0]];\n            for (var j = 0; j <= selectedRow.length - 1; j++) {\n                if (selectedRow[j] !== selectedRow[j - 1] && selectedRow[j] !== this.activeCell) {\n                    selectedRow[j].setAttribute('rowspan', ((parseInt(selectedRow[j].getAttribute('rowspan'), 10) ?\n                        parseInt(selectedRow[j].getAttribute('rowspan'), 10) : 1) + 1).toString());\n                }\n            }\n            this.activeCell.parentNode.insertAdjacentElement('afterend', newTrEle);\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.VerticalSplit = function (e) {\n        var selectedCell = e.item.selection.range.startContainer;\n        this.curTable = closest(selectedCell.parentElement, 'table');\n        if (this.curTable.querySelectorAll('.e-cell-select').length > 1) {\n            return;\n        }\n        this.activeCell = this.curTable.querySelector('.e-cell-select');\n        var allRows = this.curTable.rows;\n        var newCell = this.activeCell.cloneNode(true);\n        newCell.removeAttribute('class');\n        newCell.innerHTML = '</br>';\n        var avgWidth = parseFloat(this.activeCell.style.width) / 2;\n        if (this.activeCell.tagName === 'TH' && isNaN(avgWidth)) {\n            var cellCount = this.curTable.querySelector('tr').childElementCount;\n            var colSpanCount = 0;\n            for (var i = 0; i < cellCount; i++) {\n                colSpanCount = colSpanCount + (parseInt(this.curTable.querySelector('tr').children[i].getAttribute('colspan'), 10) || 1);\n            }\n            avgWidth = parseFloat((((this.activeCell.offsetWidth / 2) / this.curTable.offsetWidth) * 100).toFixed(1));\n        }\n        var activeCellIndex = this.getCorrespondingIndex(this.activeCell, this.getCorrespondingColumns());\n        var correspondingColumns = this.getCorrespondingColumns();\n        var activeCellcolSpan = parseInt(this.activeCell.getAttribute('colspan'), 10);\n        if (activeCellcolSpan > 1) {\n            // eslint-disable-next-line\n            1 < Math.ceil(activeCellcolSpan / 2) ? this.activeCell.setAttribute('colspan', (activeCellcolSpan / 2).toString())\n                : this.activeCell.removeAttribute('colspan');\n            // eslint-disable-next-line\n            1 < (activeCellcolSpan - activeCellcolSpan / 2) ? newCell.setAttribute('colspan', \n            // eslint-disable-next-line\n            (activeCellcolSpan - activeCellcolSpan / 2).toString()) : newCell.removeAttribute('colspan');\n        }\n        else {\n            for (var i = 0; i <= allRows.length - 1; i++) {\n                if (0 === i || correspondingColumns[i][activeCellIndex[1]] !== correspondingColumns[i - 1][activeCellIndex[1]]) {\n                    var currentCell = correspondingColumns[i][activeCellIndex[1]];\n                    if (currentCell !== this.activeCell) {\n                        currentCell.setAttribute('colspan', ((parseInt(currentCell.getAttribute('colspan'), 10) ?\n                            parseInt(currentCell.getAttribute('colspan'), 10) : 1) + 1).toString());\n                    }\n                }\n            }\n        }\n        this.activeCell.style.width = avgWidth + '%';\n        newCell.style.width = avgWidth + '%';\n        this.activeCell.parentNode.insertBefore(newCell, this.activeCell.nextSibling);\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    TableCommand.prototype.getCorrespondingColumns = function () {\n        var elementArray = [];\n        // eslint-disable-next-line\n        var _this = this;\n        var colspan = 0;\n        var allRows = _this.curTable.rows;\n        for (var i = 0; i <= allRows.length - 1; i++) {\n            var ele = allRows[i];\n            var index = 0;\n            for (var j = 0; j <= ele.children.length - 1; j++) {\n                /* eslint-disable */\n                var colEle = ele.children[j];\n                for (var ele_1 = colEle, colspan_1 = parseInt(ele_1.getAttribute('colspan'), 10) || 1, rowSpan = parseInt(ele_1.getAttribute('rowspan'), 10) || 1, rowIndex = i; rowIndex < i + rowSpan; rowIndex++) {\n                    for (var colIndex = index; colIndex < index + colspan_1; colIndex++) {\n                        elementArray[rowIndex] || (elementArray[rowIndex] = []);\n                        elementArray[rowIndex][colIndex] ? index++ : elementArray[rowIndex][colIndex] = colEle;\n                    }\n                }\n                index += colspan;\n            }\n            /* eslint-enable */\n        }\n        return elementArray;\n    };\n    // eslint-disable-next-line\n    TableCommand.prototype.FindIndex = function (rowIndex, columnIndex, cells) {\n        var nextIndex;\n        var nextCol;\n        for (nextIndex = rowIndex + 1, nextCol = columnIndex + 1; nextIndex < cells.length;) {\n            if (cells[nextIndex][columnIndex] !== cells[rowIndex][columnIndex]) {\n                nextIndex--;\n                break;\n            }\n            nextIndex++;\n        }\n        for (nextIndex === cells.length && nextIndex--; nextCol < cells[rowIndex].length;) {\n            if (cells[rowIndex][nextCol] !== cells[rowIndex][columnIndex]) {\n                nextCol--;\n                break;\n            }\n            nextCol++;\n        }\n        return nextCol === cells[rowIndex].length && nextCol--,\n            [\n                nextIndex,\n                nextCol\n            ];\n    };\n    TableCommand.prototype.getCorrespondingIndex = function (cell, allCells) {\n        //let value: RowCol = new RowCol();\n        for (var i = 0; i < allCells.length; i++) {\n            for (var j = 0; j < allCells[i].length; j++) {\n                if (allCells[i][j] === cell) {\n                    return [i, j];\n                }\n            }\n        }\n        return [];\n    };\n    TableCommand.prototype.highlightCells = function (minRow, maxRow, minCol, maxCol, eleArray) {\n        var j;\n        var k;\n        var startCell;\n        var endCell;\n        var minRowIndex = minRow;\n        var maxRowIndex = maxRow;\n        var minColIndex = minCol;\n        var maxColIndex = maxCol;\n        var minMaxValues = new MinMax();\n        for (j = minRowIndex; j <= maxRowIndex; j++) {\n            /* eslint-disable */\n            if ((1 < (parseInt(eleArray[j][minColIndex].getAttribute('rowspan'), 10) || 1) ||\n                1 < (parseInt(eleArray[j][minColIndex].getAttribute('colspan'), 10) || 1)) &&\n                (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[j][minColIndex], eleArray))[0], startCell[1], eleArray))) {\n                minRowIndex = Math.min(startCell[0], minRowIndex);\n                maxRowIndex = Math.max(endCell[0], maxRowIndex);\n                minColIndex = Math.min(startCell[1], minColIndex);\n                maxColIndex = Math.max(endCell[1], maxColIndex);\n            }\n            else if ((1 < (parseInt(eleArray[j][maxColIndex].getAttribute('rowspan'), 10) || 1) ||\n                1 < (parseInt(eleArray[j][maxColIndex].getAttribute('colspan'), 10) || 1)) &&\n                (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[j][maxColIndex], eleArray))[0], startCell[1], eleArray))) {\n                minRowIndex = Math.min(startCell[0], minRowIndex);\n                maxRowIndex = Math.max(endCell[0], maxRowIndex);\n                minColIndex = Math.min(startCell[1], minColIndex);\n                maxColIndex = Math.max(endCell[1], maxColIndex);\n            }\n            for (k = minColIndex; k <= maxColIndex; k++) {\n                if ((1 < (parseInt(eleArray[minRowIndex][k].getAttribute('rowspan'), 10) || 1) ||\n                    1 < (parseInt(eleArray[minRowIndex][k].getAttribute('colspan'), 10) || 1)) &&\n                    (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[minRowIndex][k], eleArray))[0], startCell[1], eleArray))) {\n                    minRowIndex = Math.min(startCell[0], minRowIndex);\n                    maxRowIndex = Math.max(endCell[0], maxRowIndex);\n                    minColIndex = Math.min(startCell[1], minColIndex);\n                    maxColIndex = Math.max(endCell[1], maxColIndex);\n                }\n                else if ((1 < (parseInt(eleArray[maxRowIndex][k].getAttribute('rowspan'), 10) || 1) ||\n                    1 < (parseInt(eleArray[maxRowIndex][k].getAttribute('colspan'), 10) || 1)) &&\n                    (endCell = this.FindIndex((startCell = this.getCorrespondingIndex(eleArray[maxRowIndex][k], eleArray))[0], startCell[1], eleArray))) {\n                    minRowIndex = Math.min(startCell[0], minRowIndex);\n                    maxRowIndex = Math.max(endCell[0], maxRowIndex);\n                    minColIndex = Math.min(startCell[1], minColIndex);\n                    maxColIndex = Math.max(endCell[1], maxColIndex);\n                }\n            }\n            minMaxValues = minRowIndex === minRow && maxRowIndex === maxRow && minColIndex === minCol && maxColIndex === maxCol ? {\n                startRow: minRow,\n                endRow: maxRow,\n                startColumn: minCol,\n                endColumn: maxCol\n            } : this.highlightCells(minRowIndex, maxRowIndex, minColIndex, maxColIndex, eleArray);\n        }\n        return minMaxValues;\n        /* eslint-enable */\n    };\n    TableCommand.prototype.tableMove = function (e) {\n        this.activeCell = e.selectNode[0];\n        var target = e.event.target;\n        var activeCellTag = this.activeCell.tagName;\n        var targetCellTag = target.tagName;\n        this.curTable = closest(target, 'table');\n        if (this.curTable.querySelectorAll('.e-cell-select').length > 1) {\n            this.parent.nodeSelection.Clear(this.parent.currentDocument);\n        }\n        if ((target.tagName !== 'TD' && target.tagName !== 'TH') && activeCellTag !== targetCellTag) {\n            return;\n        }\n        var activeRowIndex = Array.prototype.slice.call((this.activeCell).parentElement.parentElement.children)\n            .indexOf((this.activeCell).parentElement);\n        var activeColumnIndex = Array.prototype.slice.call((this.activeCell).parentElement.children).indexOf(this.activeCell);\n        var targetRowIndex = Array.prototype.slice.call(target.parentElement.parentElement.children)\n            .indexOf(target.parentElement);\n        var targetColumnIndex = Array.prototype.slice.call(target.parentElement.children).indexOf(target);\n        var activeCellList = this.curTable.querySelectorAll('.e-cell-select');\n        for (var i = activeCellList.length - 1; i >= 0; i--) {\n            if (this.activeCell !== activeCellList[i]) {\n                activeCellList[i].classList.remove('e-cell-select');\n            }\n        }\n        if (activeRowIndex === targetRowIndex && activeColumnIndex === targetColumnIndex) {\n            return;\n        }\n        var correspondingCells = this.getCorrespondingColumns();\n        var activeIndexes = this.getCorrespondingIndex(this.activeCell, correspondingCells);\n        var targetIndexes = this.getCorrespondingIndex(target, correspondingCells);\n        var minMaxIndexes = this.highlightCells(Math.min(activeIndexes[0], targetIndexes[0]), Math.max(activeIndexes[0], \n        /* eslint-disable */\n        targetIndexes[0]), Math.min(activeIndexes[1], targetIndexes[1]), Math.max(activeIndexes[1], targetIndexes[1]), correspondingCells);\n        for (var rowIndex = minMaxIndexes.startRow; rowIndex <= minMaxIndexes.endRow; rowIndex++) {\n            for (var colIndex = minMaxIndexes.startColumn; colIndex <= minMaxIndexes.endColumn; colIndex++) {\n                correspondingCells[rowIndex][colIndex].classList.add('e-cell-select');\n            }\n        }\n        if (this.parent.nodeSelection.range) {\n            this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, this.parent.nodeSelection.range.endContainer, this.parent.nodeSelection.range.endContainer, 0, 0);\n            this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, this.parent.nodeSelection.range.endContainer, 0);\n        }\n    };\n    ;\n    return TableCommand;\n}());\nexport { TableCommand };\nvar MinMax = /** @class */ (function () {\n    function MinMax() {\n    }\n    return MinMax;\n}());\n"]},"metadata":{},"sourceType":"module"}