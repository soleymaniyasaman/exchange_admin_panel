{"ast":null,"code":"import * as CONSTANT from './../base/constant';\nimport { NodeSelection } from '../../selection/selection';\nimport { NodeCutter } from './nodecutter';\nimport { InsertHtml } from './inserthtml';\nimport { createElement, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Link internal component\n *\n * @hidden\n\n */\n\nvar LinkCommand =\n/** @class */\nfunction () {\n  /**\n   * Constructor for creating the Formats plugin\n   *\n   * @param {EditorManager} parent - specifies the editor manager\n   * @hidden\n    */\n  function LinkCommand(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n\n  LinkCommand.prototype.addEventListener = function () {\n    this.parent.observer.on(CONSTANT.LINK, this.linkCommand, this);\n  };\n\n  LinkCommand.prototype.linkCommand = function (e) {\n    switch (e.value.toString().toLocaleLowerCase()) {\n      case 'createlink':\n      case 'editlink':\n        this.createLink(e);\n        break;\n\n      case 'openlink':\n        this.openLink(e);\n        break;\n\n      case 'removelink':\n        this.removeLink(e);\n        break;\n    }\n  };\n\n  LinkCommand.prototype.createLink = function (e) {\n    var closestAnchor = !isNOU(e.item.selectParent) && e.item.selectParent.length > 0 && closest(e.item.selectParent[0], 'a');\n    closestAnchor = !isNOU(closestAnchor) ? closestAnchor : !isNOU(e.item.selectParent) && e.item.selectParent.length > 0 ? e.item.selectParent[0] : null;\n\n    if (!isNOU(closestAnchor) && closestAnchor.tagName === 'A') {\n      var anchorEle = closestAnchor;\n      var linkText = '';\n\n      if (!isNOU(e.item.url)) {\n        anchorEle.setAttribute('href', e.item.url);\n      }\n\n      if (!isNOU(e.item.title)) {\n        anchorEle.setAttribute('title', e.item.title);\n      }\n\n      if (!isNOU(e.item.text) && e.item.text !== '') {\n        linkText = anchorEle.innerText;\n        anchorEle.innerText = e.item.text;\n      }\n\n      if (!isNOU(e.item.target)) {\n        anchorEle.setAttribute('target', e.item.target);\n      } else {\n        anchorEle.removeAttribute('target');\n      }\n\n      if (linkText === e.item.text) {\n        e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle, anchorEle, 1, 1);\n        e.item.selection.restore();\n      } else {\n        var startIndex = e.item.action === 'Paste' ? anchorEle.childNodes[0].textContent.length : 0;\n        e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle.childNodes[0], anchorEle.childNodes[0], startIndex, anchorEle.childNodes[0].textContent.length);\n      }\n    } else {\n      var domSelection = new NodeSelection();\n      var range = domSelection.getRange(this.parent.currentDocument);\n      var text = isNOU(e.item.text) ? true : e.item.text.replace(/ /g, '').localeCompare(range.toString().replace(/\\n/g, ' ').replace(/ /g, '')) < 0;\n\n      if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32 || e.event.keyCode === 13) || e.item.action === 'Paste' || range.collapsed || text) {\n        var anchor = this.createAchorNode(e);\n        anchor.innerText = e.item.text === '' ? e.item.url : e.item.text;\n        e.item.selection.restore();\n        InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n\n        if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32 || e.event.keyCode === 13)) {\n          var startContainer = e.item.selection.range.startContainer;\n          startContainer.textContent = this.removeText(startContainer.textContent, e.item.text);\n        } else {\n          var startIndex = e.item.action === 'Paste' ? anchor.childNodes[0].textContent.length : 0;\n          e.item.selection.setSelectionText(this.parent.currentDocument, anchor.childNodes[0], anchor.childNodes[0], startIndex, anchor.childNodes[0].textContent.length);\n        }\n      } else {\n        this.createLinkNode(e);\n      }\n    }\n\n    if (e.callBack) {\n      e.callBack({\n        requestType: 'Links',\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  LinkCommand.prototype.createLinkNode = function (e) {\n    var domSelection = new NodeSelection();\n    var nodeCutter = new NodeCutter();\n    var range = domSelection.getRange(this.parent.currentDocument);\n    var nodes = this.getSelectionNodes(domSelection.getNodeCollection(range));\n    var save = domSelection.save(range, this.parent.currentDocument);\n    var txtArray = [];\n    var inlineNodes = [];\n    var currentNode;\n    var removeNodes = [];\n    var anchorNodes = [];\n    var finalinlineNodes = [];\n    var cloneNode;\n\n    for (var index = 0; index < nodes.length; index++) {\n      nodes[index] = nodeCutter.GetSpliceNode(range, nodes[index]);\n      txtArray[index] = nodes[index];\n    }\n\n    for (var i = 0; i < txtArray.length; i++) {\n      var check = true;\n      currentNode = txtArray[i];\n\n      while (check === true) {\n        if (currentNode.parentNode.nodeName === 'A') {\n          var anchorEle = currentNode.parentNode;\n          currentNode.parentNode.parentNode.insertBefore(anchorEle.firstChild, anchorEle);\n          currentNode.parentNode.removeChild(anchorEle);\n        }\n\n        if (this.isBlockNode(currentNode.parentNode) || txtArray.length === 0 || i === 0 || i === txtArray.length - 1 || range.startContainer.nodeType === 3) {\n          inlineNodes[i] = currentNode;\n          check = false;\n        } else {\n          currentNode = currentNode.parentNode;\n        }\n      }\n    }\n\n    for (var i = 0, j_1 = 0; i < inlineNodes.length; i++) {\n      if (i === 0) {\n        finalinlineNodes[j_1] = inlineNodes[i];\n      }\n\n      if (inlineNodes.length > 1 && i < inlineNodes.length - 1) {\n        if (inlineNodes[i].parentElement === inlineNodes[i + 1].parentElement && inlineNodes[i] === inlineNodes[i + 1]) {\n          continue;\n        } else {\n          finalinlineNodes[j_1 + 1] = inlineNodes[i + 1];\n          j_1++;\n        }\n      }\n    }\n\n    var j = 0;\n    anchorNodes[j] = this.createAchorNode(e);\n\n    for (var i = 0; i < finalinlineNodes.length; i++) {\n      if (i === 0) {\n        cloneNode = finalinlineNodes[i].cloneNode(true);\n        anchorNodes[i].appendChild(cloneNode);\n      }\n\n      if (i < finalinlineNodes.length - 1) {\n        if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n          var cln = finalinlineNodes[i + 1].cloneNode(true);\n          anchorNodes[j].appendChild(cln);\n        } else {\n          j = j + 1;\n          anchorNodes[j] = this.createAchorNode(e);\n          cloneNode = finalinlineNodes[i + 1].cloneNode(true);\n          anchorNodes[j].appendChild(cloneNode);\n        }\n      }\n    }\n\n    this.parent.nodeSelection.setRange(document, save.range);\n\n    for (var i = 0, j_2 = 0, k = 0; i <= finalinlineNodes.length; i++) {\n      if (i === 0) {\n        finalinlineNodes[i].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i].nextSibling);\n\n        if (this.parent.domNode.blockNodes().length === 1) {\n          this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument, anchorNodes[j_2]);\n        }\n\n        removeNodes[k] = finalinlineNodes[i];\n        k++;\n      }\n\n      if (i < finalinlineNodes.length - 1) {\n        if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n          removeNodes[k] = finalinlineNodes[i + 1];\n          k++;\n        } else {\n          j_2 = j_2 + 1;\n          finalinlineNodes[i + 1].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i + 1]);\n          removeNodes[k] = finalinlineNodes[i + 1];\n          k++;\n        }\n      }\n    }\n\n    for (var i = 0; i < removeNodes.length; i++) {\n      if (removeNodes[i].parentNode) {\n        removeNodes[i].parentNode.removeChild(removeNodes[i]);\n      }\n    }\n  };\n\n  LinkCommand.prototype.createAchorNode = function (e) {\n    var anchorEle = createElement('a', {\n      className: 'e-rte-anchor',\n      attrs: {\n        href: e.item.url,\n        title: isNOU(e.item.title) || e.item.title === '' ? e.item.url : e.item.title\n      }\n    });\n\n    if (!isNOU(e.item.target)) {\n      anchorEle.setAttribute('target', e.item.target);\n    }\n\n    return anchorEle;\n  };\n\n  LinkCommand.prototype.getSelectionNodes = function (nodeCollection) {\n    nodeCollection = nodeCollection.reverse();\n\n    for (var index = 0; index < nodeCollection.length; index++) {\n      if (nodeCollection[index].nodeType !== 3 || nodeCollection[index].textContent.trim() === '') {\n        if (nodeCollection[index].nodeName !== 'IMG') {\n          nodeCollection.splice(index, 1);\n          index--;\n        }\n      }\n    }\n\n    return nodeCollection.reverse();\n  };\n\n  LinkCommand.prototype.isBlockNode = function (element) {\n    return !!element && element.nodeType === Node.ELEMENT_NODE && CONSTANT.BLOCK_TAGS.indexOf(element.tagName.toLowerCase()) >= 0;\n  };\n\n  LinkCommand.prototype.removeText = function (text, val) {\n    var arr = text.split(' ');\n\n    for (var i = 0; i < arr.length; i++) {\n      if (arr[i] === val) {\n        arr.splice(i, 1);\n        i--;\n      }\n    }\n\n    return arr.join(' ') + ' ';\n  };\n\n  LinkCommand.prototype.openLink = function (e) {\n    document.defaultView.open(e.item.url, e.item.target);\n    this.callBack(e);\n  };\n\n  LinkCommand.prototype.removeLink = function (e) {\n    var blockNodes = this.parent.domNode.blockNodes();\n\n    if (blockNodes.length < 2) {\n      this.parent.domNode.setMarker(e.item.selection);\n      var closestAnchor = closest(e.item.selectParent[0], 'a');\n      var selectParent = closestAnchor ? closestAnchor : e.item.selectParent[0];\n      var parent_1 = selectParent.parentNode;\n      var child = [];\n\n      for (; selectParent.firstChild; null) {\n        child.push(parent_1.insertBefore(selectParent.firstChild, selectParent));\n      }\n\n      parent_1.removeChild(selectParent);\n\n      if (child && child.length === 1) {\n        e.item.selection.startContainer = e.item.selection.getNodeArray(child[child.length - 1], true);\n        e.item.selection.endContainer = e.item.selection.startContainer;\n      }\n\n      e.item.selection = this.parent.domNode.saveMarker(e.item.selection);\n    } else {\n      for (var i = 0; i < blockNodes.length; i++) {\n        var linkNode = blockNodes[i].querySelectorAll('a');\n\n        for (var j = 0; j < linkNode.length; j++) {\n          if (document.getSelection().containsNode(linkNode[j], true)) {\n            linkNode[j].outerHTML = linkNode[j].innerHTML;\n          }\n        }\n      }\n    }\n\n    e.item.selection.restore();\n    this.callBack(e);\n  };\n\n  LinkCommand.prototype.callBack = function (e) {\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  return LinkCommand;\n}();\n\nexport { LinkCommand };","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/link.js"],"names":["CONSTANT","NodeSelection","NodeCutter","InsertHtml","createElement","isNullOrUndefined","isNOU","closest","LinkCommand","parent","addEventListener","prototype","observer","on","LINK","linkCommand","e","value","toString","toLocaleLowerCase","createLink","openLink","removeLink","closestAnchor","item","selectParent","length","tagName","anchorEle","linkText","url","setAttribute","title","text","innerText","target","removeAttribute","selection","setSelectionText","currentDocument","restore","startIndex","action","childNodes","textContent","domSelection","range","getRange","replace","localeCompare","event","type","keyCode","collapsed","anchor","createAchorNode","Insert","editableElement","startContainer","removeText","createLinkNode","callBack","requestType","editorMode","nodeSelection","elements","getSelectedNodes","nodeCutter","nodes","getSelectionNodes","getNodeCollection","save","txtArray","inlineNodes","currentNode","removeNodes","anchorNodes","finalinlineNodes","cloneNode","index","GetSpliceNode","i","check","parentNode","nodeName","insertBefore","firstChild","removeChild","isBlockNode","nodeType","j_1","parentElement","j","appendChild","cln","setRange","document","j_2","k","nextSibling","domNode","blockNodes","setSelectionNode","className","attrs","href","nodeCollection","reverse","trim","splice","element","Node","ELEMENT_NODE","BLOCK_TAGS","indexOf","toLowerCase","val","arr","split","join","defaultView","open","setMarker","parent_1","child","push","getNodeArray","endContainer","saveMarker","linkNode","querySelectorAll","getSelection","containsNode","outerHTML","innerHTML","subCommand"],"mappings":"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","sourcesContent":["import * as CONSTANT from './../base/constant';\nimport { NodeSelection } from '../../selection/selection';\nimport { NodeCutter } from './nodecutter';\nimport { InsertHtml } from './inserthtml';\nimport { createElement, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Link internal component\n *\n * @hidden\n\n */\nvar LinkCommand = /** @class */ (function () {\n    /**\n     * Constructor for creating the Formats plugin\n     *\n     * @param {EditorManager} parent - specifies the editor manager\n     * @hidden\n\n     */\n    function LinkCommand(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    LinkCommand.prototype.addEventListener = function () {\n        this.parent.observer.on(CONSTANT.LINK, this.linkCommand, this);\n    };\n    LinkCommand.prototype.linkCommand = function (e) {\n        switch (e.value.toString().toLocaleLowerCase()) {\n            case 'createlink':\n            case 'editlink':\n                this.createLink(e);\n                break;\n            case 'openlink':\n                this.openLink(e);\n                break;\n            case 'removelink':\n                this.removeLink(e);\n                break;\n        }\n    };\n    LinkCommand.prototype.createLink = function (e) {\n        var closestAnchor = (!isNOU(e.item.selectParent) && e.item.selectParent.length > 0) &&\n            closest(e.item.selectParent[0], 'a');\n        closestAnchor = !isNOU(closestAnchor) ? closestAnchor :\n            (!isNOU(e.item.selectParent) && e.item.selectParent.length > 0) ? (e.item.selectParent[0]) : null;\n        if (!isNOU(closestAnchor) && closestAnchor.tagName === 'A') {\n            var anchorEle = closestAnchor;\n            var linkText = '';\n            if (!isNOU(e.item.url)) {\n                anchorEle.setAttribute('href', e.item.url);\n            }\n            if (!isNOU(e.item.title)) {\n                anchorEle.setAttribute('title', e.item.title);\n            }\n            if (!isNOU(e.item.text) && e.item.text !== '') {\n                linkText = anchorEle.innerText;\n                anchorEle.innerText = e.item.text;\n            }\n            if (!isNOU(e.item.target)) {\n                anchorEle.setAttribute('target', e.item.target);\n            }\n            else {\n                anchorEle.removeAttribute('target');\n            }\n            if (linkText === e.item.text) {\n                e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle, anchorEle, 1, 1);\n                e.item.selection.restore();\n            }\n            else {\n                var startIndex = e.item.action === 'Paste' ? anchorEle.childNodes[0].textContent.length : 0;\n                e.item.selection.setSelectionText(this.parent.currentDocument, anchorEle.childNodes[0], anchorEle.childNodes[0], startIndex, anchorEle.childNodes[0].textContent.length);\n            }\n        }\n        else {\n            var domSelection = new NodeSelection();\n            var range = domSelection.getRange(this.parent.currentDocument);\n            var text = isNOU(e.item.text) ? true : e.item.text.replace(/ /g, '').localeCompare(range.toString()\n                .replace(/\\n/g, ' ').replace(/ /g, '')) < 0;\n            if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32\n                || e.event.keyCode === 13) || e.item.action === 'Paste' || range.collapsed || text) {\n                var anchor = this.createAchorNode(e);\n                anchor.innerText = e.item.text === '' ? e.item.url : e.item.text;\n                e.item.selection.restore();\n                InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n                if (e.event && e.event.type === 'keydown' && (e.event.keyCode === 32\n                    || e.event.keyCode === 13)) {\n                    var startContainer = e.item.selection.range.startContainer;\n                    startContainer.textContent = this.removeText(startContainer.textContent, e.item.text);\n                }\n                else {\n                    var startIndex = e.item.action === 'Paste' ? anchor.childNodes[0].textContent.length : 0;\n                    e.item.selection.setSelectionText(this.parent.currentDocument, anchor.childNodes[0], anchor.childNodes[0], startIndex, anchor.childNodes[0].textContent.length);\n                }\n            }\n            else {\n                this.createLinkNode(e);\n            }\n        }\n        if (e.callBack) {\n            e.callBack({\n                requestType: 'Links',\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    LinkCommand.prototype.createLinkNode = function (e) {\n        var domSelection = new NodeSelection();\n        var nodeCutter = new NodeCutter();\n        var range = domSelection.getRange(this.parent.currentDocument);\n        var nodes = this.getSelectionNodes(domSelection.getNodeCollection(range));\n        var save = domSelection.save(range, this.parent.currentDocument);\n        var txtArray = [];\n        var inlineNodes = [];\n        var currentNode;\n        var removeNodes = [];\n        var anchorNodes = [];\n        var finalinlineNodes = [];\n        var cloneNode;\n        for (var index = 0; index < nodes.length; index++) {\n            nodes[index] = nodeCutter.GetSpliceNode(range, nodes[index]);\n            txtArray[index] = nodes[index];\n        }\n        for (var i = 0; i < txtArray.length; i++) {\n            var check = true;\n            currentNode = txtArray[i];\n            while (check === true) {\n                if (currentNode.parentNode.nodeName === 'A') {\n                    var anchorEle = currentNode.parentNode;\n                    currentNode.parentNode.parentNode.insertBefore(anchorEle.firstChild, anchorEle);\n                    currentNode.parentNode.removeChild(anchorEle);\n                }\n                if (this.isBlockNode(currentNode.parentNode) || txtArray.length === 0 || i === 0 || i === txtArray.length - 1\n                    || range.startContainer.nodeType === 3) {\n                    inlineNodes[i] = currentNode;\n                    check = false;\n                }\n                else {\n                    currentNode = currentNode.parentNode;\n                }\n            }\n        }\n        for (var i = 0, j_1 = 0; i < inlineNodes.length; i++) {\n            if (i === 0) {\n                finalinlineNodes[j_1] = inlineNodes[i];\n            }\n            if (inlineNodes.length > 1 && i < inlineNodes.length - 1) {\n                if ((inlineNodes[i].parentElement === inlineNodes[i + 1].parentElement) && (inlineNodes[i] === inlineNodes[i + 1])) {\n                    continue;\n                }\n                else {\n                    finalinlineNodes[j_1 + 1] = inlineNodes[i + 1];\n                    j_1++;\n                }\n            }\n        }\n        var j = 0;\n        anchorNodes[j] = this.createAchorNode(e);\n        for (var i = 0; i < finalinlineNodes.length; i++) {\n            if (i === 0) {\n                cloneNode = finalinlineNodes[i].cloneNode(true);\n                anchorNodes[i].appendChild(cloneNode);\n            }\n            if (i < finalinlineNodes.length - 1) {\n                if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n                    var cln = finalinlineNodes[i + 1].cloneNode(true);\n                    anchorNodes[j].appendChild(cln);\n                }\n                else {\n                    j = j + 1;\n                    anchorNodes[j] = this.createAchorNode(e);\n                    cloneNode = finalinlineNodes[i + 1].cloneNode(true);\n                    anchorNodes[j].appendChild(cloneNode);\n                }\n            }\n        }\n        this.parent.nodeSelection.setRange(document, save.range);\n        for (var i = 0, j_2 = 0, k = 0; i <= finalinlineNodes.length; i++) {\n            if (i === 0) {\n                finalinlineNodes[i].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i].nextSibling);\n                if (this.parent.domNode.blockNodes().length === 1) {\n                    this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument, anchorNodes[j_2]);\n                }\n                removeNodes[k] = finalinlineNodes[i];\n                k++;\n            }\n            if (i < finalinlineNodes.length - 1) {\n                if (finalinlineNodes[i].parentNode === finalinlineNodes[i + 1].parentNode) {\n                    removeNodes[k] = finalinlineNodes[i + 1];\n                    k++;\n                }\n                else {\n                    j_2 = j_2 + 1;\n                    finalinlineNodes[i + 1].parentNode.insertBefore(anchorNodes[j_2], finalinlineNodes[i + 1]);\n                    removeNodes[k] = finalinlineNodes[i + 1];\n                    k++;\n                }\n            }\n        }\n        for (var i = 0; i < removeNodes.length; i++) {\n            if (removeNodes[i].parentNode) {\n                removeNodes[i].parentNode.removeChild(removeNodes[i]);\n            }\n        }\n    };\n    LinkCommand.prototype.createAchorNode = function (e) {\n        var anchorEle = createElement('a', {\n            className: 'e-rte-anchor',\n            attrs: {\n                href: e.item.url,\n                title: isNOU(e.item.title) || e.item.title === '' ? e.item.url : e.item.title\n            }\n        });\n        if (!isNOU(e.item.target)) {\n            anchorEle.setAttribute('target', e.item.target);\n        }\n        return anchorEle;\n    };\n    LinkCommand.prototype.getSelectionNodes = function (nodeCollection) {\n        nodeCollection = nodeCollection.reverse();\n        for (var index = 0; index < nodeCollection.length; index++) {\n            if (nodeCollection[index].nodeType !== 3 || nodeCollection[index].textContent.trim() === '') {\n                if (nodeCollection[index].nodeName !== 'IMG') {\n                    nodeCollection.splice(index, 1);\n                    index--;\n                }\n            }\n        }\n        return nodeCollection.reverse();\n    };\n    LinkCommand.prototype.isBlockNode = function (element) {\n        return (!!element && (element.nodeType === Node.ELEMENT_NODE && CONSTANT.BLOCK_TAGS.indexOf(element.tagName.toLowerCase()) >= 0));\n    };\n    LinkCommand.prototype.removeText = function (text, val) {\n        var arr = text.split(' ');\n        for (var i = 0; i < arr.length; i++) {\n            if (arr[i] === val) {\n                arr.splice(i, 1);\n                i--;\n            }\n        }\n        return arr.join(' ') + ' ';\n    };\n    LinkCommand.prototype.openLink = function (e) {\n        document.defaultView.open(e.item.url, e.item.target);\n        this.callBack(e);\n    };\n    LinkCommand.prototype.removeLink = function (e) {\n        var blockNodes = this.parent.domNode.blockNodes();\n        if (blockNodes.length < 2) {\n            this.parent.domNode.setMarker(e.item.selection);\n            var closestAnchor = closest(e.item.selectParent[0], 'a');\n            var selectParent = closestAnchor ? closestAnchor : e.item.selectParent[0];\n            var parent_1 = selectParent.parentNode;\n            var child = [];\n            for (; selectParent.firstChild; null) {\n                child.push(parent_1.insertBefore(selectParent.firstChild, selectParent));\n            }\n            parent_1.removeChild(selectParent);\n            if (child && child.length === 1) {\n                e.item.selection.startContainer = e.item.selection.getNodeArray(child[child.length - 1], true);\n                e.item.selection.endContainer = e.item.selection.startContainer;\n            }\n            e.item.selection = this.parent.domNode.saveMarker(e.item.selection);\n        }\n        else {\n            for (var i = 0; i < blockNodes.length; i++) {\n                var linkNode = blockNodes[i].querySelectorAll('a');\n                for (var j = 0; j < linkNode.length; j++) {\n                    if (document.getSelection().containsNode(linkNode[j], true)) {\n                        linkNode[j].outerHTML = linkNode[j].innerHTML;\n                    }\n                }\n            }\n        }\n        e.item.selection.restore();\n        this.callBack(e);\n    };\n    LinkCommand.prototype.callBack = function (e) {\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    return LinkCommand;\n}());\nexport { LinkCommand };\n"]},"metadata":{},"sourceType":"module"}