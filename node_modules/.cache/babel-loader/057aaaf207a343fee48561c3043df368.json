{"ast":null,"code":"import { createElement, isNullOrUndefined as isNOU, detach, closest, addClass, removeClass, select, Browser, formatUnit } from '@syncfusion/ej2-base';\nimport * as CONSTANT from './../base/constant';\nimport * as classes from './../base/classes';\nimport { InsertHtml } from './inserthtml';\n/**\n * Link internal component\n *\n * @hidden\n\n */\n\nvar ImageCommand =\n/** @class */\nfunction () {\n  /**\n   * Constructor for creating the Formats plugin\n   *\n   * @param {EditorManager} parent - specifies the parent element\n   * @hidden\n    */\n  function ImageCommand(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n\n  ImageCommand.prototype.addEventListener = function () {\n    this.parent.observer.on(CONSTANT.IMAGE, this.imageCommand, this);\n  };\n  /**\n   * imageCommand method\n   *\n   * @param {IHtmlItem} e - specifies the element\n   * @returns {void}\n   * @hidden\n    */\n\n\n  ImageCommand.prototype.imageCommand = function (e) {\n    switch (e.value.toString().toLowerCase()) {\n      case 'image':\n      case 'replace':\n        this.createImage(e);\n        break;\n\n      case 'insertlink':\n        this.insertImageLink(e);\n        break;\n\n      case 'openimagelink':\n        this.openImageLink(e);\n        break;\n\n      case 'editimagelink':\n        this.editImageLink(e);\n        break;\n\n      case 'removeimagelink':\n        this.removeImageLink(e);\n        break;\n\n      case 'remove':\n        this.removeImage(e);\n        break;\n\n      case 'alttext':\n        this.insertAltTextImage(e);\n        break;\n\n      case 'dimension':\n        this.imageDimension(e);\n        break;\n\n      case 'caption':\n        this.imageCaption(e);\n        break;\n\n      case 'justifyleft':\n        this.imageJustifyLeft(e);\n        break;\n\n      case 'justifycenter':\n        this.imageJustifyCenter(e);\n        break;\n\n      case 'justifyright':\n        this.imageJustifyRight(e);\n        break;\n\n      case 'inline':\n        this.imageInline(e);\n        break;\n\n      case 'break':\n        this.imageBreak(e);\n        break;\n    }\n  };\n\n  ImageCommand.prototype.createImage = function (e) {\n    var _this = this;\n\n    var isReplaced = false;\n    e.item.url = isNOU(e.item.url) || e.item.url === 'undefined' ? e.item.src : e.item.url;\n\n    if (!isNOU(e.item.selectParent) && e.item.selectParent[0].tagName === 'IMG') {\n      var imgEle = e.item.selectParent[0];\n      this.setStyle(imgEle, e);\n      isReplaced = true;\n    } else {\n      var imgElement = createElement('img');\n      this.setStyle(imgElement, e);\n\n      if (!isNOU(e.item.selection)) {\n        e.item.selection.restore();\n      }\n\n      if (!isNOU(e.selector) && e.selector === 'pasteCleanupModule') {\n        e.callBack({\n          requestType: 'Images',\n          editorMode: 'HTML',\n          event: e.event,\n          range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n          elements: [imgElement]\n        });\n      } else {\n        InsertHtml.Insert(this.parent.currentDocument, imgElement, this.parent.editableElement);\n      }\n    }\n\n    if (e.callBack && (isNOU(e.selector) || !isNOU(e.selector) && e.selector !== 'pasteCleanupModule')) {\n      var selectedNode = this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0];\n      var imgElm_1 = e.value === 'Replace' || isReplaced ? e.item.selectParent[0] : Browser.isIE ? selectedNode.previousSibling : selectedNode.previousElementSibling;\n      imgElm_1.addEventListener('load', function () {\n        if (e.value !== 'Replace' || !isReplaced) {\n          e.callBack({\n            requestType: 'Images',\n            editorMode: 'HTML',\n            event: e.event,\n            range: _this.parent.nodeSelection.getRange(_this.parent.currentDocument),\n            elements: [imgElm_1]\n          });\n        }\n      });\n    }\n  };\n\n  ImageCommand.prototype.setStyle = function (imgElement, e) {\n    if (!isNOU(e.item.url)) {\n      imgElement.setAttribute('src', e.item.url);\n    }\n\n    imgElement.setAttribute('class', 'e-rte-image' + (isNOU(e.item.cssClass) ? '' : ' ' + e.item.cssClass));\n\n    if (!isNOU(e.item.altText)) {\n      imgElement.setAttribute('alt', e.item.altText);\n    }\n\n    if (!isNOU(e.item.width) && !isNOU(e.item.width.width)) {\n      imgElement.setAttribute('width', this.calculateStyleValue(e.item.width.width));\n    }\n\n    if (!isNOU(e.item.height) && !isNOU(e.item.height.height)) {\n      imgElement.setAttribute('height', this.calculateStyleValue(e.item.height.height));\n    }\n\n    if (!isNOU(e.item.width) && !isNOU(e.item.width.minWidth)) {\n      imgElement.style.minWidth = this.calculateStyleValue(e.item.width.minWidth);\n    }\n\n    if (!isNOU(e.item.width) && !isNOU(e.item.width.maxWidth)) {\n      imgElement.style.maxWidth = this.calculateStyleValue(e.item.width.maxWidth);\n    }\n\n    if (!isNOU(e.item.height) && !isNOU(e.item.height.minHeight)) {\n      imgElement.style.minHeight = this.calculateStyleValue(e.item.height.minHeight);\n    }\n\n    if (!isNOU(e.item.height) && !isNOU(e.item.height.maxHeight)) {\n      imgElement.style.maxHeight = this.calculateStyleValue(e.item.height.maxHeight);\n    }\n  };\n\n  ImageCommand.prototype.calculateStyleValue = function (value) {\n    var styleValue;\n\n    if (typeof value === 'string') {\n      if (value.indexOf('px') || value.indexOf('%') || value.indexOf('auto')) {\n        styleValue = value;\n      } else {\n        styleValue = value + 'px';\n      }\n    } else {\n      styleValue = value + 'px';\n    }\n\n    return styleValue;\n  };\n\n  ImageCommand.prototype.insertImageLink = function (e) {\n    var anchor = createElement('a', {\n      attrs: {\n        href: e.item.url\n      }\n    });\n\n    if (e.item.selectNode[0].parentElement.classList.contains('e-img-wrap')) {\n      e.item.selection.restore();\n      anchor.setAttribute('contenteditable', 'true');\n    }\n\n    anchor.appendChild(e.item.selectNode[0]);\n\n    if (!isNOU(e.item.target)) {\n      anchor.setAttribute('target', e.item.target);\n    }\n\n    InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.openImageLink = function (e) {\n    document.defaultView.open(e.item.url, e.item.target);\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.removeImageLink = function (e) {\n    var selectParent = e.item.selectParent[0];\n\n    if (selectParent.classList.contains('e-img-caption')) {\n      var capImgWrap = select('.e-img-wrap', selectParent);\n      var textEle = select('.e-img-inner', selectParent);\n      var newTextEle = textEle.cloneNode(true);\n      detach(select('a', selectParent));\n      detach(textEle);\n      capImgWrap.appendChild(e.item.insertElement);\n      capImgWrap.appendChild(newTextEle);\n    } else {\n      detach(selectParent);\n\n      if (Browser.isIE) {\n        e.item.selection.restore();\n      }\n\n      InsertHtml.Insert(this.parent.currentDocument, e.item.insertElement, this.parent.editableElement);\n    }\n\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.editImageLink = function (e) {\n    e.item.selectNode[0].parentElement.href = e.item.url;\n\n    if (isNOU(e.item.target)) {\n      e.item.selectNode[0].parentElement.removeAttribute('target');\n    } else {\n      e.item.selectNode[0].parentElement.target = e.item.target;\n    }\n\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.removeImage = function (e) {\n    if (closest(e.item.selectNode[0], 'a')) {\n      if (e.item.selectNode[0].parentElement.nodeName === 'A' && !isNOU(e.item.selectNode[0].parentElement.innerText)) {\n        detach(e.item.selectNode[0]);\n      } else {\n        detach(closest(e.item.selectNode[0], 'a'));\n      }\n    } else if (!isNOU(closest(e.item.selectNode[0], '.' + classes.CLASS_CAPTION))) {\n      detach(closest(e.item.selectNode[0], '.' + classes.CLASS_CAPTION));\n    } else {\n      detach(e.item.selectNode[0]);\n    }\n\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.insertAltTextImage = function (e) {\n    e.item.selectNode[0].setAttribute('alt', e.item.altText);\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.imageDimension = function (e) {\n    var selectNode = e.item.selectNode[0];\n    selectNode.style.height = '';\n    selectNode.style.width = '';\n\n    if (e.item.width !== 'auto') {\n      selectNode.style.width = formatUnit(e.item.width);\n    } else {\n      selectNode.removeAttribute('width');\n    }\n\n    if (e.item.height !== 'auto') {\n      selectNode.style.height = formatUnit(e.item.height);\n    } else {\n      selectNode.removeAttribute('height');\n    }\n\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.imageCaption = function (e) {\n    InsertHtml.Insert(this.parent.currentDocument, e.item.insertElement, this.parent.editableElement);\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.imageJustifyLeft = function (e) {\n    var selectNode = e.item.selectNode[0];\n\n    if (!isNOU(selectNode)) {\n      selectNode.removeAttribute('class');\n      addClass([selectNode], 'e-rte-image');\n\n      if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n        removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n        addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n      }\n\n      if (selectNode.parentElement.nodeName === 'A') {\n        removeClass([selectNode.parentElement], classes.CLASS_IMAGE_RIGHT);\n        addClass([selectNode.parentElement], classes.CLASS_IMAGE_LEFT);\n        addClass([selectNode], classes.CLASS_IMAGE_LEFT);\n      } else {\n        addClass([selectNode], classes.CLASS_IMAGE_LEFT);\n      }\n\n      this.callBack(e);\n    }\n  };\n\n  ImageCommand.prototype.imageJustifyCenter = function (e) {\n    var selectNode = e.item.selectNode[0];\n\n    if (!isNOU(selectNode)) {\n      selectNode.removeAttribute('class');\n      addClass([selectNode], 'e-rte-image');\n\n      if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n        removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n        removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n        addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_CENTER);\n      }\n\n      if (selectNode.parentElement.nodeName === 'A') {\n        removeClass([selectNode.parentElement], classes.CLASS_IMAGE_LEFT);\n        removeClass([selectNode.parentElement], classes.CLASS_IMAGE_RIGHT);\n        addClass([selectNode.parentElement], classes.CLASS_IMAGE_CENTER);\n        addClass([selectNode], classes.CLASS_IMAGE_CENTER);\n      } else {\n        addClass([selectNode], classes.CLASS_IMAGE_CENTER);\n      }\n\n      this.callBack(e);\n    }\n  };\n\n  ImageCommand.prototype.imageJustifyRight = function (e) {\n    var selectNode = e.item.selectNode[0];\n\n    if (!isNOU(selectNode)) {\n      selectNode.removeAttribute('class');\n      addClass([selectNode], 'e-rte-image');\n\n      if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n        removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n        addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n      }\n\n      if (selectNode.parentElement.nodeName === 'A') {\n        removeClass([selectNode.parentElement], classes.CLASS_IMAGE_LEFT);\n        addClass([selectNode.parentElement], classes.CLASS_IMAGE_RIGHT);\n        addClass([selectNode], classes.CLASS_IMAGE_RIGHT);\n      } else {\n        addClass([selectNode], classes.CLASS_IMAGE_RIGHT);\n      }\n\n      this.callBack(e);\n    }\n  };\n\n  ImageCommand.prototype.imageInline = function (e) {\n    var selectNode = e.item.selectNode[0];\n    selectNode.removeAttribute('class');\n    addClass([selectNode], 'e-rte-image');\n    addClass([selectNode], classes.CLASS_IMAGE_INLINE);\n\n    if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_BREAK);\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_CENTER);\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n      addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_CAPTION_INLINE);\n    }\n\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.imageBreak = function (e) {\n    var selectNode = e.item.selectNode[0];\n    selectNode.removeAttribute('class');\n    addClass([selectNode], classes.CLASS_IMAGE_BREAK);\n    addClass([selectNode], 'e-rte-image');\n\n    if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_CAPTION_INLINE);\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_CENTER);\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n      removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n      addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_BREAK);\n    }\n\n    this.callBack(e);\n  };\n\n  ImageCommand.prototype.callBack = function (e) {\n    if (e.callBack) {\n      e.callBack({\n        requestType: e.item.subCommand,\n        editorMode: 'HTML',\n        event: e.event,\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n      });\n    }\n  };\n\n  return ImageCommand;\n}();\n\nexport { ImageCommand };","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/image.js"],"names":["createElement","isNullOrUndefined","isNOU","detach","closest","addClass","removeClass","select","Browser","formatUnit","CONSTANT","classes","InsertHtml","ImageCommand","parent","addEventListener","prototype","observer","on","IMAGE","imageCommand","e","value","toString","toLowerCase","createImage","insertImageLink","openImageLink","editImageLink","removeImageLink","removeImage","insertAltTextImage","imageDimension","imageCaption","imageJustifyLeft","imageJustifyCenter","imageJustifyRight","imageInline","imageBreak","_this","isReplaced","item","url","src","selectParent","tagName","imgEle","setStyle","imgElement","selection","restore","selector","callBack","requestType","editorMode","event","range","nodeSelection","getRange","currentDocument","elements","Insert","editableElement","selectedNode","getSelectedNodes","imgElm_1","isIE","previousSibling","previousElementSibling","setAttribute","cssClass","altText","width","calculateStyleValue","height","minWidth","style","maxWidth","minHeight","maxHeight","styleValue","indexOf","anchor","attrs","href","selectNode","parentElement","classList","contains","appendChild","target","document","defaultView","open","capImgWrap","textEle","newTextEle","cloneNode","insertElement","removeAttribute","nodeName","innerText","CLASS_CAPTION","CLASS_IMAGE_RIGHT","CLASS_IMAGE_LEFT","CLASS_IMAGE_CENTER","CLASS_IMAGE_INLINE","CLASS_IMAGE_BREAK","CLASS_CAPTION_INLINE","subCommand"],"mappings":"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","sourcesContent":["import { createElement, isNullOrUndefined as isNOU, detach, closest, addClass, removeClass, select, Browser, formatUnit } from '@syncfusion/ej2-base';\nimport * as CONSTANT from './../base/constant';\nimport * as classes from './../base/classes';\nimport { InsertHtml } from './inserthtml';\n/**\n * Link internal component\n *\n * @hidden\n\n */\nvar ImageCommand = /** @class */ (function () {\n    /**\n     * Constructor for creating the Formats plugin\n     *\n     * @param {EditorManager} parent - specifies the parent element\n     * @hidden\n\n     */\n    function ImageCommand(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ImageCommand.prototype.addEventListener = function () {\n        this.parent.observer.on(CONSTANT.IMAGE, this.imageCommand, this);\n    };\n    /**\n     * imageCommand method\n     *\n     * @param {IHtmlItem} e - specifies the element\n     * @returns {void}\n     * @hidden\n\n     */\n    ImageCommand.prototype.imageCommand = function (e) {\n        switch (e.value.toString().toLowerCase()) {\n            case 'image':\n            case 'replace':\n                this.createImage(e);\n                break;\n            case 'insertlink':\n                this.insertImageLink(e);\n                break;\n            case 'openimagelink':\n                this.openImageLink(e);\n                break;\n            case 'editimagelink':\n                this.editImageLink(e);\n                break;\n            case 'removeimagelink':\n                this.removeImageLink(e);\n                break;\n            case 'remove':\n                this.removeImage(e);\n                break;\n            case 'alttext':\n                this.insertAltTextImage(e);\n                break;\n            case 'dimension':\n                this.imageDimension(e);\n                break;\n            case 'caption':\n                this.imageCaption(e);\n                break;\n            case 'justifyleft':\n                this.imageJustifyLeft(e);\n                break;\n            case 'justifycenter':\n                this.imageJustifyCenter(e);\n                break;\n            case 'justifyright':\n                this.imageJustifyRight(e);\n                break;\n            case 'inline':\n                this.imageInline(e);\n                break;\n            case 'break':\n                this.imageBreak(e);\n                break;\n        }\n    };\n    ImageCommand.prototype.createImage = function (e) {\n        var _this = this;\n        var isReplaced = false;\n        e.item.url = isNOU(e.item.url) || e.item.url === 'undefined' ? e.item.src : e.item.url;\n        if (!isNOU(e.item.selectParent) && e.item.selectParent[0].tagName === 'IMG') {\n            var imgEle = e.item.selectParent[0];\n            this.setStyle(imgEle, e);\n            isReplaced = true;\n        }\n        else {\n            var imgElement = createElement('img');\n            this.setStyle(imgElement, e);\n            if (!isNOU(e.item.selection)) {\n                e.item.selection.restore();\n            }\n            if (!isNOU(e.selector) && e.selector === 'pasteCleanupModule') {\n                e.callBack({ requestType: 'Images',\n                    editorMode: 'HTML',\n                    event: e.event,\n                    range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                    elements: [imgElement]\n                });\n            }\n            else {\n                InsertHtml.Insert(this.parent.currentDocument, imgElement, this.parent.editableElement);\n            }\n        }\n        if (e.callBack && (isNOU(e.selector) || !isNOU(e.selector) && e.selector !== 'pasteCleanupModule')) {\n            var selectedNode = this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0];\n            var imgElm_1 = (e.value === 'Replace' || isReplaced) ? e.item.selectParent[0] :\n                (Browser.isIE ? selectedNode.previousSibling : selectedNode.previousElementSibling);\n            imgElm_1.addEventListener('load', function () {\n                if (e.value !== 'Replace' || !isReplaced) {\n                    e.callBack({\n                        requestType: 'Images',\n                        editorMode: 'HTML',\n                        event: e.event,\n                        range: _this.parent.nodeSelection.getRange(_this.parent.currentDocument),\n                        elements: [imgElm_1]\n                    });\n                }\n            });\n        }\n    };\n    ImageCommand.prototype.setStyle = function (imgElement, e) {\n        if (!isNOU(e.item.url)) {\n            imgElement.setAttribute('src', e.item.url);\n        }\n        imgElement.setAttribute('class', 'e-rte-image' + (isNOU(e.item.cssClass) ? '' : ' ' + e.item.cssClass));\n        if (!isNOU(e.item.altText)) {\n            imgElement.setAttribute('alt', e.item.altText);\n        }\n        if (!isNOU(e.item.width) && !isNOU(e.item.width.width)) {\n            imgElement.setAttribute('width', this.calculateStyleValue(e.item.width.width));\n        }\n        if (!isNOU(e.item.height) && !isNOU(e.item.height.height)) {\n            imgElement.setAttribute('height', this.calculateStyleValue(e.item.height.height));\n        }\n        if (!isNOU(e.item.width) && !isNOU(e.item.width.minWidth)) {\n            imgElement.style.minWidth = this.calculateStyleValue(e.item.width.minWidth);\n        }\n        if (!isNOU(e.item.width) && !isNOU(e.item.width.maxWidth)) {\n            imgElement.style.maxWidth = this.calculateStyleValue(e.item.width.maxWidth);\n        }\n        if (!isNOU(e.item.height) && !isNOU(e.item.height.minHeight)) {\n            imgElement.style.minHeight = this.calculateStyleValue(e.item.height.minHeight);\n        }\n        if (!isNOU(e.item.height) && !isNOU(e.item.height.maxHeight)) {\n            imgElement.style.maxHeight = this.calculateStyleValue(e.item.height.maxHeight);\n        }\n    };\n    ImageCommand.prototype.calculateStyleValue = function (value) {\n        var styleValue;\n        if (typeof (value) === 'string') {\n            if (value.indexOf('px') || value.indexOf('%') || value.indexOf('auto')) {\n                styleValue = value;\n            }\n            else {\n                styleValue = value + 'px';\n            }\n        }\n        else {\n            styleValue = value + 'px';\n        }\n        return styleValue;\n    };\n    ImageCommand.prototype.insertImageLink = function (e) {\n        var anchor = createElement('a', {\n            attrs: {\n                href: e.item.url\n            }\n        });\n        if (e.item.selectNode[0].parentElement.classList.contains('e-img-wrap')) {\n            e.item.selection.restore();\n            anchor.setAttribute('contenteditable', 'true');\n        }\n        anchor.appendChild(e.item.selectNode[0]);\n        if (!isNOU(e.item.target)) {\n            anchor.setAttribute('target', e.item.target);\n        }\n        InsertHtml.Insert(this.parent.currentDocument, anchor, this.parent.editableElement);\n        this.callBack(e);\n    };\n    ImageCommand.prototype.openImageLink = function (e) {\n        document.defaultView.open(e.item.url, e.item.target);\n        this.callBack(e);\n    };\n    ImageCommand.prototype.removeImageLink = function (e) {\n        var selectParent = e.item.selectParent[0];\n        if (selectParent.classList.contains('e-img-caption')) {\n            var capImgWrap = select('.e-img-wrap', selectParent);\n            var textEle = select('.e-img-inner', selectParent);\n            var newTextEle = textEle.cloneNode(true);\n            detach(select('a', selectParent));\n            detach(textEle);\n            capImgWrap.appendChild(e.item.insertElement);\n            capImgWrap.appendChild(newTextEle);\n        }\n        else {\n            detach(selectParent);\n            if (Browser.isIE) {\n                e.item.selection.restore();\n            }\n            InsertHtml.Insert(this.parent.currentDocument, e.item.insertElement, this.parent.editableElement);\n        }\n        this.callBack(e);\n    };\n    ImageCommand.prototype.editImageLink = function (e) {\n        e.item.selectNode[0].parentElement.href = e.item.url;\n        if (isNOU(e.item.target)) {\n            e.item.selectNode[0].parentElement.removeAttribute('target');\n        }\n        else {\n            e.item.selectNode[0].parentElement.target = e.item.target;\n        }\n        this.callBack(e);\n    };\n    ImageCommand.prototype.removeImage = function (e) {\n        if (closest(e.item.selectNode[0], 'a')) {\n            if (e.item.selectNode[0].parentElement.nodeName === 'A' && !isNOU(e.item.selectNode[0].parentElement.innerText)) {\n                detach(e.item.selectNode[0]);\n            }\n            else {\n                detach(closest(e.item.selectNode[0], 'a'));\n            }\n        }\n        else if (!isNOU(closest(e.item.selectNode[0], '.' + classes.CLASS_CAPTION))) {\n            detach(closest(e.item.selectNode[0], '.' + classes.CLASS_CAPTION));\n        }\n        else {\n            detach(e.item.selectNode[0]);\n        }\n        this.callBack(e);\n    };\n    ImageCommand.prototype.insertAltTextImage = function (e) {\n        e.item.selectNode[0].setAttribute('alt', e.item.altText);\n        this.callBack(e);\n    };\n    ImageCommand.prototype.imageDimension = function (e) {\n        var selectNode = e.item.selectNode[0];\n        selectNode.style.height = '';\n        selectNode.style.width = '';\n        if (e.item.width !== 'auto') {\n            selectNode.style.width = formatUnit(e.item.width);\n        }\n        else {\n            selectNode.removeAttribute('width');\n        }\n        if (e.item.height !== 'auto') {\n            selectNode.style.height = formatUnit(e.item.height);\n        }\n        else {\n            selectNode.removeAttribute('height');\n        }\n        this.callBack(e);\n    };\n    ImageCommand.prototype.imageCaption = function (e) {\n        InsertHtml.Insert(this.parent.currentDocument, e.item.insertElement, this.parent.editableElement);\n        this.callBack(e);\n    };\n    ImageCommand.prototype.imageJustifyLeft = function (e) {\n        var selectNode = e.item.selectNode[0];\n        if (!isNOU(selectNode)) {\n            selectNode.removeAttribute('class');\n            addClass([selectNode], 'e-rte-image');\n            if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n                removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n                addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n            }\n            if (selectNode.parentElement.nodeName === 'A') {\n                removeClass([selectNode.parentElement], classes.CLASS_IMAGE_RIGHT);\n                addClass([selectNode.parentElement], classes.CLASS_IMAGE_LEFT);\n                addClass([selectNode], classes.CLASS_IMAGE_LEFT);\n            }\n            else {\n                addClass([selectNode], classes.CLASS_IMAGE_LEFT);\n            }\n            this.callBack(e);\n        }\n    };\n    ImageCommand.prototype.imageJustifyCenter = function (e) {\n        var selectNode = e.item.selectNode[0];\n        if (!isNOU(selectNode)) {\n            selectNode.removeAttribute('class');\n            addClass([selectNode], 'e-rte-image');\n            if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n                removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n                removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n                addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_CENTER);\n            }\n            if (selectNode.parentElement.nodeName === 'A') {\n                removeClass([selectNode.parentElement], classes.CLASS_IMAGE_LEFT);\n                removeClass([selectNode.parentElement], classes.CLASS_IMAGE_RIGHT);\n                addClass([selectNode.parentElement], classes.CLASS_IMAGE_CENTER);\n                addClass([selectNode], classes.CLASS_IMAGE_CENTER);\n            }\n            else {\n                addClass([selectNode], classes.CLASS_IMAGE_CENTER);\n            }\n            this.callBack(e);\n        }\n    };\n    ImageCommand.prototype.imageJustifyRight = function (e) {\n        var selectNode = e.item.selectNode[0];\n        if (!isNOU(selectNode)) {\n            selectNode.removeAttribute('class');\n            addClass([selectNode], 'e-rte-image');\n            if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n                removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n                addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n            }\n            if (selectNode.parentElement.nodeName === 'A') {\n                removeClass([selectNode.parentElement], classes.CLASS_IMAGE_LEFT);\n                addClass([selectNode.parentElement], classes.CLASS_IMAGE_RIGHT);\n                addClass([selectNode], classes.CLASS_IMAGE_RIGHT);\n            }\n            else {\n                addClass([selectNode], classes.CLASS_IMAGE_RIGHT);\n            }\n            this.callBack(e);\n        }\n    };\n    ImageCommand.prototype.imageInline = function (e) {\n        var selectNode = e.item.selectNode[0];\n        selectNode.removeAttribute('class');\n        addClass([selectNode], 'e-rte-image');\n        addClass([selectNode], classes.CLASS_IMAGE_INLINE);\n        if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_BREAK);\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_CENTER);\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n            addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_CAPTION_INLINE);\n        }\n        this.callBack(e);\n    };\n    ImageCommand.prototype.imageBreak = function (e) {\n        var selectNode = e.item.selectNode[0];\n        selectNode.removeAttribute('class');\n        addClass([selectNode], classes.CLASS_IMAGE_BREAK);\n        addClass([selectNode], 'e-rte-image');\n        if (!isNOU(closest(selectNode, '.' + classes.CLASS_CAPTION))) {\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_CAPTION_INLINE);\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_CENTER);\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_LEFT);\n            removeClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_RIGHT);\n            addClass([closest(selectNode, '.' + classes.CLASS_CAPTION)], classes.CLASS_IMAGE_BREAK);\n        }\n        this.callBack(e);\n    };\n    ImageCommand.prototype.callBack = function (e) {\n        if (e.callBack) {\n            e.callBack({\n                requestType: e.item.subCommand,\n                editorMode: 'HTML',\n                event: e.event,\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)\n            });\n        }\n    };\n    return ImageCommand;\n}());\nexport { ImageCommand };\n"]},"metadata":{},"sourceType":"module"}