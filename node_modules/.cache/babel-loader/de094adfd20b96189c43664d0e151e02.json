{"ast":null,"code":"import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { formatUnit } from '@syncfusion/ej2-base';\nimport { columnWidthChanged, preventFrozenScrollRefresh } from '../base/constant';\nimport { Column } from '../models/column';\nimport { parentsUntil, ispercentageWidth, getScrollBarWidth } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * ColumnWidthService\n *\n * @hidden\n */\n\nvar ColumnWidthService =\n/** @class */\nfunction () {\n  function ColumnWidthService(parent) {\n    this.parent = parent;\n  }\n\n  ColumnWidthService.prototype.setWidthToColumns = function () {\n    var i = 0;\n    var indexes = this.parent.getColumnIndexesInView();\n    var wFlag = true;\n    var totalColumnsWidth = 0;\n\n    if (this.parent.allowGrouping) {\n      for (var len = this.parent.groupSettings.columns.length; i < len; i++) {\n        if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n          wFlag = false;\n          continue;\n        }\n\n        this.setColumnWidth(new Column({\n          width: '30px'\n        }), i);\n      }\n    }\n\n    if (this.parent.detailTemplate || this.parent.childGrid) {\n      this.setColumnWidth(new Column({\n        width: '30px'\n      }), i);\n      i++;\n    }\n\n    if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n      this.setColumnWidth(new Column({\n        width: '30px'\n      }), i);\n      i++;\n    }\n\n    var columns = this.parent.getColumns();\n\n    for (var j = 0; j < columns.length; j++) {\n      this.setColumnWidth(columns[j], wFlag && this.parent.enableColumnVirtualization ? undefined : j + i);\n    }\n\n    if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n      this.setColumnWidth(new Column({\n        width: '30px'\n      }), columns.length);\n    }\n\n    totalColumnsWidth = this.getTableWidth(this.parent.getColumns());\n\n    if (this.parent.width !== 'auto' && this.parent.width.toString().indexOf('%') === -1) {\n      this.setMinwidthBycalculation(totalColumnsWidth);\n    }\n  };\n\n  ColumnWidthService.prototype.setMinwidthBycalculation = function (tWidth) {\n    var difference = 0;\n    var collection = this.parent.getColumns().filter(function (a) {\n      return isNullOrUndefined(a.width) || a.width === 'auto';\n    });\n\n    if (collection.length) {\n      if (!isNullOrUndefined(this.parent.width) && this.parent.width !== 'auto' && typeof this.parent.width === 'string' && this.parent.width.indexOf('%') === -1) {\n        difference = (typeof this.parent.width === 'string' ? parseInt(this.parent.width, 10) : this.parent.width) - tWidth;\n      } else {\n        difference = this.parent.element.getBoundingClientRect().width - tWidth;\n      }\n\n      var tmWidth = 0;\n\n      for (var _i = 0, collection_1 = collection; _i < collection_1.length; _i++) {\n        var cols = collection_1[_i];\n        tmWidth += !isNullOrUndefined(cols.minWidth) ? typeof cols.minWidth === 'string' ? parseInt(cols.minWidth, 10) : cols.minWidth : 0;\n      }\n\n      for (var i = 0; i < collection.length; i++) {\n        if (tWidth === 0 && this.parent.allowResizing && this.isWidthUndefined() && i !== collection.length - 1) {\n          this.setUndefinedColumnWidth(collection);\n        }\n\n        var index = this.parent.getColumnIndexByField(collection[i].field) + this.parent.getIndentCount();\n\n        if (tWidth !== 0 && difference < tmWidth) {\n          this.setWidth(collection[i].minWidth, index);\n        } else if (tWidth !== 0 && difference > tmWidth) {\n          this.setWidth('', index, true);\n        }\n      }\n    }\n  };\n\n  ColumnWidthService.prototype.setUndefinedColumnWidth = function (collection) {\n    for (var k = 0; k < collection.length; k++) {\n      if (k !== collection.length - 1) {\n        collection[k].width = 200;\n        this.setWidth(200, this.parent.getColumnIndexByField(collection[k].field));\n      }\n    }\n  };\n\n  ColumnWidthService.prototype.setColumnWidth = function (column, index, module) {\n    if (this.parent.getColumns().length < 1) {\n      return;\n    }\n\n    var columnIndex = isNullOrUndefined(index) ? this.parent.getNormalizedColumnIndex(column.uid) : index;\n    var cWidth = this.getWidth(column);\n    var tgridWidth = this.getTableWidth(this.parent.getColumns());\n\n    if (cWidth !== null) {\n      this.setWidth(cWidth, columnIndex);\n\n      if (this.parent.width !== 'auto' && this.parent.width.toString().indexOf('%') === -1) {\n        this.setMinwidthBycalculation(tgridWidth);\n      }\n\n      if (this.parent.allowResizing && module === 'resize' || this.parent.getFrozenColumns() && this.parent.allowResizing) {\n        this.setWidthToTable();\n      }\n\n      this.parent.notify(columnWidthChanged, {\n        index: columnIndex,\n        width: cWidth,\n        column: column,\n        module: module\n      });\n    }\n  };\n\n  ColumnWidthService.prototype.setWidth = function (width, index, clear) {\n    if (this.parent.groupSettings.columns.length > index && ispercentageWidth(this.parent)) {\n      var elementWidth = this.parent.element.offsetWidth;\n      width = (30 / elementWidth * 100).toFixed(1) + '%';\n    }\n\n    var header = this.parent.getHeaderTable();\n    var content = this.parent.getContentTable();\n    var fWidth = formatUnit(width);\n    var headerCol;\n    var frzCols = this.parent.getFrozenColumns();\n    var isDraggable = this.parent.isRowDragable();\n    frzCols = frzCols && isDraggable ? frzCols + 1 : frzCols;\n    var mHdr = this.parent.getHeaderContent().querySelector('.' + literals.movableHeader);\n    var mCont = this.parent.getContent().querySelector('.' + literals.movableContent);\n    var freezeLeft = this.parent.getFrozenLeftColumnsCount();\n    var freezeRight = this.parent.getFrozenRightColumnsCount();\n    var movableCount = this.parent.getMovableColumnsCount();\n    var isColFrozen = freezeLeft !== 0 || freezeRight !== 0;\n\n    if (frzCols && index >= frzCols) {\n      if (!mHdr || !mHdr.querySelector(literals.colGroup)) {\n        return;\n      }\n\n      headerCol = mHdr.querySelector(literals.colGroup).children[index - frzCols];\n    } else if (this.parent.enableColumnVirtualization && frzCols && this.parent.contentModule.isXaxis() && mHdr.scrollLeft > 0) {\n      var colGroup = mHdr.querySelector(literals.colGroup);\n      headerCol = colGroup.children[colGroup.children.length - 1 - index];\n    } else if (isColFrozen) {\n      var target = void 0;\n\n      if (freezeLeft && !freezeRight) {\n        index = isDraggable ? index - 1 : index;\n        target = index < freezeLeft ? header : mHdr;\n      } else if (!freezeLeft && freezeRight) {\n        target = index >= movableCount ? header : mHdr;\n      } else if (freezeLeft && freezeRight) {\n        index = isDraggable ? index - 1 : index;\n        var frHdr = this.parent.getFrozenRightHeader();\n        target = index < freezeLeft ? header : index < freezeLeft + movableCount ? mHdr : frHdr;\n      }\n\n      headerCol = this.getColumnLevelFrozenColgroup(index, freezeLeft, movableCount, target);\n\n      if (!headerCol) {\n        return;\n      }\n    } else {\n      headerCol = header.querySelector(literals.colGroup).children[index];\n    }\n\n    if (headerCol && !clear) {\n      headerCol.style.width = fWidth;\n    } else if (headerCol && clear) {\n      headerCol.style.width = '';\n    }\n\n    var contentCol;\n\n    if (frzCols && index >= frzCols) {\n      contentCol = this.parent.getContent().querySelector('.' + literals.movableContent).querySelector(literals.colGroup).children[index - frzCols];\n    } else if (this.parent.enableColumnVirtualization && frzCols && this.parent.contentModule.isXaxis() && mCont.scrollLeft > 0) {\n      var colGroup = this.parent.getContent().querySelector('.' + literals.movableContent).querySelector(literals.colGroup);\n      contentCol = colGroup.children[colGroup.children.length - 1 - index];\n    } else if (isColFrozen) {\n      var target = void 0;\n\n      if (freezeLeft && !freezeRight) {\n        target = index < freezeLeft ? content : mCont;\n      }\n\n      if (!freezeLeft && freezeRight) {\n        target = index >= movableCount ? content : mCont;\n      }\n\n      if (freezeLeft && freezeRight) {\n        var frCont = this.parent.getContent().querySelector('.e-frozen-right-content');\n        target = index < freezeLeft ? content : index < freezeLeft + movableCount ? mCont : frCont;\n      }\n\n      contentCol = this.getColumnLevelFrozenColgroup(index, freezeLeft, movableCount, target);\n    } else {\n      contentCol = content.querySelector(literals.colGroup).children[index];\n    }\n\n    if (contentCol && !clear) {\n      contentCol.style.width = fWidth;\n    } else if (contentCol && clear) {\n      contentCol.style.width = '';\n    }\n\n    if (!this.parent.enableColumnVirtualization) {\n      var edit = this.parent.element.querySelectorAll('.e-table.e-inline-edit');\n      var editTableCol = [];\n\n      for (var i = 0; i < edit.length; i++) {\n        if (parentsUntil(edit[i], 'e-grid').id === this.parent.element.id) {\n          for (var j = 0; j < edit[i].querySelector('colgroup').children.length; j++) {\n            editTableCol.push(edit[i].querySelector('colgroup').children[j]);\n          }\n        }\n      }\n\n      if (edit.length && editTableCol.length) {\n        editTableCol[index].style.width = fWidth;\n      }\n    }\n\n    if (this.parent.isFrozenGrid()) {\n      this.refreshFrozenScrollbar();\n    }\n  };\n\n  ColumnWidthService.prototype.getColumnLevelFrozenColgroup = function (index, left, movable, ele) {\n    if (!ele || !ele.querySelector(literals.colGroup)) {\n      return null;\n    }\n\n    var columns = this.parent.getColumns();\n    var isDrag = this.parent.isRowDragable();\n    var frzMode = this.parent.getFrozenMode();\n    var headerCol;\n    var colGroup = [].slice.call(ele.querySelector(literals.colGroup).children);\n\n    if (frzMode === 'Right' && isDrag && index === movable + this.parent.getFrozenRightColumnsCount()) {\n      headerCol = colGroup[colGroup.length - 1];\n    } else if (isDrag && index === -1) {\n      headerCol = colGroup[0];\n    } else if (columns[index].freeze === 'Left') {\n      headerCol = colGroup[isDrag ? index + 1 : index];\n    } else if (columns[index].freeze === 'Right') {\n      headerCol = colGroup[index - (left + movable)];\n    } else {\n      headerCol = colGroup[index - left];\n    }\n\n    return headerCol;\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  ColumnWidthService.prototype.refreshFrozenScrollbar = function () {\n    var args = {\n      cancel: false\n    };\n    this.parent.notify(preventFrozenScrollRefresh, args);\n\n    if (args.cancel) {\n      return;\n    }\n\n    var scrollWidth = getScrollBarWidth();\n    var frozenScrollbar = this.parent.element.querySelector('.e-frozenscrollbar');\n    var movableScrollbar = this.parent.element.querySelector('.e-movablescrollbar');\n    var frozencontent = this.parent.getContent().querySelector('.' + literals.frozenContent);\n    var movableContent = this.parent.getContent().querySelector('.' + literals.movableContent);\n    var frozenWidth = frozencontent.firstElementChild.getBoundingClientRect().width;\n    var movableWidth = movableContent.firstElementChild.getBoundingClientRect().width;\n\n    if (this.parent.getFrozenMode() === 'Right') {\n      frozenWidth = frozenWidth + scrollWidth;\n    }\n\n    frozenScrollbar.style.width = frozenWidth + 'px';\n\n    if (this.parent.getFrozenMode() === literals.leftRight) {\n      var frozenRightScrollbar = this.parent.element.querySelector('.e-frozen-right-scrollbar');\n      var frozenRightWidth = this.parent.getContent().querySelector('.e-frozen-right-content').firstElementChild.getBoundingClientRect().width;\n\n      if (this.parent.height !== 'auto') {\n        frozenRightWidth = frozenRightWidth + scrollWidth;\n      }\n\n      frozenRightScrollbar.style.width = frozenRightWidth + 'px';\n    } else {\n      if (this.parent.enableColumnVirtualization) {\n        var placeHolder = this.parent.getMovableVirtualContent().querySelector('.e-virtualtrack');\n\n        if (placeHolder) {\n          movableWidth = placeHolder.scrollWidth;\n        }\n      }\n\n      if (this.parent.getFrozenMode() !== 'Right' && this.parent.height !== 'auto') {\n        movableWidth = movableWidth + scrollWidth;\n      }\n    }\n\n    movableScrollbar.firstElementChild.style.width = movableWidth + 'px';\n  };\n\n  ColumnWidthService.prototype.getSiblingsHeight = function (element) {\n    var previous = this.getHeightFromDirection(element, 'previous');\n    var next = this.getHeightFromDirection(element, 'next');\n    return previous + next;\n  };\n\n  ColumnWidthService.prototype.getHeightFromDirection = function (element, direction) {\n    var sibling = element[direction + 'ElementSibling'];\n    var result = 0;\n    var classList = [literals.gridHeader, literals.gridFooter, 'e-groupdroparea', 'e-gridpager', 'e-toolbar'];\n\n    while (sibling) {\n      if (classList.some(function (value) {\n        return sibling.classList.contains(value);\n      })) {\n        result += sibling.offsetHeight;\n      }\n\n      sibling = sibling[direction + 'ElementSibling'];\n    }\n\n    return result;\n  };\n\n  ColumnWidthService.prototype.isWidthUndefined = function () {\n    var isWidUndefCount = this.parent.getColumns().filter(function (col) {\n      return isNullOrUndefined(col.width) && isNullOrUndefined(col.minWidth);\n    }).length;\n    return this.parent.getColumns().length === isWidUndefCount;\n  };\n\n  ColumnWidthService.prototype.getWidth = function (column) {\n    if (isNullOrUndefined(column.width) && this.parent.allowResizing && isNullOrUndefined(column.minWidth) && !this.isWidthUndefined()) {\n      column.width = 200;\n    }\n\n    if (this.parent.isFrozenGrid() && isNullOrUndefined(column.width) && (column.getFreezeTableName() === literals.frozenLeft || column.getFreezeTableName() === literals.frozenRight)) {\n      column.width = 200;\n    }\n\n    if (!column.width) {\n      return null;\n    }\n\n    var width = parseInt(column.width.toString(), 10);\n\n    if (column.minWidth && width < parseInt(column.minWidth.toString(), 10)) {\n      return column.minWidth;\n    } else if (column.maxWidth && width > parseInt(column.maxWidth.toString(), 10)) {\n      return column.maxWidth;\n    } else {\n      return column.width;\n    }\n  };\n\n  ColumnWidthService.prototype.getTableWidth = function (columns) {\n    var tWidth = 0;\n\n    for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n      var column = columns_1[_i];\n      var cWidth = this.getWidth(column);\n\n      if (column.width === 'auto') {\n        cWidth = 0;\n      }\n\n      if (column.visible !== false && cWidth !== null) {\n        tWidth += parseInt(cWidth.toString(), 10);\n      }\n    }\n\n    return tWidth;\n  };\n\n  ColumnWidthService.prototype.calcMovableOrFreezeColWidth = function (tableType) {\n    var columns = this.parent.getColumns().slice();\n    var left = this.parent.getFrozenLeftColumnsCount() || this.parent.getFrozenColumns();\n    var movable = this.parent.getMovableColumnsCount();\n    var right = this.parent.getFrozenRightColumnsCount();\n\n    if (tableType === 'movable') {\n      if (right) {\n        columns.splice(left + movable, columns.length);\n      }\n\n      if (left) {\n        columns.splice(0, left);\n      }\n    } else if (tableType === 'freeze-left') {\n      columns.splice(left, columns.length);\n    } else if (tableType === 'freeze-right') {\n      columns.splice(0, left + movable);\n    }\n\n    return formatUnit(this.getTableWidth(columns));\n  };\n\n  ColumnWidthService.prototype.setWidthToFrozenRightTable = function () {\n    var freezeWidth = this.calcMovableOrFreezeColWidth('freeze-right');\n    freezeWidth = this.isAutoResize() ? '100%' : freezeWidth;\n    var headerTbl = this.parent.getHeaderContent().querySelector('.e-frozen-right-header').querySelector('.' + literals.table);\n    var cntTbl = this.parent.getContent().querySelector('.e-frozen-right-content').querySelector('.' + literals.table);\n    headerTbl.style.width = freezeWidth;\n    cntTbl.style.width = freezeWidth;\n  };\n\n  ColumnWidthService.prototype.setWidthToFrozenLeftTable = function () {\n    var freezeWidth = this.calcMovableOrFreezeColWidth('freeze-left');\n    freezeWidth = this.isAutoResize() ? '100%' : freezeWidth;\n    this.parent.getHeaderTable().style.width = freezeWidth;\n    this.parent.getContentTable().style.width = freezeWidth;\n  };\n\n  ColumnWidthService.prototype.setWidthToMovableTable = function () {\n    var movableWidth = '';\n    var isColUndefined = this.parent.getColumns().filter(function (a) {\n      return isNullOrUndefined(a.width);\n    }).length >= 1;\n    var isWidthAuto = this.parent.getColumns().filter(function (a) {\n      return a.width === 'auto';\n    }).length >= 1;\n\n    if (typeof this.parent.width === 'number' && !isColUndefined && !isWidthAuto) {\n      movableWidth = formatUnit(this.parent.width - parseInt(this.calcMovableOrFreezeColWidth('freeze').split('px')[0], 10) - 5);\n    } else if (!isColUndefined && !isWidthAuto) {\n      movableWidth = this.calcMovableOrFreezeColWidth('movable');\n    }\n\n    movableWidth = this.isAutoResize() ? '100%' : movableWidth;\n\n    if (this.parent.getHeaderContent().querySelector('.' + literals.movableHeader).firstElementChild) {\n      this.parent.getHeaderContent().querySelector('.' + literals.movableHeader).firstElementChild.style.width = movableWidth;\n    }\n\n    this.parent.getContent().querySelector('.' + literals.movableContent).firstElementChild.style.width = movableWidth;\n  };\n\n  ColumnWidthService.prototype.setWidthToFrozenEditTable = function () {\n    var freezeWidth = this.calcMovableOrFreezeColWidth('freeze');\n    freezeWidth = this.isAutoResize() ? '100%' : freezeWidth;\n    this.parent.element.querySelectorAll('.e-table.e-inline-edit')[0].style.width = freezeWidth;\n  };\n\n  ColumnWidthService.prototype.setWidthToMovableEditTable = function () {\n    var movableWidth = this.calcMovableOrFreezeColWidth('movable');\n    movableWidth = this.isAutoResize() ? '100%' : movableWidth;\n    this.parent.element.querySelectorAll('.e-table.e-inline-edit')[1].style.width = movableWidth;\n  };\n\n  ColumnWidthService.prototype.setWidthToTable = function () {\n    var tWidth = formatUnit(this.getTableWidth(this.parent.getColumns()));\n\n    if (this.parent.isFrozenGrid()) {\n      if (this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount()) {\n        this.setWidthToFrozenLeftTable();\n      }\n\n      this.setWidthToMovableTable();\n\n      if (this.parent.getFrozenRightColumnsCount()) {\n        this.setWidthToFrozenRightTable();\n      }\n    } else {\n      if (this.parent.detailTemplate || this.parent.childGrid) {\n        this.setColumnWidth(new Column({\n          width: '30px'\n        }));\n      }\n\n      tWidth = this.isAutoResize() ? '100%' : tWidth;\n      this.parent.getHeaderTable().style.width = tWidth;\n      this.parent.getContentTable().style.width = tWidth;\n    }\n\n    var edit = this.parent.element.querySelector('.e-table.e-inline-edit');\n\n    if (edit && this.parent.getFrozenColumns()) {\n      this.setWidthToFrozenEditTable();\n      this.setWidthToMovableEditTable();\n    } else if (edit) {\n      edit.style.width = tWidth;\n    }\n  };\n\n  ColumnWidthService.prototype.isAutoResize = function () {\n    return this.parent.allowResizing && this.parent.resizeSettings.mode === 'Auto';\n  };\n\n  return ColumnWidthService;\n}();\n\nexport { ColumnWidthService };","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/@syncfusion/ej2-grids/src/grid/services/width-controller.js"],"names":["isNullOrUndefined","formatUnit","columnWidthChanged","preventFrozenScrollRefresh","Column","parentsUntil","ispercentageWidth","getScrollBarWidth","literals","ColumnWidthService","parent","prototype","setWidthToColumns","i","indexes","getColumnIndexesInView","wFlag","totalColumnsWidth","allowGrouping","len","groupSettings","columns","length","enableColumnVirtualization","indexOf","setColumnWidth","width","detailTemplate","childGrid","isRowDragable","getFrozenMode","getColumns","j","undefined","getTableWidth","toString","setMinwidthBycalculation","tWidth","difference","collection","filter","a","parseInt","element","getBoundingClientRect","tmWidth","_i","collection_1","cols","minWidth","allowResizing","isWidthUndefined","setUndefinedColumnWidth","index","getColumnIndexByField","field","getIndentCount","setWidth","k","column","module","columnIndex","getNormalizedColumnIndex","uid","cWidth","getWidth","tgridWidth","getFrozenColumns","setWidthToTable","notify","clear","elementWidth","offsetWidth","toFixed","header","getHeaderTable","content","getContentTable","fWidth","headerCol","frzCols","isDraggable","mHdr","getHeaderContent","querySelector","movableHeader","mCont","getContent","movableContent","freezeLeft","getFrozenLeftColumnsCount","freezeRight","getFrozenRightColumnsCount","movableCount","getMovableColumnsCount","isColFrozen","colGroup","children","contentModule","isXaxis","scrollLeft","target","frHdr","getFrozenRightHeader","getColumnLevelFrozenColgroup","style","contentCol","frCont","edit","querySelectorAll","editTableCol","id","push","isFrozenGrid","refreshFrozenScrollbar","left","movable","ele","isDrag","frzMode","slice","call","freeze","args","cancel","scrollWidth","frozenScrollbar","movableScrollbar","frozencontent","frozenContent","frozenWidth","firstElementChild","movableWidth","leftRight","frozenRightScrollbar","frozenRightWidth","height","placeHolder","getMovableVirtualContent","getSiblingsHeight","previous","getHeightFromDirection","next","direction","sibling","result","classList","gridHeader","gridFooter","some","value","contains","offsetHeight","isWidUndefCount","col","getFreezeTableName","frozenLeft","frozenRight","maxWidth","columns_1","visible","calcMovableOrFreezeColWidth","tableType","right","splice","setWidthToFrozenRightTable","freezeWidth","isAutoResize","headerTbl","table","cntTbl","setWidthToFrozenLeftTable","setWidthToMovableTable","isColUndefined","isWidthAuto","split","setWidthToFrozenEditTable","setWidthToMovableEditTable","resizeSettings","mode"],"mappings":"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","sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { formatUnit } from '@syncfusion/ej2-base';\nimport { columnWidthChanged, preventFrozenScrollRefresh } from '../base/constant';\nimport { Column } from '../models/column';\nimport { parentsUntil, ispercentageWidth, getScrollBarWidth } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * ColumnWidthService\n *\n * @hidden\n */\nvar ColumnWidthService = /** @class */ (function () {\n    function ColumnWidthService(parent) {\n        this.parent = parent;\n    }\n    ColumnWidthService.prototype.setWidthToColumns = function () {\n        var i = 0;\n        var indexes = this.parent.getColumnIndexesInView();\n        var wFlag = true;\n        var totalColumnsWidth = 0;\n        if (this.parent.allowGrouping) {\n            for (var len = this.parent.groupSettings.columns.length; i < len; i++) {\n                if (this.parent.enableColumnVirtualization && indexes.indexOf(i) === -1) {\n                    wFlag = false;\n                    continue;\n                }\n                this.setColumnWidth(new Column({ width: '30px' }), i);\n            }\n        }\n        if (this.parent.detailTemplate || this.parent.childGrid) {\n            this.setColumnWidth(new Column({ width: '30px' }), i);\n            i++;\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() !== 'Right') {\n            this.setColumnWidth(new Column({ width: '30px' }), i);\n            i++;\n        }\n        var columns = this.parent.getColumns();\n        for (var j = 0; j < columns.length; j++) {\n            this.setColumnWidth(columns[j], wFlag && this.parent.enableColumnVirtualization ? undefined : j + i);\n        }\n        if (this.parent.isRowDragable() && this.parent.getFrozenMode() === 'Right') {\n            this.setColumnWidth(new Column({ width: '30px' }), columns.length);\n        }\n        totalColumnsWidth = this.getTableWidth(this.parent.getColumns());\n        if (this.parent.width !== 'auto' && this.parent.width.toString().indexOf('%') === -1) {\n            this.setMinwidthBycalculation(totalColumnsWidth);\n        }\n    };\n    ColumnWidthService.prototype.setMinwidthBycalculation = function (tWidth) {\n        var difference = 0;\n        var collection = this.parent.getColumns().filter(function (a) {\n            return isNullOrUndefined(a.width) || a.width === 'auto';\n        });\n        if (collection.length) {\n            if (!isNullOrUndefined(this.parent.width) && this.parent.width !== 'auto' &&\n                typeof (this.parent.width) === 'string' && this.parent.width.indexOf('%') === -1) {\n                difference = (typeof this.parent.width === 'string' ? parseInt(this.parent.width, 10) : this.parent.width) - tWidth;\n            }\n            else {\n                difference = this.parent.element.getBoundingClientRect().width - tWidth;\n            }\n            var tmWidth = 0;\n            for (var _i = 0, collection_1 = collection; _i < collection_1.length; _i++) {\n                var cols = collection_1[_i];\n                tmWidth += !isNullOrUndefined(cols.minWidth) ?\n                    ((typeof cols.minWidth === 'string' ? parseInt(cols.minWidth, 10) : cols.minWidth)) : 0;\n            }\n            for (var i = 0; i < collection.length; i++) {\n                if (tWidth === 0 && this.parent.allowResizing && this.isWidthUndefined() && (i !== collection.length - 1)) {\n                    this.setUndefinedColumnWidth(collection);\n                }\n                var index = this.parent.getColumnIndexByField(collection[i].field) + this.parent.getIndentCount();\n                if (tWidth !== 0 && difference < tmWidth) {\n                    this.setWidth(collection[i].minWidth, index);\n                }\n                else if (tWidth !== 0 && difference > tmWidth) {\n                    this.setWidth('', index, true);\n                }\n            }\n        }\n    };\n    ColumnWidthService.prototype.setUndefinedColumnWidth = function (collection) {\n        for (var k = 0; k < collection.length; k++) {\n            if (k !== collection.length - 1) {\n                collection[k].width = 200;\n                this.setWidth(200, this.parent.getColumnIndexByField(collection[k].field));\n            }\n        }\n    };\n    ColumnWidthService.prototype.setColumnWidth = function (column, index, module) {\n        if (this.parent.getColumns().length < 1) {\n            return;\n        }\n        var columnIndex = isNullOrUndefined(index) ? this.parent.getNormalizedColumnIndex(column.uid) : index;\n        var cWidth = this.getWidth(column);\n        var tgridWidth = this.getTableWidth(this.parent.getColumns());\n        if (cWidth !== null) {\n            this.setWidth(cWidth, columnIndex);\n            if (this.parent.width !== 'auto' && this.parent.width.toString().indexOf('%') === -1) {\n                this.setMinwidthBycalculation(tgridWidth);\n            }\n            if ((this.parent.allowResizing && module === 'resize') || (this.parent.getFrozenColumns() && this.parent.allowResizing)) {\n                this.setWidthToTable();\n            }\n            this.parent.notify(columnWidthChanged, { index: columnIndex, width: cWidth, column: column, module: module });\n        }\n    };\n    ColumnWidthService.prototype.setWidth = function (width, index, clear) {\n        if (this.parent.groupSettings.columns.length > index && ispercentageWidth(this.parent)) {\n            var elementWidth = this.parent.element.offsetWidth;\n            width = (30 / elementWidth * 100).toFixed(1) + '%';\n        }\n        var header = this.parent.getHeaderTable();\n        var content = this.parent.getContentTable();\n        var fWidth = formatUnit(width);\n        var headerCol;\n        var frzCols = this.parent.getFrozenColumns();\n        var isDraggable = this.parent.isRowDragable();\n        frzCols = frzCols && isDraggable ? frzCols + 1 : frzCols;\n        var mHdr = this.parent.getHeaderContent().querySelector('.' + literals.movableHeader);\n        var mCont = this.parent.getContent().querySelector('.' + literals.movableContent);\n        var freezeLeft = this.parent.getFrozenLeftColumnsCount();\n        var freezeRight = this.parent.getFrozenRightColumnsCount();\n        var movableCount = this.parent.getMovableColumnsCount();\n        var isColFrozen = freezeLeft !== 0 || freezeRight !== 0;\n        if (frzCols && index >= frzCols) {\n            if (!mHdr || !mHdr.querySelector(literals.colGroup)) {\n                return;\n            }\n            headerCol = mHdr.querySelector(literals.colGroup).children[index - frzCols];\n        }\n        else if (this.parent.enableColumnVirtualization && frzCols && this.parent.contentModule.isXaxis()\n            && mHdr.scrollLeft > 0) {\n            var colGroup = mHdr.querySelector(literals.colGroup);\n            headerCol = colGroup.children[(colGroup.children.length - 1) - index];\n        }\n        else if (isColFrozen) {\n            var target = void 0;\n            if (freezeLeft && !freezeRight) {\n                index = isDraggable ? index - 1 : index;\n                target = index < freezeLeft ? header : mHdr;\n            }\n            else if (!freezeLeft && freezeRight) {\n                target = index >= movableCount ? header : mHdr;\n            }\n            else if (freezeLeft && freezeRight) {\n                index = isDraggable ? index - 1 : index;\n                var frHdr = this.parent.getFrozenRightHeader();\n                target = index < freezeLeft ? header : index < (freezeLeft + movableCount) ? mHdr : frHdr;\n            }\n            headerCol = this.getColumnLevelFrozenColgroup(index, freezeLeft, movableCount, target);\n            if (!headerCol) {\n                return;\n            }\n        }\n        else {\n            headerCol = header.querySelector(literals.colGroup).children[index];\n        }\n        if (headerCol && !clear) {\n            headerCol.style.width = fWidth;\n        }\n        else if (headerCol && clear) {\n            headerCol.style.width = '';\n        }\n        var contentCol;\n        if (frzCols && index >= frzCols) {\n            contentCol = this.parent.getContent().querySelector('.' + literals.movableContent)\n                .querySelector(literals.colGroup).children[index - frzCols];\n        }\n        else if (this.parent.enableColumnVirtualization && frzCols && this.parent.contentModule.isXaxis()\n            && mCont.scrollLeft > 0) {\n            var colGroup = this.parent.getContent().querySelector('.' + literals.movableContent)\n                .querySelector(literals.colGroup);\n            contentCol = colGroup.children[(colGroup.children.length - 1) - index];\n        }\n        else if (isColFrozen) {\n            var target = void 0;\n            if (freezeLeft && !freezeRight) {\n                target = index < freezeLeft ? content : mCont;\n            }\n            if (!freezeLeft && freezeRight) {\n                target = index >= movableCount ? content : mCont;\n            }\n            if (freezeLeft && freezeRight) {\n                var frCont = this.parent.getContent().querySelector('.e-frozen-right-content');\n                target = index < freezeLeft ? content : index < (freezeLeft + movableCount) ? mCont : frCont;\n            }\n            contentCol = this.getColumnLevelFrozenColgroup(index, freezeLeft, movableCount, target);\n        }\n        else {\n            contentCol = content.querySelector(literals.colGroup).children[index];\n        }\n        if (contentCol && !clear) {\n            contentCol.style.width = fWidth;\n        }\n        else if (contentCol && clear) {\n            contentCol.style.width = '';\n        }\n        if (!this.parent.enableColumnVirtualization) {\n            var edit = this.parent.element.querySelectorAll('.e-table.e-inline-edit');\n            var editTableCol = [];\n            for (var i = 0; i < edit.length; i++) {\n                if (parentsUntil(edit[i], 'e-grid').id === this.parent.element.id) {\n                    for (var j = 0; j < edit[i].querySelector('colgroup').children.length; j++) {\n                        editTableCol.push(edit[i].querySelector('colgroup').children[j]);\n                    }\n                }\n            }\n            if (edit.length && editTableCol.length) {\n                editTableCol[index].style.width = fWidth;\n            }\n        }\n        if (this.parent.isFrozenGrid()) {\n            this.refreshFrozenScrollbar();\n        }\n    };\n    ColumnWidthService.prototype.getColumnLevelFrozenColgroup = function (index, left, movable, ele) {\n        if (!ele || !ele.querySelector(literals.colGroup)) {\n            return null;\n        }\n        var columns = this.parent.getColumns();\n        var isDrag = this.parent.isRowDragable();\n        var frzMode = this.parent.getFrozenMode();\n        var headerCol;\n        var colGroup = [].slice.call(ele.querySelector(literals.colGroup).children);\n        if (frzMode === 'Right' && isDrag && index === (movable + this.parent.getFrozenRightColumnsCount())) {\n            headerCol = colGroup[colGroup.length - 1];\n        }\n        else if (isDrag && index === -1) {\n            headerCol = colGroup[0];\n        }\n        else if (columns[index].freeze === 'Left') {\n            headerCol = colGroup[isDrag ? (index + 1) : index];\n        }\n        else if (columns[index].freeze === 'Right') {\n            headerCol = colGroup[index - (left + movable)];\n        }\n        else {\n            headerCol = colGroup[index - left];\n        }\n        return headerCol;\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    ColumnWidthService.prototype.refreshFrozenScrollbar = function () {\n        var args = { cancel: false };\n        this.parent.notify(preventFrozenScrollRefresh, args);\n        if (args.cancel) {\n            return;\n        }\n        var scrollWidth = getScrollBarWidth();\n        var frozenScrollbar = this.parent.element.querySelector('.e-frozenscrollbar');\n        var movableScrollbar = this.parent.element.querySelector('.e-movablescrollbar');\n        var frozencontent = this.parent.getContent().querySelector('.' + literals.frozenContent);\n        var movableContent = this.parent.getContent().querySelector('.' + literals.movableContent);\n        var frozenWidth = frozencontent.firstElementChild.getBoundingClientRect().width;\n        var movableWidth = movableContent.firstElementChild.getBoundingClientRect().width;\n        if (this.parent.getFrozenMode() === 'Right') {\n            frozenWidth = frozenWidth + scrollWidth;\n        }\n        frozenScrollbar.style.width = frozenWidth + 'px';\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n            var frozenRightScrollbar = this.parent.element.querySelector('.e-frozen-right-scrollbar');\n            var frozenRightWidth = this.parent.getContent().querySelector('.e-frozen-right-content')\n                .firstElementChild.getBoundingClientRect().width;\n            if (this.parent.height !== 'auto') {\n                frozenRightWidth = frozenRightWidth + scrollWidth;\n            }\n            frozenRightScrollbar.style.width = frozenRightWidth + 'px';\n        }\n        else {\n            if (this.parent.enableColumnVirtualization) {\n                var placeHolder = this.parent.getMovableVirtualContent().querySelector('.e-virtualtrack');\n                if (placeHolder) {\n                    movableWidth = placeHolder.scrollWidth;\n                }\n            }\n            if (this.parent.getFrozenMode() !== 'Right' && this.parent.height !== 'auto') {\n                movableWidth = movableWidth + scrollWidth;\n            }\n        }\n        movableScrollbar.firstElementChild.style.width = movableWidth + 'px';\n    };\n    ColumnWidthService.prototype.getSiblingsHeight = function (element) {\n        var previous = this.getHeightFromDirection(element, 'previous');\n        var next = this.getHeightFromDirection(element, 'next');\n        return previous + next;\n    };\n    ColumnWidthService.prototype.getHeightFromDirection = function (element, direction) {\n        var sibling = element[direction + 'ElementSibling'];\n        var result = 0;\n        var classList = [literals.gridHeader, literals.gridFooter, 'e-groupdroparea', 'e-gridpager', 'e-toolbar'];\n        while (sibling) {\n            if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n                result += sibling.offsetHeight;\n            }\n            sibling = sibling[direction + 'ElementSibling'];\n        }\n        return result;\n    };\n    ColumnWidthService.prototype.isWidthUndefined = function () {\n        var isWidUndefCount = this.parent.getColumns().filter(function (col) {\n            return isNullOrUndefined(col.width) && isNullOrUndefined(col.minWidth);\n        }).length;\n        return (this.parent.getColumns().length === isWidUndefCount);\n    };\n    ColumnWidthService.prototype.getWidth = function (column) {\n        if (isNullOrUndefined(column.width) && this.parent.allowResizing\n            && isNullOrUndefined(column.minWidth) && !this.isWidthUndefined()) {\n            column.width = 200;\n        }\n        if (this.parent.isFrozenGrid() && isNullOrUndefined(column.width) &&\n            (column.getFreezeTableName() === literals.frozenLeft || column.getFreezeTableName() === literals.frozenRight)) {\n            column.width = 200;\n        }\n        if (!column.width) {\n            return null;\n        }\n        var width = parseInt(column.width.toString(), 10);\n        if (column.minWidth && width < parseInt(column.minWidth.toString(), 10)) {\n            return column.minWidth;\n        }\n        else if ((column.maxWidth && width > parseInt(column.maxWidth.toString(), 10))) {\n            return column.maxWidth;\n        }\n        else {\n            return column.width;\n        }\n    };\n    ColumnWidthService.prototype.getTableWidth = function (columns) {\n        var tWidth = 0;\n        for (var _i = 0, columns_1 = columns; _i < columns_1.length; _i++) {\n            var column = columns_1[_i];\n            var cWidth = this.getWidth(column);\n            if (column.width === 'auto') {\n                cWidth = 0;\n            }\n            if (column.visible !== false && cWidth !== null) {\n                tWidth += parseInt(cWidth.toString(), 10);\n            }\n        }\n        return tWidth;\n    };\n    ColumnWidthService.prototype.calcMovableOrFreezeColWidth = function (tableType) {\n        var columns = this.parent.getColumns().slice();\n        var left = this.parent.getFrozenLeftColumnsCount() || this.parent.getFrozenColumns();\n        var movable = this.parent.getMovableColumnsCount();\n        var right = this.parent.getFrozenRightColumnsCount();\n        if (tableType === 'movable') {\n            if (right) {\n                columns.splice(left + movable, columns.length);\n            }\n            if (left) {\n                columns.splice(0, left);\n            }\n        }\n        else if (tableType === 'freeze-left') {\n            columns.splice(left, columns.length);\n        }\n        else if (tableType === 'freeze-right') {\n            columns.splice(0, left + movable);\n        }\n        return formatUnit(this.getTableWidth(columns));\n    };\n    ColumnWidthService.prototype.setWidthToFrozenRightTable = function () {\n        var freezeWidth = this.calcMovableOrFreezeColWidth('freeze-right');\n        freezeWidth = this.isAutoResize() ? '100%' : freezeWidth;\n        var headerTbl = this.parent.getHeaderContent().querySelector('.e-frozen-right-header').querySelector('.' + literals.table);\n        var cntTbl = this.parent.getContent().querySelector('.e-frozen-right-content').querySelector('.' + literals.table);\n        headerTbl.style.width = freezeWidth;\n        cntTbl.style.width = freezeWidth;\n    };\n    ColumnWidthService.prototype.setWidthToFrozenLeftTable = function () {\n        var freezeWidth = this.calcMovableOrFreezeColWidth('freeze-left');\n        freezeWidth = this.isAutoResize() ? '100%' : freezeWidth;\n        this.parent.getHeaderTable().style.width = freezeWidth;\n        this.parent.getContentTable().style.width = freezeWidth;\n    };\n    ColumnWidthService.prototype.setWidthToMovableTable = function () {\n        var movableWidth = '';\n        var isColUndefined = this.parent.getColumns().filter(function (a) { return isNullOrUndefined(a.width); }).length >= 1;\n        var isWidthAuto = this.parent.getColumns().filter(function (a) { return (a.width === 'auto'); }).length >= 1;\n        if (typeof this.parent.width === 'number' && !isColUndefined && !isWidthAuto) {\n            movableWidth = formatUnit(this.parent.width - parseInt(this.calcMovableOrFreezeColWidth('freeze').split('px')[0], 10) - 5);\n        }\n        else if (!isColUndefined && !isWidthAuto) {\n            movableWidth = this.calcMovableOrFreezeColWidth('movable');\n        }\n        movableWidth = this.isAutoResize() ? '100%' : movableWidth;\n        if (this.parent.getHeaderContent().querySelector('.' + literals.movableHeader).firstElementChild) {\n            this.parent.getHeaderContent().querySelector('.' + literals.movableHeader).firstElementChild.style.width\n                = movableWidth;\n        }\n        this.parent.getContent().querySelector('.' + literals.movableContent).firstElementChild.style.width =\n            movableWidth;\n    };\n    ColumnWidthService.prototype.setWidthToFrozenEditTable = function () {\n        var freezeWidth = this.calcMovableOrFreezeColWidth('freeze');\n        freezeWidth = this.isAutoResize() ? '100%' : freezeWidth;\n        this.parent.element.querySelectorAll('.e-table.e-inline-edit')[0].style.width = freezeWidth;\n    };\n    ColumnWidthService.prototype.setWidthToMovableEditTable = function () {\n        var movableWidth = this.calcMovableOrFreezeColWidth('movable');\n        movableWidth = this.isAutoResize() ? '100%' : movableWidth;\n        this.parent.element.querySelectorAll('.e-table.e-inline-edit')[1].style.width = movableWidth;\n    };\n    ColumnWidthService.prototype.setWidthToTable = function () {\n        var tWidth = formatUnit(this.getTableWidth(this.parent.getColumns()));\n        if (this.parent.isFrozenGrid()) {\n            if (this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount()) {\n                this.setWidthToFrozenLeftTable();\n            }\n            this.setWidthToMovableTable();\n            if (this.parent.getFrozenRightColumnsCount()) {\n                this.setWidthToFrozenRightTable();\n            }\n        }\n        else {\n            if (this.parent.detailTemplate || this.parent.childGrid) {\n                this.setColumnWidth(new Column({ width: '30px' }));\n            }\n            tWidth = this.isAutoResize() ? '100%' : tWidth;\n            this.parent.getHeaderTable().style.width = tWidth;\n            this.parent.getContentTable().style.width = tWidth;\n        }\n        var edit = this.parent.element.querySelector('.e-table.e-inline-edit');\n        if (edit && this.parent.getFrozenColumns()) {\n            this.setWidthToFrozenEditTable();\n            this.setWidthToMovableEditTable();\n        }\n        else if (edit) {\n            edit.style.width = tWidth;\n        }\n    };\n    ColumnWidthService.prototype.isAutoResize = function () {\n        return this.parent.allowResizing && this.parent.resizeSettings.mode === 'Auto';\n    };\n    return ColumnWidthService;\n}());\nexport { ColumnWidthService };\n"]},"metadata":{},"sourceType":"module"}