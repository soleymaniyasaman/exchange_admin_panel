{"ast":null,"code":"import { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined as isNOU, createElement, closest, KeyboardEvents } from '@syncfusion/ej2-base';\nimport { getValue, select } from '@syncfusion/ej2-base';\nimport { Download, GetDetails } from './../common/operations';\nimport { createDialog } from './dialog';\nimport { cutFiles, copyFiles, refresh, getPathObject, getLocaleText, updateLayout, getFullPath } from './../common/utility';\nimport { getCssClass, sortbyClickHandler, pasteHandler } from './../common/utility';\nimport { createDeniedDialog, createNewFolder, uploadItem, hasEditAccess, hasDownloadAccess } from './../common/utility';\nimport * as events from './../base/constant';\nimport * as CLS from '../base/classes';\n/**\n * ContextMenu module\n */\n\nvar ContextMenu =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the ContextMenu module\n   *\n   * @param {IFileManager} parent - Specifies the parent element.\n   * @hidden\n   */\n  function ContextMenu(parent) {\n    this.currentItems = [];\n    this.currentElement = null;\n    this.disabledItems = [];\n    this.parent = parent;\n    this.render();\n  }\n\n  ContextMenu.prototype.render = function () {\n    this.keyConfigs = {\n      downarrow: 'downarrow',\n      uparrow: 'uparrown'\n    };\n    this.contextMenu = new Menu({\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      target: '#' + this.parent.element.id,\n      enableHtmlSanitizer: this.parent.enableHtmlSanitizer,\n      beforeItemRender: this.onBeforeItemRender.bind(this),\n      select: this.onSelect.bind(this),\n      beforeOpen: this.onBeforeOpen.bind(this),\n      beforeClose: this.onBeforeClose.bind(this),\n      cssClass: getCssClass(this.parent, CLS.ROOT_POPUP)\n    });\n    this.contextMenu.isStringTemplate = true;\n    this.contextMenu.appendTo('#' + this.parent.element.id + CLS.CONTEXT_MENU_ID);\n    this.addEventListener();\n  };\n  /* istanbul ignore next */\n\n\n  ContextMenu.prototype.onBeforeItemRender = function (args) {\n    if (args.item.id === this.getMenuId('largeiconsview')) {\n      var iconSpan = createElement('span');\n      var element = args.element;\n      element.insertBefore(iconSpan, this.parent.view === 'LargeIcons' ? element.childNodes[1] : element.childNodes[0]);\n      iconSpan.setAttribute('class', CLS.ICON_LARGE + ' ' + CLS.MENU_ICON);\n    }\n\n    if (args.item.id === this.getMenuId('detailsview')) {\n      var iconSpan = createElement('span');\n      var element = args.element;\n      element.insertBefore(iconSpan, this.parent.view === 'Details' ? element.childNodes[1] : element.childNodes[0]);\n      iconSpan.setAttribute('class', CLS.ICON_GRID + ' ' + CLS.MENU_ICON);\n    }\n  };\n\n  ContextMenu.prototype.onBeforeClose = function () {\n    this.menuTarget = null;\n  };\n  /* istanbul ignore next */\n\n\n  ContextMenu.prototype.onBeforeOpen = function (args) {\n    var _this = this;\n\n    this.disabledItems = [];\n    var selected = false;\n    var uid; // eslint-disable-next-line\n\n    var data;\n    var treeFolder = false;\n    var target = args.event.target;\n    this.menuTarget = target;\n    this.currentElement = args.element;\n\n    if (target.classList.contains('e-spinner-pane')) {\n      target = this.parent.navigationpaneModule.activeNode.getElementsByClassName(CLS.FULLROW)[0];\n      this.menuTarget = target;\n    }\n\n    if (target.classList.contains(CLS.FULLROW)) {\n      this.parent.selectedItems.length = 0;\n    }\n\n    this.targetElement = this.parent.view === 'Details' ? closest(target, 'tr') : target;\n    var view = this.getTargetView(target);\n    this.updateActiveModule();\n    /* istanbul ignore next */\n\n    if (target.classList.contains(CLS.TREE_VIEW) || closest(target, 'th') || closest(target, '#' + this.parent.element.id + CLS.BREADCRUMBBAR_ID) || closest(target, '#' + this.parent.element.id + CLS.TOOLBAR_ID)) {\n      args.cancel = true; // eslint:disable-next-line\n    } else if (!(this.parent.view === 'LargeIcons') && this.targetElement && this.targetElement.classList.contains('e-emptyrow')) {\n      this.setLayoutItem(target);\n      /* istanbul ignore next */\n    } else if (closest(target, '.' + CLS.EMPTY)) {\n      this.setLayoutItem(target); // eslint:disable-next-line\n    } else if (!target.classList.contains(CLS.MENU_ITEM) && !target.classList.contains(CLS.MENU_ICON) && !target.classList.contains(CLS.SUBMENU_ICON)) {\n      /* istanbul ignore next */\n      // eslint:disable-next-line\n      if (this.parent.view === 'LargeIcons' && !isNOU(closest(target, 'li')) && !closest(target, '#' + this.parent.element.id + CLS.TREE_ID)) {\n        var eveArgs = {\n          ctrlKey: true,\n          shiftKey: true\n        };\n\n        if (!closest(target, 'li').classList.contains('e-active')) {\n          this.parent.largeiconsviewModule.doSelection(target, eveArgs);\n        } // eslint-disable-next-line\n\n\n        data = this.parent.visitedData;\n        selected = true;\n      } else if (!isNOU(closest(target, 'tr'))) {\n        uid = this.targetElement.getAttribute('data-uid'); // eslint-disable-next-line\n\n        data = this.parent.detailsviewModule.gridObj.getRowObjectFromUID(uid).data;\n\n        if (isNOU(this.targetElement.getAttribute('aria-selected'))) {\n          /* istanbul ignore next */\n          this.parent.detailsviewModule.gridObj.selectRows([parseInt(this.targetElement.getAttribute('aria-rowindex'), 10)]);\n        }\n\n        selected = true;\n        /* istanbul ignore next */\n      } else if (closest(target, '#' + this.parent.element.id + CLS.TREE_ID)) {\n        uid = closest(target, 'li').getAttribute('data-uid');\n        treeFolder = true;\n      }\n      /* istanbul ignore next */\n\n\n      if (selected) {\n        if (getValue('isFile', data) === true) {\n          this.setFileItem();\n        } else {\n          this.setFolderItem(false);\n        }\n        /* istanbul ignore next */\n\n      } else if (treeFolder) {\n        this.setFolderItem(true);\n\n        if (uid === this.parent.pathId[0]) {\n          this.disabledItems.push('Delete', 'Rename', 'Cut', 'Copy');\n        }\n        /* istanbul ignore next */\n        // eslint:disable-next-line\n\n      } else if (view === 'TreeView' || view === 'GridView' || view === 'LargeIcon') {\n        this.setLayoutItem(target);\n        /* istanbul ignore next */\n      } else {\n        args.cancel = true;\n      }\n    }\n\n    var pasteEle = select('#' + this.getMenuId('Paste'), this.contextMenu.element);\n\n    if (!args.cancel && !this.parent.enablePaste && pasteEle && !pasteEle.classList.contains('e-disabled')) {\n      this.disabledItems.push('Paste');\n    }\n\n    if (args.cancel) {\n      this.menuTarget = this.currentElement = null;\n      return;\n    }\n\n    this.contextMenu.dataBind();\n    var isSubMenu = false;\n\n    if (target.classList.contains(CLS.MENU_ITEM) || target.classList.contains(CLS.MENU_ICON) || target.classList.contains(CLS.SUBMENU_ICON)) {\n      isSubMenu = true;\n    }\n\n    this.menuItemData = isSubMenu ? this.menuItemData : this.getMenuItemData();\n    var eventArgs = {\n      fileDetails: [this.menuItemData],\n      element: args.element,\n      target: target,\n      items: isSubMenu ? args.items : this.contextMenu.items,\n      menuModule: this.contextMenu,\n      cancel: false,\n      menuType: this.menuType,\n      isSubMenu: isSubMenu\n    };\n    this.currentItems = eventArgs.items;\n    this.parent.trigger('menuOpen', eventArgs, function (menuOpenArgs) {\n      if (!isSubMenu) {\n        _this.contextMenu.dataBind();\n\n        _this.contextMenu.items = menuOpenArgs.items;\n\n        _this.contextMenu.dataBind();\n      }\n\n      _this.enableItems(_this.disabledItems, false, true);\n\n      args.cancel = menuOpenArgs.cancel;\n\n      if (menuOpenArgs.cancel) {\n        _this.menuTarget = _this.currentElement = null;\n      }\n    });\n  };\n\n  ContextMenu.prototype.updateActiveModule = function () {\n    this.parent.activeModule = closest(this.menuTarget, '#' + this.parent.element.id + CLS.TREE_ID) ? 'navigationpane' : closest(this.menuTarget, '#' + this.parent.element.id + CLS.GRID_ID) ? 'detailsview' : closest(this.menuTarget, '#' + this.parent.element.id + CLS.LARGEICON_ID) ? 'largeiconsview' : this.parent.activeModule;\n  };\n  /* istanbul ignore next */\n\n  /**\n   *\n   * @param {Element} target - specifies the target element.\n   * @returns {string} -returns the target view.\n   * @hidden\n   */\n\n\n  ContextMenu.prototype.getTargetView = function (target) {\n    return target.classList.contains(CLS.TREE_VIEW) ? 'TreeView' : target.classList.contains(CLS.GRID_VIEW) ? 'GridView' : target.classList.contains(CLS.ICON_VIEW) ? 'LargeIcon' : target.classList.contains(CLS.LARGE_ICONS) ? 'LargeIcon' : '';\n  };\n\n  ContextMenu.prototype.getItemIndex = function (item) {\n    var itemId = this.getMenuId(item);\n\n    for (var i = 0; i < this.currentItems.length; i++) {\n      if (this.currentItems[i].id === itemId || this.currentItems[i].id === item) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  ContextMenu.prototype.disableItem = function (items) {\n    if (items.length !== 0) {\n      this.disabledItems = this.disabledItems.concat(items);\n    }\n  };\n\n  ContextMenu.prototype.enableItems = function (items, enable, isUniqueId) {\n    for (var i = 0; i < items.length; i++) {\n      if (this.checkValidItem(items[i]) === 1) {\n        this.contextMenu.enableItems([this.getMenuId(items[i])], enable, isUniqueId);\n      } else if (this.checkValidItem(items[i]) === 2) {\n        this.contextMenu.enableItems([items[i]], enable, isUniqueId);\n      }\n    }\n  };\n\n  ContextMenu.prototype.setFolderItem = function (isTree) {\n    this.menuType = 'folder';\n    this.contextMenu.items = this.getItemData(this.parent.contextMenuSettings.folder.map(function (item) {\n      return item.trim();\n    }));\n    this.contextMenu.dataBind();\n\n    if (isTree) {\n      this.disabledItems.push('Open');\n    } else if (this.parent.selectedItems.length !== 1) {\n      this.disabledItems.push('Rename', 'Paste');\n    }\n  };\n\n  ContextMenu.prototype.setFileItem = function () {\n    this.menuType = 'file';\n    this.contextMenu.items = this.getItemData(this.parent.contextMenuSettings.file.map(function (item) {\n      return item.trim();\n    }));\n    this.contextMenu.dataBind();\n\n    if (this.parent.selectedItems.length !== 1) {\n      this.disabledItems.push('Rename');\n    }\n  };\n\n  ContextMenu.prototype.setLayoutItem = function (target) {\n    this.menuType = 'layout';\n    this.contextMenu.items = this.getItemData(this.parent.contextMenuSettings.layout.map(function (item) {\n      return item.trim();\n    }));\n    this.contextMenu.dataBind();\n\n    if (!this.parent.allowMultiSelection || this.parent.view === 'LargeIcons' && closest(target, '#' + this.parent.element.id + CLS.LARGEICON_ID).getElementsByClassName(CLS.EMPTY).length !== 0 || this.parent.view === 'Details' && closest(target, '#' + this.parent.element.id + CLS.GRID_ID).getElementsByClassName(CLS.EMPTY).length !== 0) {\n      this.disabledItems.push('SelectAll');\n    }\n\n    if (this.parent.selectedNodes.length === 0) {\n      this.disabledItems.push('Paste');\n    }\n\n    this.contextMenu.dataBind();\n  };\n\n  ContextMenu.prototype.checkValidItem = function (nameEle) {\n    if (!isNOU(select('#' + this.getMenuId(nameEle), this.currentElement))) {\n      return 1;\n    } else if (!isNOU(select('#' + nameEle, this.currentElement))) {\n      return 2;\n    } else {\n      return -1;\n    }\n  }; // eslint-disable-next-line\n\n\n  ContextMenu.prototype.getMenuItemData = function () {\n    if (this.menuType === 'layout') {\n      return getPathObject(this.parent);\n    } else {\n      // eslint-disable-next-line\n      var args = {\n        target: this.menuTarget\n      };\n      this.parent.notify(events.menuItemData, args);\n      return this.parent.itemData[0];\n    }\n  };\n  /* istanbul ignore next */\n\n\n  ContextMenu.prototype.onSelect = function (args) {\n    var _this = this;\n\n    if (isNOU(args.item) || !args.item.id) {\n      return;\n    }\n\n    var itemText = args.item.id.substr((this.parent.element.id + '_cm_').length); // eslint-disable-next-line\n\n    var details;\n\n    if (itemText === 'refresh' || itemText === 'newfolder' || itemText === 'upload') {\n      details = [getPathObject(this.parent)];\n      this.parent.itemData = details;\n    } else {\n      this.parent.notify(events.selectedData, {});\n      details = this.parent.itemData;\n    }\n\n    var eventArgs = {\n      cancel: false,\n      element: args.element,\n      fileDetails: details,\n      item: args.item\n    };\n    this.parent.trigger('menuClick', eventArgs, function (menuClickArgs) {\n      var sItems;\n\n      if (!menuClickArgs.cancel) {\n        // eslint:disable-next-line\n        switch (itemText) {\n          case 'cut':\n            cutFiles(_this.parent);\n            break;\n\n          case 'copy':\n            copyFiles(_this.parent);\n            break;\n\n          case 'paste':\n            if (_this.menuType === 'folder') {\n              if (_this.parent.activeModule === 'largeiconsview' || _this.parent.activeModule === 'detailsview') {\n                _this.parent.folderPath = getFullPath(_this.parent, _this.menuItemData, _this.parent.path);\n              } else {\n                _this.parent.folderPath = '';\n              }\n            } else {\n              _this.parent.folderPath = '';\n            }\n\n            pasteHandler(_this.parent);\n            break;\n\n          case 'delete':\n            for (var j = 0; j < details.length; j++) {\n              if (!hasEditAccess(details[j])) {\n                createDeniedDialog(_this.parent, details[j], events.permissionEdit);\n                return;\n              }\n            }\n\n            createDialog(_this.parent, 'Delete');\n            break;\n\n          /* istanbul ignore next */\n\n          case 'download':\n            for (var i = 0; i < details.length; i++) {\n              if (!hasDownloadAccess(details[i])) {\n                createDeniedDialog(_this.parent, details[i], events.permissionDownload);\n                return;\n              }\n            }\n\n            if (_this.parent.activeModule === 'navigationpane') {\n              _this.parent.notify(events.downloadInit, {});\n            } else if (_this.parent.selectedItems.length > 0) {\n              Download(_this.parent, _this.parent.path, _this.parent.selectedItems);\n            }\n\n            break;\n\n          case 'rename':\n            if (!hasEditAccess(details[0])) {\n              createDeniedDialog(_this.parent, details[0], events.permissionEdit);\n            } else {\n              _this.parent.notify(events.renameInit, {});\n\n              createDialog(_this.parent, 'Rename');\n            }\n\n            break;\n\n          case 'selectall':\n            /* istanbul ignore next */\n            _this.parent.notify(events.selectAllInit, {});\n\n            break;\n\n          case 'refresh':\n            refresh(_this.parent);\n            break;\n\n          case 'open':\n            if (_this.parent.visitedItem) {\n              _this.parent.notify(events.openInit, {\n                target: _this.parent.visitedItem\n              });\n            }\n\n            break;\n\n          case 'details':\n            _this.parent.notify(events.detailsInit, {});\n\n            sItems = _this.parent.selectedItems;\n\n            if (_this.parent.activeModule === 'navigationpane') {\n              sItems = [];\n            }\n\n            GetDetails(_this.parent, sItems, _this.parent.path, 'details');\n            break;\n\n          case 'newfolder':\n            createNewFolder(_this.parent);\n            break;\n\n          case 'upload':\n            uploadItem(_this.parent);\n            break;\n\n          /* istanbul ignore next */\n\n          case 'name':\n          /* istanbul ignore next */\n          // eslint-disable-next-line no-fallthrough\n\n          case 'size':\n          /* istanbul ignore next */\n          // eslint-disable-next-line no-fallthrough\n\n          case 'date':\n          /* istanbul ignore next */\n          // eslint-disable-next-line no-fallthrough\n\n          case 'ascending':\n          /* istanbul ignore next */\n          // eslint-disable-next-line no-fallthrough\n\n          case 'descending':\n            /* istanbul ignore next */\n            sortbyClickHandler(_this.parent, args);\n            break;\n\n          /* istanbul ignore next */\n\n          case 'none':\n            /* istanbul ignore next */\n            sortbyClickHandler(_this.parent, args);\n            break;\n\n          /* istanbul ignore next */\n          // eslint:disable-next-line\n\n          case 'largeiconsview':\n            updateLayout(_this.parent, 'LargeIcons');\n            break;\n\n          /* istanbul ignore next */\n          // eslint:disable-next-line\n\n          case 'detailsview':\n            updateLayout(_this.parent, 'Details');\n            break;\n        }\n      }\n    });\n  };\n\n  ContextMenu.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName() && e.module !== 'common') {\n      /* istanbul ignore next */\n      return;\n    }\n\n    for (var _i = 0, _a = Object.keys(e.newProp); _i < _a.length; _i++) {\n      var prop = _a[_i];\n\n      switch (prop) {\n        case 'cssClass':\n          this.contextMenu.cssClass = getCssClass(this.parent, CLS.ROOT_POPUP);\n          break;\n      }\n    }\n  };\n\n  ContextMenu.prototype.addEventListener = function () {\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n    this.keyboardModule = new KeyboardEvents(this.contextMenu.element, {\n      keyAction: this.keyActionHandler.bind(this),\n      keyConfigs: this.keyConfigs,\n      eventName: 'keydown'\n    });\n  };\n\n  ContextMenu.prototype.removeEventListener = function () {\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n    this.keyboardModule.destroy();\n  };\n\n  ContextMenu.prototype.keyActionHandler = function (e) {\n    switch (e.action) {\n      case 'uparrow':\n      case 'downarrow':\n        e.preventDefault();\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} - returns the module name.\n   * @private\n   */\n\n\n  ContextMenu.prototype.getModuleName = function () {\n    return 'contextmenu';\n  };\n\n  ContextMenu.prototype.destroy = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.removeEventListener();\n    this.contextMenu.destroy();\n  };\n  /* istanbul ignore next */\n\n\n  ContextMenu.prototype.getItemData = function (data) {\n    var items = [];\n\n    for (var i = 0; i < data.length; i++) {\n      var item = void 0;\n      var itemId = this.getMenuId(data[i]);\n      var itemText = getLocaleText(this.parent, data[i]);\n\n      switch (data[i]) {\n        case '|':\n          item = {\n            separator: true\n          };\n          break;\n\n        case 'Open':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_OPEN\n          };\n          break;\n\n        case 'Upload':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_UPLOAD\n          };\n          break;\n\n        case 'Cut':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_CUT\n          };\n          break;\n\n        case 'Copy':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_COPY\n          };\n          break;\n\n        case 'Paste':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_PASTE\n          };\n          break;\n\n        case 'Delete':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_DELETE\n          };\n          break;\n\n        case 'Rename':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_RENAME\n          };\n          break;\n\n        case 'NewFolder':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_NEWFOLDER\n          };\n          break;\n\n        case 'Details':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_DETAILS\n          };\n          break;\n\n        case 'SortBy':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_SHORTBY,\n            items: [{\n              id: this.getMenuId('Name'),\n              text: getLocaleText(this.parent, 'Name'),\n              iconCss: this.parent.sortBy === 'name' ? CLS.TB_OPTION_DOT : null\n            }, {\n              id: this.getMenuId('Size'),\n              text: getLocaleText(this.parent, 'Size'),\n              iconCss: this.parent.sortBy === 'size' ? CLS.TB_OPTION_DOT : null\n            }, {\n              id: this.getMenuId('Date'),\n              text: getLocaleText(this.parent, 'DateModified'),\n              iconCss: this.parent.sortBy === '_fm_modified' ? CLS.TB_OPTION_DOT : null\n            }, {\n              separator: true\n            }, {\n              id: this.getMenuId('Ascending'),\n              text: getLocaleText(this.parent, 'Ascending'),\n              iconCss: this.parent.sortOrder === 'Ascending' ? CLS.TB_OPTION_TICK : null\n            }, {\n              id: this.getMenuId('Descending'),\n              text: getLocaleText(this.parent, 'Descending'),\n              iconCss: this.parent.sortOrder === 'Descending' ? CLS.TB_OPTION_TICK : null\n            }, {\n              id: this.getMenuId('None'),\n              text: getLocaleText(this.parent, 'None'),\n              iconCss: this.parent.sortOrder === 'None' ? CLS.TB_OPTION_TICK : null\n            }]\n          };\n          break;\n\n        /* istanbul ignore next */\n\n        case 'View':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: this.parent.view === 'Details' ? CLS.ICON_GRID : CLS.ICON_LARGE,\n            items: [{\n              id: this.getMenuId('largeiconsview'),\n              text: getLocaleText(this.parent, 'View-LargeIcons'),\n              iconCss: this.parent.view === 'Details' ? null : CLS.TB_OPTION_TICK\n            }, {\n              id: this.getMenuId('detailsview'),\n              text: getLocaleText(this.parent, 'View-Details'),\n              iconCss: this.parent.view === 'Details' ? CLS.TB_OPTION_TICK : null\n            }]\n          };\n          break;\n\n        case 'Refresh':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_REFRESH\n          };\n          break;\n\n        case 'SelectAll':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_SELECTALL\n          };\n          break;\n\n        /* istanbul ignore next */\n\n        case 'Download':\n          item = {\n            id: itemId,\n            text: itemText,\n            iconCss: CLS.ICON_DOWNLOAD\n          };\n          break;\n\n        /* istanbul ignore next */\n\n        default:\n          item = {\n            id: itemId,\n            text: itemText\n          };\n          break;\n      }\n\n      items.push(item);\n    }\n\n    return items;\n  };\n\n  ContextMenu.prototype.getMenuId = function (id) {\n    return this.parent.element.id + '_cm_' + id.toLowerCase();\n  };\n\n  return ContextMenu;\n}();\n\nexport { ContextMenu };","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/@syncfusion/ej2-filemanager/src/file-manager/pop-up/context-menu.js"],"names":["ContextMenu","Menu","isNullOrUndefined","isNOU","createElement","closest","KeyboardEvents","getValue","select","Download","GetDetails","createDialog","cutFiles","copyFiles","refresh","getPathObject","getLocaleText","updateLayout","getFullPath","getCssClass","sortbyClickHandler","pasteHandler","createDeniedDialog","createNewFolder","uploadItem","hasEditAccess","hasDownloadAccess","events","CLS","parent","currentItems","currentElement","disabledItems","render","prototype","keyConfigs","downarrow","uparrow","contextMenu","enableRtl","locale","target","element","id","enableHtmlSanitizer","beforeItemRender","onBeforeItemRender","bind","onSelect","beforeOpen","onBeforeOpen","beforeClose","onBeforeClose","cssClass","ROOT_POPUP","isStringTemplate","appendTo","CONTEXT_MENU_ID","addEventListener","args","item","getMenuId","iconSpan","insertBefore","view","childNodes","setAttribute","ICON_LARGE","MENU_ICON","ICON_GRID","menuTarget","_this","selected","uid","data","treeFolder","event","classList","contains","navigationpaneModule","activeNode","getElementsByClassName","FULLROW","selectedItems","length","targetElement","getTargetView","updateActiveModule","TREE_VIEW","BREADCRUMBBAR_ID","TOOLBAR_ID","cancel","setLayoutItem","EMPTY","MENU_ITEM","SUBMENU_ICON","TREE_ID","eveArgs","ctrlKey","shiftKey","largeiconsviewModule","doSelection","visitedData","getAttribute","detailsviewModule","gridObj","getRowObjectFromUID","selectRows","parseInt","setFileItem","setFolderItem","pathId","push","pasteEle","enablePaste","dataBind","isSubMenu","menuItemData","getMenuItemData","eventArgs","fileDetails","items","menuModule","menuType","trigger","menuOpenArgs","enableItems","activeModule","GRID_ID","LARGEICON_ID","GRID_VIEW","ICON_VIEW","LARGE_ICONS","getItemIndex","itemId","i","disableItem","concat","enable","isUniqueId","checkValidItem","isTree","getItemData","contextMenuSettings","folder","map","trim","file","layout","allowMultiSelection","selectedNodes","nameEle","notify","itemData","itemText","substr","details","selectedData","menuClickArgs","sItems","folderPath","path","j","permissionEdit","permissionDownload","downloadInit","renameInit","selectAllInit","visitedItem","openInit","detailsInit","onPropertyChanged","e","module","getModuleName","_i","_a","Object","keys","newProp","prop","on","destroy","modelChanged","keyboardModule","keyAction","keyActionHandler","eventName","removeEventListener","off","action","preventDefault","isDestroyed","separator","text","iconCss","ICON_OPEN","ICON_UPLOAD","ICON_CUT","ICON_COPY","ICON_PASTE","ICON_DELETE","ICON_RENAME","ICON_NEWFOLDER","ICON_DETAILS","ICON_SHORTBY","sortBy","TB_OPTION_DOT","sortOrder","TB_OPTION_TICK","ICON_REFRESH","ICON_SELECTALL","ICON_DOWNLOAD","toLowerCase"],"mappings":"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","sourcesContent":["import { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined as isNOU, createElement, closest, KeyboardEvents } from '@syncfusion/ej2-base';\nimport { getValue, select } from '@syncfusion/ej2-base';\nimport { Download, GetDetails } from './../common/operations';\nimport { createDialog } from './dialog';\nimport { cutFiles, copyFiles, refresh, getPathObject, getLocaleText, updateLayout, getFullPath } from './../common/utility';\nimport { getCssClass, sortbyClickHandler, pasteHandler } from './../common/utility';\nimport { createDeniedDialog, createNewFolder, uploadItem, hasEditAccess, hasDownloadAccess } from './../common/utility';\nimport * as events from './../base/constant';\nimport * as CLS from '../base/classes';\n/**\n * ContextMenu module\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for the ContextMenu module\n     *\n     * @param {IFileManager} parent - Specifies the parent element.\n     * @hidden\n     */\n    function ContextMenu(parent) {\n        this.currentItems = [];\n        this.currentElement = null;\n        this.disabledItems = [];\n        this.parent = parent;\n        this.render();\n    }\n    ContextMenu.prototype.render = function () {\n        this.keyConfigs = {\n            downarrow: 'downarrow',\n            uparrow: 'uparrown'\n        };\n        this.contextMenu = new Menu({\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            target: '#' + this.parent.element.id,\n            enableHtmlSanitizer: this.parent.enableHtmlSanitizer,\n            beforeItemRender: this.onBeforeItemRender.bind(this),\n            select: this.onSelect.bind(this),\n            beforeOpen: this.onBeforeOpen.bind(this),\n            beforeClose: this.onBeforeClose.bind(this),\n            cssClass: getCssClass(this.parent, CLS.ROOT_POPUP)\n        });\n        this.contextMenu.isStringTemplate = true;\n        this.contextMenu.appendTo('#' + this.parent.element.id + CLS.CONTEXT_MENU_ID);\n        this.addEventListener();\n    };\n    /* istanbul ignore next */\n    ContextMenu.prototype.onBeforeItemRender = function (args) {\n        if (args.item.id === this.getMenuId('largeiconsview')) {\n            var iconSpan = createElement('span');\n            var element = args.element;\n            element.insertBefore(iconSpan, this.parent.view === 'LargeIcons' ? element.childNodes[1] : element.childNodes[0]);\n            iconSpan.setAttribute('class', CLS.ICON_LARGE + ' ' + CLS.MENU_ICON);\n        }\n        if (args.item.id === this.getMenuId('detailsview')) {\n            var iconSpan = createElement('span');\n            var element = args.element;\n            element.insertBefore(iconSpan, this.parent.view === 'Details' ? element.childNodes[1] : element.childNodes[0]);\n            iconSpan.setAttribute('class', CLS.ICON_GRID + ' ' + CLS.MENU_ICON);\n        }\n    };\n    ContextMenu.prototype.onBeforeClose = function () {\n        this.menuTarget = null;\n    };\n    /* istanbul ignore next */\n    ContextMenu.prototype.onBeforeOpen = function (args) {\n        var _this = this;\n        this.disabledItems = [];\n        var selected = false;\n        var uid;\n        // eslint-disable-next-line\n        var data;\n        var treeFolder = false;\n        var target = args.event.target;\n        this.menuTarget = target;\n        this.currentElement = args.element;\n        if (target.classList.contains('e-spinner-pane')) {\n            target = this.parent.navigationpaneModule.activeNode.getElementsByClassName(CLS.FULLROW)[0];\n            this.menuTarget = target;\n        }\n        if (target.classList.contains(CLS.FULLROW)) {\n            this.parent.selectedItems.length = 0;\n        }\n        this.targetElement = this.parent.view === 'Details' ? closest(target, 'tr') : target;\n        var view = this.getTargetView(target);\n        this.updateActiveModule();\n        /* istanbul ignore next */\n        if (target.classList.contains(CLS.TREE_VIEW) || closest(target, 'th') ||\n            (closest(target, '#' + this.parent.element.id + CLS.BREADCRUMBBAR_ID)) ||\n            (closest(target, '#' + this.parent.element.id + CLS.TOOLBAR_ID))) {\n            args.cancel = true;\n            // eslint:disable-next-line\n        }\n        else if (!(this.parent.view === 'LargeIcons') && this.targetElement &&\n            this.targetElement.classList.contains('e-emptyrow')) {\n            this.setLayoutItem(target);\n            /* istanbul ignore next */\n        }\n        else if (closest(target, '.' + CLS.EMPTY)) {\n            this.setLayoutItem(target);\n            // eslint:disable-next-line\n        }\n        else if (!target.classList.contains(CLS.MENU_ITEM) &&\n            !target.classList.contains(CLS.MENU_ICON) && !target.classList.contains(CLS.SUBMENU_ICON)) {\n            /* istanbul ignore next */\n            // eslint:disable-next-line\n            if (this.parent.view === 'LargeIcons' && !isNOU(closest(target, 'li')) && !closest(target, '#' + this.parent.element.id + CLS.TREE_ID)) {\n                var eveArgs = { ctrlKey: true, shiftKey: true };\n                if (!closest(target, 'li').classList.contains('e-active')) {\n                    this.parent.largeiconsviewModule.doSelection(target, eveArgs);\n                }\n                // eslint-disable-next-line\n                data = this.parent.visitedData;\n                selected = true;\n            }\n            else if (!isNOU(closest(target, 'tr'))) {\n                uid = this.targetElement.getAttribute('data-uid');\n                // eslint-disable-next-line\n                data = this.parent.detailsviewModule.gridObj.getRowObjectFromUID(uid).data;\n                if (isNOU(this.targetElement.getAttribute('aria-selected'))) {\n                    /* istanbul ignore next */\n                    this.parent.detailsviewModule.gridObj.selectRows([parseInt(this.targetElement.getAttribute('aria-rowindex'), 10)]);\n                }\n                selected = true;\n                /* istanbul ignore next */\n            }\n            else if (closest(target, '#' + this.parent.element.id + CLS.TREE_ID)) {\n                uid = closest(target, 'li').getAttribute('data-uid');\n                treeFolder = true;\n            }\n            /* istanbul ignore next */\n            if (selected) {\n                if (getValue('isFile', data) === true) {\n                    this.setFileItem();\n                }\n                else {\n                    this.setFolderItem(false);\n                }\n                /* istanbul ignore next */\n            }\n            else if (treeFolder) {\n                this.setFolderItem(true);\n                if (uid === this.parent.pathId[0]) {\n                    this.disabledItems.push('Delete', 'Rename', 'Cut', 'Copy');\n                }\n                /* istanbul ignore next */\n                // eslint:disable-next-line\n            }\n            else if (view === 'TreeView' || view === 'GridView' || view === 'LargeIcon') {\n                this.setLayoutItem(target);\n                /* istanbul ignore next */\n            }\n            else {\n                args.cancel = true;\n            }\n        }\n        var pasteEle = select('#' + this.getMenuId('Paste'), this.contextMenu.element);\n        if (!args.cancel && !this.parent.enablePaste &&\n            pasteEle && !pasteEle.classList.contains('e-disabled')) {\n            this.disabledItems.push('Paste');\n        }\n        if (args.cancel) {\n            this.menuTarget = this.currentElement = null;\n            return;\n        }\n        this.contextMenu.dataBind();\n        var isSubMenu = false;\n        if (target.classList.contains(CLS.MENU_ITEM) ||\n            target.classList.contains(CLS.MENU_ICON) || target.classList.contains(CLS.SUBMENU_ICON)) {\n            isSubMenu = true;\n        }\n        this.menuItemData = isSubMenu ? this.menuItemData : this.getMenuItemData();\n        var eventArgs = {\n            fileDetails: [this.menuItemData],\n            element: args.element,\n            target: target,\n            items: isSubMenu ? args.items : this.contextMenu.items,\n            menuModule: this.contextMenu,\n            cancel: false,\n            menuType: this.menuType,\n            isSubMenu: isSubMenu\n        };\n        this.currentItems = eventArgs.items;\n        this.parent.trigger('menuOpen', eventArgs, function (menuOpenArgs) {\n            if (!isSubMenu) {\n                _this.contextMenu.dataBind();\n                _this.contextMenu.items = menuOpenArgs.items;\n                _this.contextMenu.dataBind();\n            }\n            _this.enableItems(_this.disabledItems, false, true);\n            args.cancel = menuOpenArgs.cancel;\n            if (menuOpenArgs.cancel) {\n                _this.menuTarget = _this.currentElement = null;\n            }\n        });\n    };\n    ContextMenu.prototype.updateActiveModule = function () {\n        this.parent.activeModule = closest(this.menuTarget, '#' + this.parent.element.id + CLS.TREE_ID) ?\n            'navigationpane' : closest(this.menuTarget, '#' + this.parent.element.id + CLS.GRID_ID) ?\n            'detailsview' : closest(this.menuTarget, '#' + this.parent.element.id + CLS.LARGEICON_ID) ?\n            'largeiconsview' : this.parent.activeModule;\n    };\n    /* istanbul ignore next */\n    /**\n     *\n     * @param {Element} target - specifies the target element.\n     * @returns {string} -returns the target view.\n     * @hidden\n     */\n    ContextMenu.prototype.getTargetView = function (target) {\n        return target.classList.contains(CLS.TREE_VIEW) ?\n            'TreeView' : target.classList.contains(CLS.GRID_VIEW) ?\n            'GridView' : target.classList.contains(CLS.ICON_VIEW) ?\n            'LargeIcon' : target.classList.contains(CLS.LARGE_ICONS) ?\n            'LargeIcon' : '';\n    };\n    ContextMenu.prototype.getItemIndex = function (item) {\n        var itemId = this.getMenuId(item);\n        for (var i = 0; i < this.currentItems.length; i++) {\n            if ((this.currentItems[i].id === itemId) || (this.currentItems[i].id === item)) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    ContextMenu.prototype.disableItem = function (items) {\n        if (items.length !== 0) {\n            this.disabledItems = this.disabledItems.concat(items);\n        }\n    };\n    ContextMenu.prototype.enableItems = function (items, enable, isUniqueId) {\n        for (var i = 0; i < items.length; i++) {\n            if (this.checkValidItem(items[i]) === 1) {\n                this.contextMenu.enableItems([this.getMenuId(items[i])], enable, isUniqueId);\n            }\n            else if (this.checkValidItem(items[i]) === 2) {\n                this.contextMenu.enableItems([items[i]], enable, isUniqueId);\n            }\n        }\n    };\n    ContextMenu.prototype.setFolderItem = function (isTree) {\n        this.menuType = 'folder';\n        this.contextMenu.items = this.getItemData(this.parent.contextMenuSettings.folder.map(function (item) { return item.trim(); }));\n        this.contextMenu.dataBind();\n        if (isTree) {\n            this.disabledItems.push('Open');\n        }\n        else if (this.parent.selectedItems.length !== 1) {\n            this.disabledItems.push('Rename', 'Paste');\n        }\n    };\n    ContextMenu.prototype.setFileItem = function () {\n        this.menuType = 'file';\n        this.contextMenu.items = this.getItemData(this.parent.contextMenuSettings.file.map(function (item) { return item.trim(); }));\n        this.contextMenu.dataBind();\n        if (this.parent.selectedItems.length !== 1) {\n            this.disabledItems.push('Rename');\n        }\n    };\n    ContextMenu.prototype.setLayoutItem = function (target) {\n        this.menuType = 'layout';\n        this.contextMenu.items = this.getItemData(this.parent.contextMenuSettings.layout.map(function (item) { return item.trim(); }));\n        this.contextMenu.dataBind();\n        if (!this.parent.allowMultiSelection || ((this.parent.view === 'LargeIcons' &&\n            (closest(target, '#' + this.parent.element.id + CLS.LARGEICON_ID).getElementsByClassName(CLS.EMPTY).length !== 0))\n            || (this.parent.view === 'Details' &&\n                (closest(target, '#' + this.parent.element.id + CLS.GRID_ID).getElementsByClassName(CLS.EMPTY).length !== 0)))) {\n            this.disabledItems.push('SelectAll');\n        }\n        if (this.parent.selectedNodes.length === 0) {\n            this.disabledItems.push('Paste');\n        }\n        this.contextMenu.dataBind();\n    };\n    ContextMenu.prototype.checkValidItem = function (nameEle) {\n        if (!isNOU(select('#' + this.getMenuId(nameEle), this.currentElement))) {\n            return 1;\n        }\n        else if (!isNOU(select('#' + nameEle, this.currentElement))) {\n            return 2;\n        }\n        else {\n            return -1;\n        }\n    };\n    // eslint-disable-next-line\n    ContextMenu.prototype.getMenuItemData = function () {\n        if (this.menuType === 'layout') {\n            return getPathObject(this.parent);\n        }\n        else {\n            // eslint-disable-next-line\n            var args = { target: this.menuTarget };\n            this.parent.notify(events.menuItemData, args);\n            return this.parent.itemData[0];\n        }\n    };\n    /* istanbul ignore next */\n    ContextMenu.prototype.onSelect = function (args) {\n        var _this = this;\n        if (isNOU(args.item) || !args.item.id) {\n            return;\n        }\n        var itemText = args.item.id.substr((this.parent.element.id + '_cm_').length);\n        // eslint-disable-next-line\n        var details;\n        if (itemText === 'refresh' || itemText === 'newfolder' || itemText === 'upload') {\n            details = [getPathObject(this.parent)];\n            this.parent.itemData = details;\n        }\n        else {\n            this.parent.notify(events.selectedData, {});\n            details = this.parent.itemData;\n        }\n        var eventArgs = {\n            cancel: false,\n            element: args.element,\n            fileDetails: details,\n            item: args.item\n        };\n        this.parent.trigger('menuClick', eventArgs, function (menuClickArgs) {\n            var sItems;\n            if (!menuClickArgs.cancel) {\n                // eslint:disable-next-line\n                switch (itemText) {\n                    case 'cut':\n                        cutFiles(_this.parent);\n                        break;\n                    case 'copy':\n                        copyFiles(_this.parent);\n                        break;\n                    case 'paste':\n                        if (_this.menuType === 'folder') {\n                            if ((_this.parent.activeModule === 'largeiconsview') || (_this.parent.activeModule === 'detailsview')) {\n                                _this.parent.folderPath = getFullPath(_this.parent, _this.menuItemData, _this.parent.path);\n                            }\n                            else {\n                                _this.parent.folderPath = '';\n                            }\n                        }\n                        else {\n                            _this.parent.folderPath = '';\n                        }\n                        pasteHandler(_this.parent);\n                        break;\n                    case 'delete':\n                        for (var j = 0; j < details.length; j++) {\n                            if (!hasEditAccess(details[j])) {\n                                createDeniedDialog(_this.parent, details[j], events.permissionEdit);\n                                return;\n                            }\n                        }\n                        createDialog(_this.parent, 'Delete');\n                        break;\n                    /* istanbul ignore next */\n                    case 'download':\n                        for (var i = 0; i < details.length; i++) {\n                            if (!hasDownloadAccess(details[i])) {\n                                createDeniedDialog(_this.parent, details[i], events.permissionDownload);\n                                return;\n                            }\n                        }\n                        if (_this.parent.activeModule === 'navigationpane') {\n                            _this.parent.notify(events.downloadInit, {});\n                        }\n                        else if (_this.parent.selectedItems.length > 0) {\n                            Download(_this.parent, _this.parent.path, _this.parent.selectedItems);\n                        }\n                        break;\n                    case 'rename':\n                        if (!hasEditAccess(details[0])) {\n                            createDeniedDialog(_this.parent, details[0], events.permissionEdit);\n                        }\n                        else {\n                            _this.parent.notify(events.renameInit, {});\n                            createDialog(_this.parent, 'Rename');\n                        }\n                        break;\n                    case 'selectall':\n                        /* istanbul ignore next */\n                        _this.parent.notify(events.selectAllInit, {});\n                        break;\n                    case 'refresh':\n                        refresh(_this.parent);\n                        break;\n                    case 'open':\n                        if (_this.parent.visitedItem) {\n                            _this.parent.notify(events.openInit, { target: _this.parent.visitedItem });\n                        }\n                        break;\n                    case 'details':\n                        _this.parent.notify(events.detailsInit, {});\n                        sItems = _this.parent.selectedItems;\n                        if (_this.parent.activeModule === 'navigationpane') {\n                            sItems = [];\n                        }\n                        GetDetails(_this.parent, sItems, _this.parent.path, 'details');\n                        break;\n                    case 'newfolder':\n                        createNewFolder(_this.parent);\n                        break;\n                    case 'upload':\n                        uploadItem(_this.parent);\n                        break;\n                    /* istanbul ignore next */\n                    case 'name':\n                    /* istanbul ignore next */\n                    // eslint-disable-next-line no-fallthrough\n                    case 'size':\n                    /* istanbul ignore next */\n                    // eslint-disable-next-line no-fallthrough\n                    case 'date':\n                    /* istanbul ignore next */\n                    // eslint-disable-next-line no-fallthrough\n                    case 'ascending':\n                    /* istanbul ignore next */\n                    // eslint-disable-next-line no-fallthrough\n                    case 'descending':\n                        /* istanbul ignore next */\n                        sortbyClickHandler(_this.parent, args);\n                        break;\n                    /* istanbul ignore next */\n                    case 'none':\n                        /* istanbul ignore next */\n                        sortbyClickHandler(_this.parent, args);\n                        break;\n                    /* istanbul ignore next */\n                    // eslint:disable-next-line\n                    case 'largeiconsview':\n                        updateLayout(_this.parent, 'LargeIcons');\n                        break;\n                    /* istanbul ignore next */\n                    // eslint:disable-next-line\n                    case 'detailsview':\n                        updateLayout(_this.parent, 'Details');\n                        break;\n                }\n            }\n        });\n    };\n    ContextMenu.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName() && e.module !== 'common') {\n            /* istanbul ignore next */\n            return;\n        }\n        for (var _i = 0, _a = Object.keys(e.newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cssClass':\n                    this.contextMenu.cssClass = getCssClass(this.parent, CLS.ROOT_POPUP);\n                    break;\n            }\n        }\n    };\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n        this.keyboardModule = new KeyboardEvents(this.contextMenu.element, {\n            keyAction: this.keyActionHandler.bind(this),\n            keyConfigs: this.keyConfigs,\n            eventName: 'keydown'\n        });\n    };\n    ContextMenu.prototype.removeEventListener = function () {\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.modelChanged, this.onPropertyChanged);\n        this.keyboardModule.destroy();\n    };\n    ContextMenu.prototype.keyActionHandler = function (e) {\n        switch (e.action) {\n            case 'uparrow':\n            case 'downarrow':\n                e.preventDefault();\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} - returns the module name.\n     * @private\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextmenu';\n    };\n    ContextMenu.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n        this.contextMenu.destroy();\n    };\n    /* istanbul ignore next */\n    ContextMenu.prototype.getItemData = function (data) {\n        var items = [];\n        for (var i = 0; i < data.length; i++) {\n            var item = void 0;\n            var itemId = this.getMenuId(data[i]);\n            var itemText = getLocaleText(this.parent, data[i]);\n            switch (data[i]) {\n                case '|':\n                    item = { separator: true };\n                    break;\n                case 'Open':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_OPEN };\n                    break;\n                case 'Upload':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_UPLOAD };\n                    break;\n                case 'Cut':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_CUT };\n                    break;\n                case 'Copy':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_COPY };\n                    break;\n                case 'Paste':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_PASTE };\n                    break;\n                case 'Delete':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_DELETE };\n                    break;\n                case 'Rename':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_RENAME };\n                    break;\n                case 'NewFolder':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_NEWFOLDER };\n                    break;\n                case 'Details':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_DETAILS };\n                    break;\n                case 'SortBy':\n                    item = {\n                        id: itemId, text: itemText, iconCss: CLS.ICON_SHORTBY,\n                        items: [\n                            {\n                                id: this.getMenuId('Name'), text: getLocaleText(this.parent, 'Name'),\n                                iconCss: this.parent.sortBy === 'name' ? CLS.TB_OPTION_DOT : null\n                            },\n                            {\n                                id: this.getMenuId('Size'), text: getLocaleText(this.parent, 'Size'),\n                                iconCss: this.parent.sortBy === 'size' ? CLS.TB_OPTION_DOT : null\n                            },\n                            {\n                                id: this.getMenuId('Date'), text: getLocaleText(this.parent, 'DateModified'),\n                                iconCss: this.parent.sortBy === '_fm_modified' ? CLS.TB_OPTION_DOT : null\n                            },\n                            { separator: true },\n                            {\n                                id: this.getMenuId('Ascending'), text: getLocaleText(this.parent, 'Ascending'),\n                                iconCss: this.parent.sortOrder === 'Ascending' ? CLS.TB_OPTION_TICK : null\n                            },\n                            {\n                                id: this.getMenuId('Descending'), text: getLocaleText(this.parent, 'Descending'),\n                                iconCss: this.parent.sortOrder === 'Descending' ? CLS.TB_OPTION_TICK : null\n                            },\n                            {\n                                id: this.getMenuId('None'), text: getLocaleText(this.parent, 'None'),\n                                iconCss: this.parent.sortOrder === 'None' ? CLS.TB_OPTION_TICK : null\n                            }\n                        ]\n                    };\n                    break;\n                /* istanbul ignore next */\n                case 'View':\n                    item = {\n                        id: itemId, text: itemText, iconCss: this.parent.view === 'Details' ? CLS.ICON_GRID : CLS.ICON_LARGE,\n                        items: [\n                            {\n                                id: this.getMenuId('largeiconsview'), text: getLocaleText(this.parent, 'View-LargeIcons'),\n                                iconCss: this.parent.view === 'Details' ? null : CLS.TB_OPTION_TICK\n                            },\n                            {\n                                id: this.getMenuId('detailsview'), text: getLocaleText(this.parent, 'View-Details'),\n                                iconCss: this.parent.view === 'Details' ? CLS.TB_OPTION_TICK : null\n                            }\n                        ]\n                    };\n                    break;\n                case 'Refresh':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_REFRESH };\n                    break;\n                case 'SelectAll':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_SELECTALL };\n                    break;\n                /* istanbul ignore next */\n                case 'Download':\n                    item = { id: itemId, text: itemText, iconCss: CLS.ICON_DOWNLOAD };\n                    break;\n                /* istanbul ignore next */\n                default:\n                    item = { id: itemId, text: itemText };\n                    break;\n            }\n            items.push(item);\n        }\n        return items;\n    };\n    ContextMenu.prototype.getMenuId = function (id) {\n        return this.parent.element.id + '_cm_' + id.toLowerCase();\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n"]},"metadata":{},"sourceType":"module"}