{"ast":null,"code":"import { classList, addClass, removeClass, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { EventHandler, closest } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { Dialog, calculateRelativeBasedPosition } from '@syncfusion/ej2-popups';\nimport { createCboxWithWrap, toogleCheckbox, parentsUntil, removeAddCboxClasses } from '../base/util';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport { SearchBox } from '../services/focus-strategy';\nimport * as literals from '../base/string-literals';\n/**\n * The `ColumnChooser` module is used to show or hide columns dynamically.\n */\n\nvar ColumnChooser =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid ColumnChooser module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n   * @hidden\n   */\n  function ColumnChooser(parent, serviceLocator) {\n    this.showColumn = [];\n    this.hideColumn = [];\n    this.changedColumns = [];\n    this.unchangedColumns = [];\n    this.isDlgOpen = false;\n    this.initialOpenDlg = true;\n    this.stateChangeColumns = [];\n    this.changedStateColumns = [];\n    this.isInitialOpen = false;\n    this.isCustomizeOpenCC = false;\n    this.searchOperator = 'startswith';\n    this.prevShowedCols = [];\n    this.hideDialogFunction = this.hideDialog.bind(this);\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.addEventListener();\n    this.cBoxTrue = createCheckBox(this.parent.createElement, true, {\n      checked: true,\n      label: ' '\n    });\n    this.cBoxFalse = createCheckBox(this.parent.createElement, true, {\n      checked: false,\n      label: ' '\n    });\n    this.cBoxTrue.insertBefore(this.parent.createElement('input', {\n      className: 'e-chk-hidden e-cc e-cc-chbox',\n      attrs: {\n        type: 'checkbox'\n      }\n    }), this.cBoxTrue.firstChild);\n    this.cBoxFalse.insertBefore(this.parent.createElement('input', {\n      className: 'e-chk-hidden e-cc e-cc-chbox',\n      attrs: {\n        'type': 'checkbox'\n      }\n    }), this.cBoxFalse.firstChild);\n    this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');\n\n    if (this.parent.enableRtl) {\n      addClass([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);\n    }\n  }\n\n  ColumnChooser.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n\n    if (!gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n\n    this.removeEventListener();\n    this.unWireEvents();\n\n    if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.element && !this.dlgObj.isDestroyed) {\n      this.dlgObj.destroy();\n    }\n  };\n\n  ColumnChooser.prototype.rtlUpdate = function () {\n    if (this.parent.enableRtl) {\n      addClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n    } else {\n      removeClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  ColumnChooser.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.add(document, 'click', this.clickHandler, this);\n    this.parent.on(events.uiUpdate, this.enableAfterRenderEle, this);\n    this.parent.on(events.initialEnd, this.render, this);\n    this.parent.addEventListener(events.dataBound, this.hideDialogFunction);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.rtlUpdated, this.rtlUpdate, this);\n    this.parent.on(events.keyPressed, this.keyUpHandler, this);\n    this.parent.on(events.resetColumns, this.onResetColumns, this);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  ColumnChooser.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.remove(document, 'click', this.clickHandler);\n    this.parent.off(events.initialEnd, this.render);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.uiUpdate, this.enableAfterRenderEle);\n    this.parent.off(events.rtlUpdated, this.rtlUpdate);\n    this.parent.on(events.keyPressed, this.keyUpHandler, this);\n    this.parent.off(events.resetColumns, this.onResetColumns);\n    this.parent.removeEventListener(events.dataBound, this.hideDialogFunction);\n  };\n\n  ColumnChooser.prototype.render = function () {\n    this.l10n = this.serviceLocator.getService('localization');\n    this.renderDlgContent();\n    this.getShowHideService = this.serviceLocator.getService('showHideService');\n  };\n\n  ColumnChooser.prototype.clickHandler = function (e) {\n    var targetElement = e.target;\n\n    if (!this.isCustomizeOpenCC) {\n      if (!isNullOrUndefined(closest(targetElement, '.e-cc')) || !isNullOrUndefined(closest(targetElement, '.e-cc-toolbar'))) {\n        if (targetElement.classList.contains('e-columnchooser-btn') || targetElement.classList.contains('e-cc-toolbar')) {\n          if (this.initialOpenDlg && this.dlgObj.visible || !this.isDlgOpen) {\n            this.isDlgOpen = true;\n            return;\n          }\n        } else if (targetElement.classList.contains('e-cc-cancel')) {\n          targetElement.parentElement.querySelector('.e-ccsearch').value = '';\n          this.columnChooserSearch('');\n          this.removeCancelIcon();\n          this.refreshCheckboxButton();\n        }\n      } else {\n        if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible && !targetElement.classList.contains('e-toolbar-items')) {\n          this.dlgObj.hide();\n          this.clearActions();\n          this.refreshCheckboxState(); // this.unWireEvents();\n\n          this.isDlgOpen = false;\n        }\n      }\n\n      if (this.parent.detailTemplate || this.parent.childGrid) {\n        this.targetdlg = e.target;\n      }\n    }\n\n    if (this.isCustomizeOpenCC && e.target.classList.contains('e-cc-cancel')) {\n      this.refreshCheckboxState();\n    }\n\n    this.rtlUpdate();\n  };\n\n  ColumnChooser.prototype.hideDialog = function () {\n    if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible) {\n      this.dlgObj.hide(); // this.unWireEvents();\n\n      this.isDlgOpen = false;\n    }\n  };\n  /**\n   * To render columnChooser when showColumnChooser enabled.\n   *\n   * @param {number} x - specifies the position x\n   * @param {number} y - specifies the position y\n   * @param {Element} target - specifies the target\n   * @returns {void}\n   * @hidden\n   */\n\n\n  ColumnChooser.prototype.renderColumnChooser = function (x, y, target) {\n    if (!this.dlgObj.visible && (this.parent.detailTemplate || this.parent.childGrid)) {\n      this.hideOpenedDialog();\n    }\n\n    if (!this.dlgObj.visible) {\n      var args = this.beforeOpenColumnChooserEvent();\n\n      if (args.cancel) {\n        return;\n      }\n\n      if (target) {\n        this.targetdlg = target;\n      }\n\n      this.refreshCheckboxState();\n      this.dlgObj.dataBind();\n      this.dlgObj.element.style.maxHeight = '430px';\n      var elementVisible = this.dlgObj.element.style.display;\n      this.dlgObj.element.style.display = 'block';\n      var isSticky = this.parent.getHeaderContent().classList.contains('e-sticky');\n      var toolbarItem = closest(target, '.e-toolbar-item');\n      var newpos = void 0;\n\n      if (isSticky) {\n        newpos = toolbarItem.getBoundingClientRect();\n        this.dlgObj.element.classList.add('e-sticky');\n      } else {\n        this.dlgObj.element.classList.remove('e-sticky');\n        newpos = calculateRelativeBasedPosition(toolbarItem, this.dlgObj.element);\n      }\n\n      this.dlgObj.element.style.display = elementVisible;\n      this.dlgObj.element.style.top = newpos.top + closest(target, '.e-cc-toolbar').getBoundingClientRect().height + 'px';\n      var dlgWidth = 250;\n\n      if (!isNullOrUndefined(closest(target, '.e-bigger'))) {\n        this.dlgObj.width = 258;\n      }\n\n      if (Browser.isDevice) {\n        this.dlgObj.target = document.body;\n        this.dlgObj.position = {\n          X: 'center',\n          Y: 'center'\n        };\n        this.dlgObj.refreshPosition();\n        this.dlgObj.open = this.mOpenDlg.bind(this);\n      } else {\n        if (this.parent.enableRtl) {\n          this.dlgObj.element.style.left = target.offsetLeft + 'px';\n        } else {\n          this.dlgObj.element.style.left = newpos.left - dlgWidth + closest(target, '.e-cc-toolbar').clientWidth + 2 + 'px';\n        }\n      }\n\n      this.removeCancelIcon();\n      this.dlgObj.show();\n      this.parent.notify(events.columnChooserOpened, {\n        dialog: this.dlgObj\n      });\n    } else {\n      // this.unWireEvents();\n      this.hideDialog();\n      this.addcancelIcon();\n      this.clearActions();\n      this.refreshCheckboxState();\n    }\n\n    this.rtlUpdate();\n  };\n  /**\n   * Column chooser can be displayed on screen by given position(X and Y axis).\n   *\n   * @param  {number} X - Defines the X axis.\n   * @param  {number} Y - Defines the Y axis.\n   * @return {void}\n   */\n\n\n  ColumnChooser.prototype.openColumnChooser = function (X, Y) {\n    this.isCustomizeOpenCC = true;\n\n    if (this.dlgObj.visible) {\n      this.hideDialog();\n      return;\n    }\n\n    var args = this.beforeOpenColumnChooserEvent();\n\n    if (args.cancel) {\n      return;\n    }\n\n    if (!this.isInitialOpen) {\n      this.dlgObj.content = this.renderChooserList();\n      this.updateIntermediateBtn();\n    } else {\n      this.refreshCheckboxState();\n    }\n\n    this.dlgObj.dataBind();\n    this.dlgObj.position = {\n      X: 'center',\n      Y: 'center'\n    };\n\n    if (isNullOrUndefined(X)) {\n      this.dlgObj.position = {\n        X: 'center',\n        Y: 'center'\n      };\n      this.dlgObj.refreshPosition();\n    } else {\n      this.dlgObj.element.style.top = '';\n      this.dlgObj.element.style.left = '';\n      this.dlgObj.element.style.top = Y + 'px';\n      this.dlgObj.element.style.left = X + 'px';\n    }\n\n    this.dlgObj.beforeOpen = this.customDialogOpen.bind(this);\n    this.dlgObj.show();\n    this.isInitialOpen = true;\n    this.dlgObj.beforeClose = this.customDialogClose.bind(this);\n  };\n\n  ColumnChooser.prototype.enableAfterRenderEle = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.render();\n    }\n  };\n\n  ColumnChooser.prototype.keyUpHandler = function (e) {\n    if (e.action === 'escape') {\n      this.hideDialog();\n    }\n  };\n\n  ColumnChooser.prototype.customDialogOpen = function () {\n    var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n    EventHandler.add(searchElement, 'keyup', this.columnChooserManualSearch, this);\n  };\n\n  ColumnChooser.prototype.customDialogClose = function () {\n    var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n    EventHandler.remove(searchElement, 'keyup', this.columnChooserManualSearch);\n  };\n\n  ColumnChooser.prototype.getColumns = function () {\n    var columns = this.parent.getColumns().filter(function (column) {\n      return column.type !== 'checkbox' && column.showInColumnChooser === true || column.type === 'checkbox' && column.field !== undefined;\n    });\n    return columns;\n  };\n\n  ColumnChooser.prototype.renderDlgContent = function () {\n    this.dlgDiv = this.parent.createElement('div', {\n      className: 'e-ccdlg e-cc',\n      id: this.parent.element.id + '_ccdlg'\n    });\n    this.dlgDiv.setAttribute('aria-label', this.l10n.getConstant('ColumnChooserDialogARIA'));\n    this.parent.element.appendChild(this.dlgDiv);\n    this.dlgObj = new Dialog({\n      header: this.l10n.getConstant('ChooseColumns'),\n      showCloseIcon: false,\n      closeOnEscape: false,\n      locale: this.parent.locale,\n      visible: false,\n      enableRtl: this.parent.enableRtl,\n      target: document.getElementById(this.parent.element.id),\n      buttons: [{\n        click: this.confirmDlgBtnClick.bind(this),\n        buttonModel: {\n          content: this.l10n.getConstant('OKButton'),\n          isPrimary: true,\n          cssClass: 'e-cc e-cc_okbtn'\n        }\n      }, {\n        click: this.clearBtnClick.bind(this),\n        buttonModel: {\n          cssClass: 'e-flat e-cc e-cc-cnbtn',\n          content: this.l10n.getConstant('CancelButton')\n        }\n      }],\n      content: this.renderChooserList(),\n      width: 250,\n      cssClass: 'e-cc',\n      animationSettings: {\n        effect: 'None'\n      }\n    });\n    var isStringTemplate = 'isStringTemplate';\n    this.dlgObj[isStringTemplate] = true;\n    this.dlgObj.appendTo(this.dlgDiv);\n    this.wireEvents();\n  };\n\n  ColumnChooser.prototype.renderChooserList = function () {\n    this.mainDiv = this.parent.createElement('div', {\n      className: 'e-main-div e-cc'\n    });\n    var searchDiv = this.parent.createElement('div', {\n      className: 'e-cc-searchdiv e-cc e-input-group'\n    });\n    var ccsearchele = this.parent.createElement('input', {\n      className: 'e-ccsearch e-cc e-input',\n      attrs: {\n        placeholder: this.l10n.getConstant('Search')\n      }\n    });\n    var ccsearchicon = this.parent.createElement('span', {\n      className: 'e-ccsearch-icon e-icons e-cc e-input-group-icon',\n      attrs: {\n        title: this.l10n.getConstant('Search')\n      }\n    });\n    var conDiv = this.parent.createElement('div', {\n      className: 'e-cc-contentdiv'\n    });\n    this.innerDiv = this.parent.createElement('div', {\n      className: 'e-innerdiv e-cc'\n    });\n    searchDiv.appendChild(ccsearchele);\n    searchDiv.appendChild(ccsearchicon);\n    this.searchBoxObj = new SearchBox(ccsearchele);\n    var innerDivContent = this.refreshCheckboxList(this.parent.getColumns());\n    this.innerDiv.appendChild(innerDivContent);\n    conDiv.appendChild(this.innerDiv);\n    this.mainDiv.appendChild(searchDiv);\n    this.mainDiv.appendChild(conDiv);\n    return this.mainDiv;\n  };\n\n  ColumnChooser.prototype.confirmDlgBtnClick = function (args) {\n    this.stateChangeColumns = [];\n    this.changedStateColumns = [];\n    this.changedColumns = this.changedColumns.length > 0 ? this.changedColumns : this.unchangedColumns;\n    this.changedColumnState(this.changedColumns);\n    var uncheckedLength = this.ulElement.querySelector('.e-uncheck') && this.ulElement.querySelectorAll('.e-uncheck:not(.e-selectall)').length;\n\n    if (!isNullOrUndefined(args)) {\n      if (uncheckedLength < this.parent.getColumns().length) {\n        if (this.hideColumn.length) {\n          this.columnStateChange(this.hideColumn, false);\n        }\n\n        if (this.showColumn.length) {\n          this.columnStateChange(this.showColumn, true);\n        }\n\n        this.getShowHideService.setVisible(this.stateChangeColumns, this.changedStateColumns);\n        this.clearActions();\n        this.parent.notify(events.tooltipDestroy, {\n          module: 'edit'\n        });\n\n        if (this.parent.getCurrentViewRecords().length === 0) {\n          var emptyRowCell = this.parent.element.querySelector('.e-emptyrow').querySelector('td');\n          emptyRowCell.setAttribute('colSpan', this.parent.getVisibleColumns().length.toString());\n        }\n      }\n    }\n  };\n\n  ColumnChooser.prototype.onResetColumns = function (e) {\n    if (e.requestType === 'columnstate') {\n      this.resetColumnState();\n      return;\n    }\n  };\n\n  ColumnChooser.prototype.resetColumnState = function () {\n    this.showColumn = [];\n    this.hideColumn = [];\n    this.hideDialog();\n  };\n\n  ColumnChooser.prototype.changedColumnState = function (changedColumns) {\n    for (var index = 0; index < changedColumns.length; index++) {\n      var colUid = changedColumns[index];\n      var currentCol = this.parent.getColumnByUid(colUid);\n      this.changedStateColumns.push(currentCol);\n    }\n  };\n\n  ColumnChooser.prototype.columnStateChange = function (stateColumns, state) {\n    for (var index = 0; index < stateColumns.length; index++) {\n      var colUid = stateColumns[index];\n      var currentCol = this.parent.getColumnByUid(colUid);\n\n      if (currentCol.type !== 'checkbox') {\n        currentCol.visible = state;\n      }\n\n      this.stateChangeColumns.push(currentCol);\n    }\n  };\n\n  ColumnChooser.prototype.clearActions = function () {\n    this.resetColumnState();\n    this.addcancelIcon();\n  };\n\n  ColumnChooser.prototype.clearBtnClick = function () {\n    this.clearActions();\n    this.parent.notify(events.columnChooserCancelBtnClick, {\n      dialog: this.dlgObj\n    });\n  };\n\n  ColumnChooser.prototype.checkstatecolumn = function (isChecked, coluid, selectAll) {\n    if (selectAll === void 0) {\n      selectAll = false;\n    }\n\n    if (isChecked) {\n      if (this.hideColumn.indexOf(coluid) !== -1) {\n        this.hideColumn.splice(this.hideColumn.indexOf(coluid), 1);\n      }\n\n      if (this.showColumn.indexOf(coluid) === -1) {\n        this.showColumn.push(coluid);\n      }\n    } else {\n      if (this.showColumn.indexOf(coluid) !== -1) {\n        this.showColumn.splice(this.showColumn.indexOf(coluid), 1);\n      }\n\n      if (this.hideColumn.indexOf(coluid) === -1) {\n        this.hideColumn.push(coluid);\n      }\n    }\n\n    if (selectAll) {\n      if (!isChecked) {\n        this.changedColumns.push(coluid);\n      } else {\n        this.unchangedColumns.push(coluid);\n      }\n    } else if (this.changedColumns.indexOf(coluid) !== -1) {\n      this.changedColumns.splice(this.changedColumns.indexOf(coluid), 1);\n    } else {\n      this.changedColumns.push(coluid);\n    }\n  };\n\n  ColumnChooser.prototype.columnChooserSearch = function (searchVal) {\n    var clearSearch = false;\n    var fltrCol;\n    var okButton;\n    var buttonEle = this.dlgDiv.querySelector('.e-footer-content');\n    var selectedCbox = this.ulElement.querySelector('.e-check') && this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n    this.isInitialOpen = true;\n\n    if (buttonEle) {\n      okButton = buttonEle.querySelector('.e-btn').ej2_instances[0];\n    }\n\n    if (searchVal === '') {\n      this.removeCancelIcon();\n      fltrCol = this.getColumns();\n      clearSearch = true;\n    } else {\n      fltrCol = new DataManager(this.getColumns()).executeLocal(new Query().where('headerText', this.searchOperator, searchVal, true, this.parent.columnChooserSettings.ignoreAccent));\n    }\n\n    if (fltrCol.length) {\n      this.innerDiv.innerHTML = ' ';\n      this.innerDiv.classList.remove('e-ccnmdiv');\n      this.innerDiv.appendChild(this.refreshCheckboxList(fltrCol));\n\n      if (!clearSearch) {\n        this.addcancelIcon();\n        this.refreshCheckboxButton();\n      } else {\n        if (okButton && selectedCbox) {\n          okButton.disabled = false;\n        }\n      }\n    } else {\n      var nMatchele = this.parent.createElement('span', {\n        className: 'e-cc e-nmatch'\n      });\n      nMatchele.innerHTML = this.l10n.getConstant('Matchs');\n      this.innerDiv.innerHTML = ' ';\n      this.innerDiv.appendChild(nMatchele);\n      this.innerDiv.classList.add('e-ccnmdiv');\n\n      if (okButton) {\n        okButton.disabled = true;\n      }\n    }\n\n    this.flag = true;\n    this.stopTimer();\n  };\n\n  ColumnChooser.prototype.wireEvents = function () {\n    EventHandler.add(this.dlgObj.element, 'click', this.checkBoxClickHandler, this);\n    EventHandler.add(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch, this);\n    this.searchBoxObj.wireEvent();\n  };\n\n  ColumnChooser.prototype.unWireEvents = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.dlgObj.element) {\n      EventHandler.remove(this.dlgObj.element, 'click', this.checkBoxClickHandler);\n    }\n\n    EventHandler.remove(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch);\n    this.searchBoxObj.unWireEvent();\n  };\n\n  ColumnChooser.prototype.checkBoxClickHandler = function (e) {\n    var checkstate;\n    var elem = parentsUntil(e.target, 'e-checkbox-wrapper');\n\n    if (elem) {\n      var selectAll = elem.querySelector('.e-selectall');\n\n      if (selectAll) {\n        this.updateSelectAll(!elem.querySelector('.e-check'));\n      } else {\n        toogleCheckbox(elem.parentElement);\n      }\n\n      elem.querySelector('.e-chk-hidden').focus();\n\n      if (elem.querySelector('.e-check')) {\n        checkstate = true;\n      } else if (elem.querySelector('.e-uncheck')) {\n        checkstate = false;\n      } else {\n        return;\n      }\n\n      this.updateIntermediateBtn();\n      var columnUid = parentsUntil(elem, 'e-ccheck').getAttribute('uid');\n      var column = this.parent.getColumns();\n\n      if (columnUid === 'grid-selectAll') {\n        this.changedColumns = [];\n        this.unchangedColumns = [];\n\n        for (var i = 0; i < column.length; i++) {\n          if (column[i].showInColumnChooser) {\n            this.checkstatecolumn(checkstate, column[i].uid, true);\n          }\n        }\n      } else {\n        this.checkstatecolumn(checkstate, columnUid);\n      }\n\n      this.refreshCheckboxButton();\n    }\n  };\n\n  ColumnChooser.prototype.updateIntermediateBtn = function () {\n    var cnt = this.ulElement.children.length - 1;\n    var className = [];\n    var elem = this.ulElement.children[0].querySelector('.e-frame');\n    var selected = this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n    var btn = this.dlgObj.btnObj[0];\n    btn.disabled = false;\n\n    if (cnt === selected) {\n      className = ['e-check'];\n    } else if (selected) {\n      className = ['e-stop'];\n    } else {\n      className = ['e-uncheck'];\n      btn.disabled = true;\n    }\n\n    btn.dataBind();\n    removeClass([elem], ['e-check', 'e-stop', 'e-uncheck']);\n    addClass([elem], className);\n  };\n\n  ColumnChooser.prototype.updateSelectAll = function (checked) {\n    var cBoxes = [].slice.call(this.ulElement.getElementsByClassName('e-frame'));\n\n    for (var _i = 0, cBoxes_1 = cBoxes; _i < cBoxes_1.length; _i++) {\n      var cBox = cBoxes_1[_i];\n      removeAddCboxClasses(cBox, checked);\n    }\n  };\n\n  ColumnChooser.prototype.refreshCheckboxButton = function () {\n    var visibleCols = this.parent.getVisibleColumns();\n\n    for (var i = 0; i < visibleCols.length; i++) {\n      var columnUID = visibleCols[i].uid;\n\n      if (this.prevShowedCols.indexOf(columnUID) === -1) {\n        this.prevShowedCols.push(columnUID);\n      }\n    }\n\n    for (var i = 0; i < this.hideColumn.length; i++) {\n      var index = this.prevShowedCols.indexOf(this.hideColumn[i]);\n\n      if (index !== -1) {\n        this.prevShowedCols.splice(index, 1);\n      }\n    }\n\n    var selected = this.showColumn.length !== 0 ? 1 : this.prevShowedCols.length;\n    var btn = this.dlgDiv.querySelector('.e-footer-content').querySelector('.e-btn').ej2_instances[0];\n    btn.disabled = false;\n    var srchShowCols = [];\n    var searchData = [].slice.call(this.parent.element.getElementsByClassName('e-cc-chbox'));\n\n    for (var i = 0, itemsLen = searchData.length; i < itemsLen; i++) {\n      var element = searchData[i];\n      var columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n      srchShowCols.push(columnUID);\n    }\n\n    var hideCols = this.showColumn.filter(function (column) {\n      return srchShowCols.indexOf(column) !== -1;\n    });\n\n    if (selected === 0 && hideCols.length === 0) {\n      btn.disabled = true;\n    }\n\n    btn.dataBind();\n  };\n\n  ColumnChooser.prototype.refreshCheckboxList = function (gdCol) {\n    this.ulElement = this.parent.createElement('ul', {\n      className: 'e-ccul-ele e-cc'\n    });\n    var selectAllValue = this.l10n.getConstant('SelectAll');\n    var cclist = this.parent.createElement('li', {\n      className: 'e-cclist e-cc e-cc-selectall'\n    });\n    var selectAll = this.createCheckBox(selectAllValue, false, 'grid-selectAll');\n\n    if (gdCol.length) {\n      selectAll.querySelector('.e-checkbox-wrapper').firstElementChild.classList.add('e-selectall');\n      selectAll.querySelector('.e-frame').classList.add('e-selectall');\n      this.checkState(selectAll.querySelector('.e-icons'), true);\n      cclist.appendChild(selectAll);\n      this.ulElement.appendChild(cclist);\n    }\n\n    for (var i = 0; i < gdCol.length; i++) {\n      var columns = gdCol[i];\n      this.renderCheckbox(columns);\n    }\n\n    return this.ulElement;\n  };\n\n  ColumnChooser.prototype.refreshCheckboxState = function () {\n    this.dlgObj.element.querySelector('.e-cc.e-input').value = '';\n    this.columnChooserSearch('');\n    var gridObject = this.parent;\n    var currentCheckBoxColls = this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)');\n\n    for (var i = 0, itemLen = currentCheckBoxColls.length; i < itemLen; i++) {\n      var element = currentCheckBoxColls[i];\n      var columnUID = void 0;\n\n      if (this.parent.childGrid || this.parent.detailTemplate) {\n        columnUID = parentsUntil(this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)')[i], 'e-ccheck').getAttribute('uid');\n      } else {\n        columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n      }\n\n      var column = gridObject.getColumnByUid(columnUID);\n      var uncheck = [].slice.call(element.parentElement.getElementsByClassName('e-uncheck'));\n\n      if (column.visible && !uncheck.length) {\n        element.checked = true;\n        this.checkState(element.parentElement.querySelector('.e-icons'), true);\n      } else {\n        element.checked = false;\n        this.checkState(element.parentElement.querySelector('.e-icons'), false);\n      }\n    }\n  };\n\n  ColumnChooser.prototype.checkState = function (element, state) {\n    if (state) {\n      classList(element, ['e-check'], ['e-uncheck']);\n    } else {\n      classList(element, ['e-uncheck'], ['e-check']);\n    }\n  };\n\n  ColumnChooser.prototype.createCheckBox = function (label, checked, uid) {\n    var cbox = checked ? this.cBoxTrue.cloneNode(true) : this.cBoxFalse.cloneNode(true);\n    cbox.querySelector('.e-label').innerHTML = label;\n    return createCboxWithWrap(uid, cbox, 'e-ccheck');\n  };\n\n  ColumnChooser.prototype.renderCheckbox = function (column) {\n    var cclist;\n    var hideColState;\n    var showColState;\n\n    if (column.showInColumnChooser) {\n      cclist = this.parent.createElement('li', {\n        className: 'e-cclist e-cc',\n        styles: 'list-style:None',\n        id: 'e-ccli_' + column.uid\n      });\n      hideColState = this.hideColumn.indexOf(column.uid) === -1 ? false : true;\n      showColState = this.showColumn.indexOf(column.uid) === -1 ? false : true;\n      var cccheckboxlist = this.createCheckBox(column.headerText, column.visible && !hideColState || showColState, column.uid);\n      cclist.appendChild(cccheckboxlist);\n      this.ulElement.appendChild(cclist);\n    }\n\n    if (this.isInitialOpen) {\n      this.updateIntermediateBtn();\n    }\n  };\n\n  ColumnChooser.prototype.columnChooserManualSearch = function (e) {\n    this.addcancelIcon();\n    this.searchValue = e.target.value;\n    this.stopTimer();\n    this.startTimer(e);\n  };\n\n  ColumnChooser.prototype.startTimer = function (e) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var interval = !proxy.flag && e.keyCode !== 13 ? 500 : 0;\n    this.timer = window.setInterval(function () {\n      proxy.columnChooserSearch(proxy.searchValue);\n    }, interval);\n  };\n\n  ColumnChooser.prototype.stopTimer = function () {\n    window.clearInterval(this.timer);\n  };\n\n  ColumnChooser.prototype.addcancelIcon = function () {\n    this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.add('e-cc-cancel');\n  };\n\n  ColumnChooser.prototype.removeCancelIcon = function () {\n    this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.remove('e-cc-cancel');\n  };\n\n  ColumnChooser.prototype.mOpenDlg = function () {\n    if (Browser.isDevice) {\n      this.dlgObj.element.querySelector('.e-cc-searchdiv').classList.remove('e-input-focus');\n      this.dlgObj.element.querySelectorAll('.e-cc-chbox')[0].focus();\n    }\n  }; // internally use\n\n\n  ColumnChooser.prototype.getModuleName = function () {\n    return 'columnChooser';\n  };\n\n  ColumnChooser.prototype.hideOpenedDialog = function () {\n    var openCC = [].slice.call(document.getElementsByClassName('e-ccdlg')).filter(function (dlgEle) {\n      return dlgEle.classList.contains('e-popup-open');\n    });\n\n    for (var i = 0, dlgLen = openCC.length; i < dlgLen; i++) {\n      if (openCC[i].classList.contains('e-dialog') || this.parent.element.id + '_ccdlg' !== openCC[i].id) {\n        openCC[i].ej2_instances[0].hide();\n      }\n    }\n  };\n\n  ColumnChooser.prototype.beforeOpenColumnChooserEvent = function () {\n    var args1 = {\n      requestType: 'beforeOpenColumnChooser',\n      element: this.parent.element,\n      columns: this.getColumns(),\n      cancel: false,\n      searchOperator: this.parent.columnChooserSettings.operator\n    };\n    this.parent.trigger(events.beforeOpenColumnChooser, args1);\n    this.searchOperator = args1.searchOperator;\n    return args1;\n  };\n\n  return ColumnChooser;\n}();\n\nexport { ColumnChooser };","map":{"version":3,"sources":["/Users/yasaman/Documents/moj_adminpanel/adminpanel/node_modules/@syncfusion/ej2-grids/src/grid/actions/column-chooser.js"],"names":["classList","addClass","removeClass","isNullOrUndefined","Browser","Query","DataManager","EventHandler","closest","events","Dialog","calculateRelativeBasedPosition","createCboxWithWrap","toogleCheckbox","parentsUntil","removeAddCboxClasses","createCheckBox","SearchBox","literals","ColumnChooser","parent","serviceLocator","showColumn","hideColumn","changedColumns","unchangedColumns","isDlgOpen","initialOpenDlg","stateChangeColumns","changedStateColumns","isInitialOpen","isCustomizeOpenCC","searchOperator","prevShowedCols","hideDialogFunction","hideDialog","bind","addEventListener","cBoxTrue","createElement","checked","label","cBoxFalse","insertBefore","className","attrs","type","firstChild","querySelector","add","enableRtl","prototype","destroy","gridElement","element","gridHeader","gridContent","removeEventListener","unWireEvents","dlgObj","isDestroyed","rtlUpdate","slice","call","innerDiv","getElementsByClassName","document","clickHandler","on","uiUpdate","enableAfterRenderEle","initialEnd","render","dataBound","rtlUpdated","keyPressed","keyUpHandler","resetColumns","onResetColumns","remove","off","l10n","getService","renderDlgContent","getShowHideService","e","targetElement","target","contains","visible","parentElement","value","columnChooserSearch","removeCancelIcon","refreshCheckboxButton","hide","clearActions","refreshCheckboxState","detailTemplate","childGrid","targetdlg","renderColumnChooser","x","y","hideOpenedDialog","args","beforeOpenColumnChooserEvent","cancel","dataBind","style","maxHeight","elementVisible","display","isSticky","getHeaderContent","toolbarItem","newpos","getBoundingClientRect","top","height","dlgWidth","width","isDevice","body","position","X","Y","refreshPosition","open","mOpenDlg","left","offsetLeft","clientWidth","show","notify","columnChooserOpened","dialog","addcancelIcon","openColumnChooser","content","renderChooserList","updateIntermediateBtn","beforeOpen","customDialogOpen","beforeClose","customDialogClose","module","getModuleName","enable","action","searchElement","columnChooserManualSearch","getColumns","columns","filter","column","showInColumnChooser","field","undefined","dlgDiv","id","setAttribute","getConstant","appendChild","header","showCloseIcon","closeOnEscape","locale","getElementById","buttons","click","confirmDlgBtnClick","buttonModel","isPrimary","cssClass","clearBtnClick","animationSettings","effect","isStringTemplate","appendTo","wireEvents","mainDiv","searchDiv","ccsearchele","placeholder","ccsearchicon","title","conDiv","searchBoxObj","innerDivContent","refreshCheckboxList","length","changedColumnState","uncheckedLength","ulElement","querySelectorAll","columnStateChange","setVisible","tooltipDestroy","getCurrentViewRecords","emptyRowCell","getVisibleColumns","toString","requestType","resetColumnState","index","colUid","currentCol","getColumnByUid","push","stateColumns","state","columnChooserCancelBtnClick","checkstatecolumn","isChecked","coluid","selectAll","indexOf","splice","searchVal","clearSearch","fltrCol","okButton","buttonEle","selectedCbox","ej2_instances","executeLocal","where","columnChooserSettings","ignoreAccent","innerHTML","disabled","nMatchele","flag","stopTimer","checkBoxClickHandler","searchBox","wireEvent","unWireEvent","checkstate","elem","updateSelectAll","focus","columnUid","getAttribute","i","uid","cnt","children","selected","btn","btnObj","cBoxes","_i","cBoxes_1","cBox","visibleCols","columnUID","srchShowCols","searchData","itemsLen","hideCols","gdCol","selectAllValue","cclist","firstElementChild","checkState","renderCheckbox","gridObject","currentCheckBoxColls","itemLen","uncheck","cbox","cloneNode","hideColState","showColState","styles","cccheckboxlist","headerText","searchValue","startTimer","proxy","interval","keyCode","timer","window","setInterval","clearInterval","openCC","dlgEle","dlgLen","args1","operator","trigger","beforeOpenColumnChooser"],"mappings":"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","sourcesContent":["import { classList, addClass, removeClass, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { EventHandler, closest } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { Dialog, calculateRelativeBasedPosition } from '@syncfusion/ej2-popups';\nimport { createCboxWithWrap, toogleCheckbox, parentsUntil, removeAddCboxClasses } from '../base/util';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport { SearchBox } from '../services/focus-strategy';\nimport * as literals from '../base/string-literals';\n/**\n * The `ColumnChooser` module is used to show or hide columns dynamically.\n */\nvar ColumnChooser = /** @class */ (function () {\n    /**\n     * Constructor for the Grid ColumnChooser module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n     * @hidden\n     */\n    function ColumnChooser(parent, serviceLocator) {\n        this.showColumn = [];\n        this.hideColumn = [];\n        this.changedColumns = [];\n        this.unchangedColumns = [];\n        this.isDlgOpen = false;\n        this.initialOpenDlg = true;\n        this.stateChangeColumns = [];\n        this.changedStateColumns = [];\n        this.isInitialOpen = false;\n        this.isCustomizeOpenCC = false;\n        this.searchOperator = 'startswith';\n        this.prevShowedCols = [];\n        this.hideDialogFunction = this.hideDialog.bind(this);\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n        this.cBoxTrue = createCheckBox(this.parent.createElement, true, { checked: true, label: ' ' });\n        this.cBoxFalse = createCheckBox(this.parent.createElement, true, { checked: false, label: ' ' });\n        this.cBoxTrue.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden e-cc e-cc-chbox', attrs: { type: 'checkbox' }\n        }), this.cBoxTrue.firstChild);\n        this.cBoxFalse.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden e-cc e-cc-chbox', attrs: { 'type': 'checkbox' }\n        }), this.cBoxFalse.firstChild);\n        this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');\n        if (this.parent.enableRtl) {\n            addClass([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);\n        }\n    }\n    ColumnChooser.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        this.removeEventListener();\n        this.unWireEvents();\n        if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.element && !this.dlgObj.isDestroyed) {\n            this.dlgObj.destroy();\n        }\n    };\n    ColumnChooser.prototype.rtlUpdate = function () {\n        if (this.parent.enableRtl) {\n            addClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n        }\n        else {\n            removeClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    ColumnChooser.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.add(document, 'click', this.clickHandler, this);\n        this.parent.on(events.uiUpdate, this.enableAfterRenderEle, this);\n        this.parent.on(events.initialEnd, this.render, this);\n        this.parent.addEventListener(events.dataBound, this.hideDialogFunction);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.rtlUpdated, this.rtlUpdate, this);\n        this.parent.on(events.keyPressed, this.keyUpHandler, this);\n        this.parent.on(events.resetColumns, this.onResetColumns, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    ColumnChooser.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(document, 'click', this.clickHandler);\n        this.parent.off(events.initialEnd, this.render);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.uiUpdate, this.enableAfterRenderEle);\n        this.parent.off(events.rtlUpdated, this.rtlUpdate);\n        this.parent.on(events.keyPressed, this.keyUpHandler, this);\n        this.parent.off(events.resetColumns, this.onResetColumns);\n        this.parent.removeEventListener(events.dataBound, this.hideDialogFunction);\n    };\n    ColumnChooser.prototype.render = function () {\n        this.l10n = this.serviceLocator.getService('localization');\n        this.renderDlgContent();\n        this.getShowHideService = this.serviceLocator.getService('showHideService');\n    };\n    ColumnChooser.prototype.clickHandler = function (e) {\n        var targetElement = e.target;\n        if (!this.isCustomizeOpenCC) {\n            if (!isNullOrUndefined(closest(targetElement, '.e-cc')) || !isNullOrUndefined(closest(targetElement, '.e-cc-toolbar'))) {\n                if (targetElement.classList.contains('e-columnchooser-btn') || targetElement.classList.contains('e-cc-toolbar')) {\n                    if ((this.initialOpenDlg && this.dlgObj.visible) || !this.isDlgOpen) {\n                        this.isDlgOpen = true;\n                        return;\n                    }\n                }\n                else if (targetElement.classList.contains('e-cc-cancel')) {\n                    targetElement.parentElement.querySelector('.e-ccsearch').value = '';\n                    this.columnChooserSearch('');\n                    this.removeCancelIcon();\n                    this.refreshCheckboxButton();\n                }\n            }\n            else {\n                if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible && !targetElement.classList.contains('e-toolbar-items')) {\n                    this.dlgObj.hide();\n                    this.clearActions();\n                    this.refreshCheckboxState();\n                    // this.unWireEvents();\n                    this.isDlgOpen = false;\n                }\n            }\n            if (this.parent.detailTemplate || this.parent.childGrid) {\n                this.targetdlg = e.target;\n            }\n        }\n        if (this.isCustomizeOpenCC && e.target.classList.contains('e-cc-cancel')) {\n            this.refreshCheckboxState();\n        }\n        this.rtlUpdate();\n    };\n    ColumnChooser.prototype.hideDialog = function () {\n        if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible) {\n            this.dlgObj.hide();\n            // this.unWireEvents();\n            this.isDlgOpen = false;\n        }\n    };\n    /**\n     * To render columnChooser when showColumnChooser enabled.\n     *\n     * @param {number} x - specifies the position x\n     * @param {number} y - specifies the position y\n     * @param {Element} target - specifies the target\n     * @returns {void}\n     * @hidden\n     */\n    ColumnChooser.prototype.renderColumnChooser = function (x, y, target) {\n        if (!this.dlgObj.visible && (this.parent.detailTemplate || this.parent.childGrid)) {\n            this.hideOpenedDialog();\n        }\n        if (!this.dlgObj.visible) {\n            var args = this.beforeOpenColumnChooserEvent();\n            if (args.cancel) {\n                return;\n            }\n            if (target) {\n                this.targetdlg = target;\n            }\n            this.refreshCheckboxState();\n            this.dlgObj.dataBind();\n            this.dlgObj.element.style.maxHeight = '430px';\n            var elementVisible = this.dlgObj.element.style.display;\n            this.dlgObj.element.style.display = 'block';\n            var isSticky = this.parent.getHeaderContent().classList.contains('e-sticky');\n            var toolbarItem = closest(target, '.e-toolbar-item');\n            var newpos = void 0;\n            if (isSticky) {\n                newpos = toolbarItem.getBoundingClientRect();\n                this.dlgObj.element.classList.add('e-sticky');\n            }\n            else {\n                this.dlgObj.element.classList.remove('e-sticky');\n                newpos = calculateRelativeBasedPosition(toolbarItem, this.dlgObj.element);\n            }\n            this.dlgObj.element.style.display = elementVisible;\n            this.dlgObj.element.style.top = newpos.top + closest(target, '.e-cc-toolbar').getBoundingClientRect().height + 'px';\n            var dlgWidth = 250;\n            if (!isNullOrUndefined(closest(target, '.e-bigger'))) {\n                this.dlgObj.width = 258;\n            }\n            if (Browser.isDevice) {\n                this.dlgObj.target = document.body;\n                this.dlgObj.position = { X: 'center', Y: 'center' };\n                this.dlgObj.refreshPosition();\n                this.dlgObj.open = this.mOpenDlg.bind(this);\n            }\n            else {\n                if (this.parent.enableRtl) {\n                    this.dlgObj.element.style.left = target.offsetLeft + 'px';\n                }\n                else {\n                    this.dlgObj.element.style.left = ((newpos.left - dlgWidth) + closest(target, '.e-cc-toolbar').clientWidth) + 2 + 'px';\n                }\n            }\n            this.removeCancelIcon();\n            this.dlgObj.show();\n            this.parent.notify(events.columnChooserOpened, { dialog: this.dlgObj });\n        }\n        else {\n            // this.unWireEvents();\n            this.hideDialog();\n            this.addcancelIcon();\n            this.clearActions();\n            this.refreshCheckboxState();\n        }\n        this.rtlUpdate();\n    };\n    /**\n     * Column chooser can be displayed on screen by given position(X and Y axis).\n     *\n     * @param  {number} X - Defines the X axis.\n     * @param  {number} Y - Defines the Y axis.\n     * @return {void}\n     */\n    ColumnChooser.prototype.openColumnChooser = function (X, Y) {\n        this.isCustomizeOpenCC = true;\n        if (this.dlgObj.visible) {\n            this.hideDialog();\n            return;\n        }\n        var args = this.beforeOpenColumnChooserEvent();\n        if (args.cancel) {\n            return;\n        }\n        if (!this.isInitialOpen) {\n            this.dlgObj.content = this.renderChooserList();\n            this.updateIntermediateBtn();\n        }\n        else {\n            this.refreshCheckboxState();\n        }\n        this.dlgObj.dataBind();\n        this.dlgObj.position = { X: 'center', Y: 'center' };\n        if (isNullOrUndefined(X)) {\n            this.dlgObj.position = { X: 'center', Y: 'center' };\n            this.dlgObj.refreshPosition();\n        }\n        else {\n            this.dlgObj.element.style.top = '';\n            this.dlgObj.element.style.left = '';\n            this.dlgObj.element.style.top = Y + 'px';\n            this.dlgObj.element.style.left = X + 'px';\n        }\n        this.dlgObj.beforeOpen = this.customDialogOpen.bind(this);\n        this.dlgObj.show();\n        this.isInitialOpen = true;\n        this.dlgObj.beforeClose = this.customDialogClose.bind(this);\n    };\n    ColumnChooser.prototype.enableAfterRenderEle = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.render();\n        }\n    };\n    ColumnChooser.prototype.keyUpHandler = function (e) {\n        if (e.action === 'escape') {\n            this.hideDialog();\n        }\n    };\n    ColumnChooser.prototype.customDialogOpen = function () {\n        var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n        EventHandler.add(searchElement, 'keyup', this.columnChooserManualSearch, this);\n    };\n    ColumnChooser.prototype.customDialogClose = function () {\n        var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n        EventHandler.remove(searchElement, 'keyup', this.columnChooserManualSearch);\n    };\n    ColumnChooser.prototype.getColumns = function () {\n        var columns = this.parent.getColumns().filter(function (column) { return (column.type !== 'checkbox'\n            && column.showInColumnChooser === true) || (column.type === 'checkbox' && column.field !== undefined); });\n        return columns;\n    };\n    ColumnChooser.prototype.renderDlgContent = function () {\n        this.dlgDiv = this.parent.createElement('div', { className: 'e-ccdlg e-cc', id: this.parent.element.id + '_ccdlg' });\n        this.dlgDiv.setAttribute('aria-label', this.l10n.getConstant('ColumnChooserDialogARIA'));\n        this.parent.element.appendChild(this.dlgDiv);\n        this.dlgObj = new Dialog({\n            header: this.l10n.getConstant('ChooseColumns'),\n            showCloseIcon: false,\n            closeOnEscape: false,\n            locale: this.parent.locale,\n            visible: false,\n            enableRtl: this.parent.enableRtl,\n            target: document.getElementById(this.parent.element.id),\n            buttons: [{\n                    click: this.confirmDlgBtnClick.bind(this),\n                    buttonModel: {\n                        content: this.l10n.getConstant('OKButton'), isPrimary: true,\n                        cssClass: 'e-cc e-cc_okbtn'\n                    }\n                },\n                {\n                    click: this.clearBtnClick.bind(this),\n                    buttonModel: { cssClass: 'e-flat e-cc e-cc-cnbtn', content: this.l10n.getConstant('CancelButton') }\n                }],\n            content: this.renderChooserList(),\n            width: 250,\n            cssClass: 'e-cc',\n            animationSettings: { effect: 'None' }\n        });\n        var isStringTemplate = 'isStringTemplate';\n        this.dlgObj[isStringTemplate] = true;\n        this.dlgObj.appendTo(this.dlgDiv);\n        this.wireEvents();\n    };\n    ColumnChooser.prototype.renderChooserList = function () {\n        this.mainDiv = this.parent.createElement('div', { className: 'e-main-div e-cc' });\n        var searchDiv = this.parent.createElement('div', { className: 'e-cc-searchdiv e-cc e-input-group' });\n        var ccsearchele = this.parent.createElement('input', {\n            className: 'e-ccsearch e-cc e-input',\n            attrs: { placeholder: this.l10n.getConstant('Search') }\n        });\n        var ccsearchicon = this.parent.createElement('span', {\n            className: 'e-ccsearch-icon e-icons e-cc e-input-group-icon',\n            attrs: { title: this.l10n.getConstant('Search') }\n        });\n        var conDiv = this.parent.createElement('div', { className: 'e-cc-contentdiv' });\n        this.innerDiv = this.parent.createElement('div', { className: 'e-innerdiv e-cc' });\n        searchDiv.appendChild(ccsearchele);\n        searchDiv.appendChild(ccsearchicon);\n        this.searchBoxObj = new SearchBox(ccsearchele);\n        var innerDivContent = this.refreshCheckboxList(this.parent.getColumns());\n        this.innerDiv.appendChild(innerDivContent);\n        conDiv.appendChild(this.innerDiv);\n        this.mainDiv.appendChild(searchDiv);\n        this.mainDiv.appendChild(conDiv);\n        return this.mainDiv;\n    };\n    ColumnChooser.prototype.confirmDlgBtnClick = function (args) {\n        this.stateChangeColumns = [];\n        this.changedStateColumns = [];\n        this.changedColumns = (this.changedColumns.length > 0) ? this.changedColumns : this.unchangedColumns;\n        this.changedColumnState(this.changedColumns);\n        var uncheckedLength = this.ulElement.querySelector('.e-uncheck') &&\n            this.ulElement.querySelectorAll('.e-uncheck:not(.e-selectall)').length;\n        if (!isNullOrUndefined(args)) {\n            if (uncheckedLength < this.parent.getColumns().length) {\n                if (this.hideColumn.length) {\n                    this.columnStateChange(this.hideColumn, false);\n                }\n                if (this.showColumn.length) {\n                    this.columnStateChange(this.showColumn, true);\n                }\n                this.getShowHideService.setVisible(this.stateChangeColumns, this.changedStateColumns);\n                this.clearActions();\n                this.parent.notify(events.tooltipDestroy, { module: 'edit' });\n                if (this.parent.getCurrentViewRecords().length === 0) {\n                    var emptyRowCell = this.parent.element.querySelector('.e-emptyrow').querySelector('td');\n                    emptyRowCell.setAttribute('colSpan', this.parent.getVisibleColumns().length.toString());\n                }\n            }\n        }\n    };\n    ColumnChooser.prototype.onResetColumns = function (e) {\n        if (e.requestType === 'columnstate') {\n            this.resetColumnState();\n            return;\n        }\n    };\n    ColumnChooser.prototype.resetColumnState = function () {\n        this.showColumn = [];\n        this.hideColumn = [];\n        this.hideDialog();\n    };\n    ColumnChooser.prototype.changedColumnState = function (changedColumns) {\n        for (var index = 0; index < changedColumns.length; index++) {\n            var colUid = changedColumns[index];\n            var currentCol = this.parent.getColumnByUid(colUid);\n            this.changedStateColumns.push(currentCol);\n        }\n    };\n    ColumnChooser.prototype.columnStateChange = function (stateColumns, state) {\n        for (var index = 0; index < stateColumns.length; index++) {\n            var colUid = stateColumns[index];\n            var currentCol = this.parent.getColumnByUid(colUid);\n            if (currentCol.type !== 'checkbox') {\n                currentCol.visible = state;\n            }\n            this.stateChangeColumns.push(currentCol);\n        }\n    };\n    ColumnChooser.prototype.clearActions = function () {\n        this.resetColumnState();\n        this.addcancelIcon();\n    };\n    ColumnChooser.prototype.clearBtnClick = function () {\n        this.clearActions();\n        this.parent.notify(events.columnChooserCancelBtnClick, { dialog: this.dlgObj });\n    };\n    ColumnChooser.prototype.checkstatecolumn = function (isChecked, coluid, selectAll) {\n        if (selectAll === void 0) { selectAll = false; }\n        if (isChecked) {\n            if (this.hideColumn.indexOf(coluid) !== -1) {\n                this.hideColumn.splice(this.hideColumn.indexOf(coluid), 1);\n            }\n            if (this.showColumn.indexOf(coluid) === -1) {\n                this.showColumn.push(coluid);\n            }\n        }\n        else {\n            if (this.showColumn.indexOf(coluid) !== -1) {\n                this.showColumn.splice(this.showColumn.indexOf(coluid), 1);\n            }\n            if (this.hideColumn.indexOf(coluid) === -1) {\n                this.hideColumn.push(coluid);\n            }\n        }\n        if (selectAll) {\n            if (!isChecked) {\n                this.changedColumns.push(coluid);\n            }\n            else {\n                this.unchangedColumns.push(coluid);\n            }\n        }\n        else if (this.changedColumns.indexOf(coluid) !== -1) {\n            this.changedColumns.splice(this.changedColumns.indexOf(coluid), 1);\n        }\n        else {\n            this.changedColumns.push(coluid);\n        }\n    };\n    ColumnChooser.prototype.columnChooserSearch = function (searchVal) {\n        var clearSearch = false;\n        var fltrCol;\n        var okButton;\n        var buttonEle = this.dlgDiv.querySelector('.e-footer-content');\n        var selectedCbox = this.ulElement.querySelector('.e-check') &&\n            this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n        this.isInitialOpen = true;\n        if (buttonEle) {\n            okButton = buttonEle.querySelector('.e-btn').ej2_instances[0];\n        }\n        if (searchVal === '') {\n            this.removeCancelIcon();\n            fltrCol = this.getColumns();\n            clearSearch = true;\n        }\n        else {\n            fltrCol = new DataManager(this.getColumns()).executeLocal(new Query()\n                .where('headerText', this.searchOperator, searchVal, true, this.parent.columnChooserSettings.ignoreAccent));\n        }\n        if (fltrCol.length) {\n            this.innerDiv.innerHTML = ' ';\n            this.innerDiv.classList.remove('e-ccnmdiv');\n            this.innerDiv.appendChild(this.refreshCheckboxList(fltrCol));\n            if (!clearSearch) {\n                this.addcancelIcon();\n                this.refreshCheckboxButton();\n            }\n            else {\n                if (okButton && selectedCbox) {\n                    okButton.disabled = false;\n                }\n            }\n        }\n        else {\n            var nMatchele = this.parent.createElement('span', { className: 'e-cc e-nmatch' });\n            nMatchele.innerHTML = this.l10n.getConstant('Matchs');\n            this.innerDiv.innerHTML = ' ';\n            this.innerDiv.appendChild(nMatchele);\n            this.innerDiv.classList.add('e-ccnmdiv');\n            if (okButton) {\n                okButton.disabled = true;\n            }\n        }\n        this.flag = true;\n        this.stopTimer();\n    };\n    ColumnChooser.prototype.wireEvents = function () {\n        EventHandler.add(this.dlgObj.element, 'click', this.checkBoxClickHandler, this);\n        EventHandler.add(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch, this);\n        this.searchBoxObj.wireEvent();\n    };\n    ColumnChooser.prototype.unWireEvents = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (this.dlgObj.element) {\n            EventHandler.remove(this.dlgObj.element, 'click', this.checkBoxClickHandler);\n        }\n        EventHandler.remove(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch);\n        this.searchBoxObj.unWireEvent();\n    };\n    ColumnChooser.prototype.checkBoxClickHandler = function (e) {\n        var checkstate;\n        var elem = parentsUntil(e.target, 'e-checkbox-wrapper');\n        if (elem) {\n            var selectAll = elem.querySelector('.e-selectall');\n            if (selectAll) {\n                this.updateSelectAll(!elem.querySelector('.e-check'));\n            }\n            else {\n                toogleCheckbox(elem.parentElement);\n            }\n            elem.querySelector('.e-chk-hidden').focus();\n            if (elem.querySelector('.e-check')) {\n                checkstate = true;\n            }\n            else if (elem.querySelector('.e-uncheck')) {\n                checkstate = false;\n            }\n            else {\n                return;\n            }\n            this.updateIntermediateBtn();\n            var columnUid = parentsUntil(elem, 'e-ccheck').getAttribute('uid');\n            var column = this.parent.getColumns();\n            if (columnUid === 'grid-selectAll') {\n                this.changedColumns = [];\n                this.unchangedColumns = [];\n                for (var i = 0; i < column.length; i++) {\n                    if (column[i].showInColumnChooser) {\n                        this.checkstatecolumn(checkstate, column[i].uid, true);\n                    }\n                }\n            }\n            else {\n                this.checkstatecolumn(checkstate, columnUid);\n            }\n            this.refreshCheckboxButton();\n        }\n    };\n    ColumnChooser.prototype.updateIntermediateBtn = function () {\n        var cnt = this.ulElement.children.length - 1;\n        var className = [];\n        var elem = this.ulElement.children[0].querySelector('.e-frame');\n        var selected = this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n        var btn = this.dlgObj.btnObj[0];\n        btn.disabled = false;\n        if (cnt === selected) {\n            className = ['e-check'];\n        }\n        else if (selected) {\n            className = ['e-stop'];\n        }\n        else {\n            className = ['e-uncheck'];\n            btn.disabled = true;\n        }\n        btn.dataBind();\n        removeClass([elem], ['e-check', 'e-stop', 'e-uncheck']);\n        addClass([elem], className);\n    };\n    ColumnChooser.prototype.updateSelectAll = function (checked) {\n        var cBoxes = [].slice.call(this.ulElement.getElementsByClassName('e-frame'));\n        for (var _i = 0, cBoxes_1 = cBoxes; _i < cBoxes_1.length; _i++) {\n            var cBox = cBoxes_1[_i];\n            removeAddCboxClasses(cBox, checked);\n        }\n    };\n    ColumnChooser.prototype.refreshCheckboxButton = function () {\n        var visibleCols = this.parent.getVisibleColumns();\n        for (var i = 0; i < visibleCols.length; i++) {\n            var columnUID = visibleCols[i].uid;\n            if (this.prevShowedCols.indexOf(columnUID) === -1) {\n                this.prevShowedCols.push(columnUID);\n            }\n        }\n        for (var i = 0; i < this.hideColumn.length; i++) {\n            var index = this.prevShowedCols.indexOf(this.hideColumn[i]);\n            if (index !== -1) {\n                this.prevShowedCols.splice(index, 1);\n            }\n        }\n        var selected = this.showColumn.length !== 0 ? 1 : this.prevShowedCols.length;\n        var btn = this.dlgDiv.querySelector('.e-footer-content').querySelector('.e-btn').ej2_instances[0];\n        btn.disabled = false;\n        var srchShowCols = [];\n        var searchData = [].slice.call(this.parent.element.getElementsByClassName('e-cc-chbox'));\n        for (var i = 0, itemsLen = searchData.length; i < itemsLen; i++) {\n            var element = searchData[i];\n            var columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n            srchShowCols.push(columnUID);\n        }\n        var hideCols = this.showColumn.filter(function (column) { return srchShowCols.indexOf(column) !== -1; });\n        if (selected === 0 && hideCols.length === 0) {\n            btn.disabled = true;\n        }\n        btn.dataBind();\n    };\n    ColumnChooser.prototype.refreshCheckboxList = function (gdCol) {\n        this.ulElement = this.parent.createElement('ul', { className: 'e-ccul-ele e-cc' });\n        var selectAllValue = this.l10n.getConstant('SelectAll');\n        var cclist = this.parent.createElement('li', { className: 'e-cclist e-cc e-cc-selectall' });\n        var selectAll = this.createCheckBox(selectAllValue, false, 'grid-selectAll');\n        if (gdCol.length) {\n            selectAll.querySelector('.e-checkbox-wrapper').firstElementChild.classList.add('e-selectall');\n            selectAll.querySelector('.e-frame').classList.add('e-selectall');\n            this.checkState(selectAll.querySelector('.e-icons'), true);\n            cclist.appendChild(selectAll);\n            this.ulElement.appendChild(cclist);\n        }\n        for (var i = 0; i < gdCol.length; i++) {\n            var columns = gdCol[i];\n            this.renderCheckbox(columns);\n        }\n        return this.ulElement;\n    };\n    ColumnChooser.prototype.refreshCheckboxState = function () {\n        this.dlgObj.element.querySelector('.e-cc.e-input').value = '';\n        this.columnChooserSearch('');\n        var gridObject = this.parent;\n        var currentCheckBoxColls = this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)');\n        for (var i = 0, itemLen = currentCheckBoxColls.length; i < itemLen; i++) {\n            var element = currentCheckBoxColls[i];\n            var columnUID = void 0;\n            if (this.parent.childGrid || this.parent.detailTemplate) {\n                columnUID = parentsUntil(this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)')[i], 'e-ccheck').getAttribute('uid');\n            }\n            else {\n                columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n            }\n            var column = gridObject.getColumnByUid(columnUID);\n            var uncheck = [].slice.call(element.parentElement.getElementsByClassName('e-uncheck'));\n            if (column.visible && !uncheck.length) {\n                element.checked = true;\n                this.checkState(element.parentElement.querySelector('.e-icons'), true);\n            }\n            else {\n                element.checked = false;\n                this.checkState(element.parentElement.querySelector('.e-icons'), false);\n            }\n        }\n    };\n    ColumnChooser.prototype.checkState = function (element, state) {\n        if (state) {\n            classList(element, ['e-check'], ['e-uncheck']);\n        }\n        else {\n            classList(element, ['e-uncheck'], ['e-check']);\n        }\n    };\n    ColumnChooser.prototype.createCheckBox = function (label, checked, uid) {\n        var cbox = checked ? this.cBoxTrue.cloneNode(true) : this.cBoxFalse.cloneNode(true);\n        cbox.querySelector('.e-label').innerHTML = label;\n        return createCboxWithWrap(uid, cbox, 'e-ccheck');\n    };\n    ColumnChooser.prototype.renderCheckbox = function (column) {\n        var cclist;\n        var hideColState;\n        var showColState;\n        if (column.showInColumnChooser) {\n            cclist = this.parent.createElement('li', { className: 'e-cclist e-cc', styles: 'list-style:None', id: 'e-ccli_' + column.uid });\n            hideColState = this.hideColumn.indexOf(column.uid) === -1 ? false : true;\n            showColState = this.showColumn.indexOf(column.uid) === -1 ? false : true;\n            var cccheckboxlist = this.createCheckBox(column.headerText, (column.visible && !hideColState) || showColState, column.uid);\n            cclist.appendChild(cccheckboxlist);\n            this.ulElement.appendChild(cclist);\n        }\n        if (this.isInitialOpen) {\n            this.updateIntermediateBtn();\n        }\n    };\n    ColumnChooser.prototype.columnChooserManualSearch = function (e) {\n        this.addcancelIcon();\n        this.searchValue = e.target.value;\n        this.stopTimer();\n        this.startTimer(e);\n    };\n    ColumnChooser.prototype.startTimer = function (e) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var interval = !proxy.flag && e.keyCode !== 13 ? 500 : 0;\n        this.timer = window.setInterval(function () { proxy.columnChooserSearch(proxy.searchValue); }, interval);\n    };\n    ColumnChooser.prototype.stopTimer = function () {\n        window.clearInterval(this.timer);\n    };\n    ColumnChooser.prototype.addcancelIcon = function () {\n        this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.add('e-cc-cancel');\n    };\n    ColumnChooser.prototype.removeCancelIcon = function () {\n        this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.remove('e-cc-cancel');\n    };\n    ColumnChooser.prototype.mOpenDlg = function () {\n        if (Browser.isDevice) {\n            this.dlgObj.element.querySelector('.e-cc-searchdiv').classList.remove('e-input-focus');\n            this.dlgObj.element.querySelectorAll('.e-cc-chbox')[0].focus();\n        }\n    };\n    // internally use\n    ColumnChooser.prototype.getModuleName = function () {\n        return 'columnChooser';\n    };\n    ColumnChooser.prototype.hideOpenedDialog = function () {\n        var openCC = [].slice.call(document.getElementsByClassName('e-ccdlg')).filter(function (dlgEle) {\n            return dlgEle.classList.contains('e-popup-open');\n        });\n        for (var i = 0, dlgLen = openCC.length; i < dlgLen; i++) {\n            if (openCC[i].classList.contains('e-dialog') || this.parent.element.id + '_ccdlg' !== openCC[i].id) {\n                openCC[i].ej2_instances[0].hide();\n            }\n        }\n    };\n    ColumnChooser.prototype.beforeOpenColumnChooserEvent = function () {\n        var args1 = {\n            requestType: 'beforeOpenColumnChooser', element: this.parent.element,\n            columns: this.getColumns(), cancel: false,\n            searchOperator: this.parent.columnChooserSettings.operator\n        };\n        this.parent.trigger(events.beforeOpenColumnChooser, args1);\n        this.searchOperator = args1.searchOperator;\n        return args1;\n    };\n    return ColumnChooser;\n}());\nexport { ColumnChooser };\n"]},"metadata":{},"sourceType":"module"}